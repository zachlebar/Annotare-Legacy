'use strict';var require=function(file,cwd){var resolved=require.resolve(file,cwd||"/");var mod=require.modules[resolved];if(!mod)throw new Error("Failed to resolve module "+file+", tried "+resolved);var res=mod._cached?mod._cached:mod();return res};require.paths=[];require.modules={};require.extensions=[".js",".coffee"];require._core={"assert":true,"events":true,"fs":true,"path":true,"vm":true};
require.resolve=function(){return function(x,cwd){if(!cwd)cwd="/";if(require._core[x])return x;var path=require.modules.path();var y=cwd||".";if(x.match(/^(?:\.\.?\/|\/)/)){var m=loadAsFileSync(path.resolve(y,x))||loadAsDirectorySync(path.resolve(y,x));if(m)return m}var n=loadNodeModulesSync(x,y);if(n)return n;throw new Error("Cannot find module '"+x+"'");function loadAsFileSync(x){if(require.modules[x])return x;for(var i=0;i<require.extensions.length;i++){var ext=require.extensions[i];if(require.modules[x+
ext])return x+ext}}function loadAsDirectorySync(x){x=x.replace(/\/+$/,"");var pkgfile=x+"/package.json";if(require.modules[pkgfile]){var pkg=require.modules[pkgfile]();var b=pkg.browserify;if(typeof b==="object"&&b.main){var m=loadAsFileSync(path.resolve(x,b.main));if(m)return m}else if(typeof b==="string"){var m=loadAsFileSync(path.resolve(x,b));if(m)return m}else if(pkg.main){var m=loadAsFileSync(path.resolve(x,pkg.main));if(m)return m}}return loadAsFileSync(x+"/index")}function loadNodeModulesSync(x,
start){var dirs=nodeModulesPathsSync(start);for(var i=0;i<dirs.length;i++){var dir=dirs[i];var m=loadAsFileSync(dir+"/"+x);if(m)return m;var n=loadAsDirectorySync(dir+"/"+x);if(n)return n}var m=loadAsFileSync(x);if(m)return m}function nodeModulesPathsSync(start){var parts;if(start==="/")parts=[""];else parts=path.normalize(start).split("/");var dirs=[];for(var i=parts.length-1;i>=0;i--){if(parts[i]==="node_modules")continue;var dir=parts.slice(0,i+1).join("/")+"/node_modules";dirs.push(dir)}return dirs}
}}();
require.alias=function(from,to){var path=require.modules.path();var res=null;try{res=require.resolve(from+"/package.json","/")}catch(err){res=require.resolve(from,"/")}var basedir=path.dirname(res);var keys=(Object.keys||function(obj){var res=[];for(var key in obj)res.push(key);return res})(require.modules);for(var i=0;i<keys.length;i++){var key=keys[i];if(key.slice(0,basedir.length+1)===basedir+"/"){var f=key.slice(basedir.length);require.modules[to+f]=require.modules[basedir+f]}else if(key===basedir)require.modules[to]=
require.modules[basedir]}};
require.define=function(filename,fn){var dirname=require._core[filename]?"":require.modules.path().dirname(filename);var require_=function(file){return require(file,dirname)};require_.resolve=function(name){return require.resolve(name,dirname)};require_.modules=require.modules;require_.define=require.define;var module_={exports:{}};require.modules[filename]=function(){require.modules[filename]._cached=module_.exports;fn.call(module_.exports,require_,module_,module_.exports,dirname,filename);require.modules[filename]._cached=
module_.exports;return module_.exports}};if(typeof process==="undefined")process={};
if(!process.nextTick)process.nextTick=function(){var queue=[];var canPost=typeof window!=="undefined"&&window.postMessage&&window.addEventListener;if(canPost)window.addEventListener("message",function(ev){if(ev.source===window&&ev.data==="browserify-tick"){ev.stopPropagation();if(queue.length>0){var fn=queue.shift();fn()}}},true);return function(fn){if(canPost){queue.push(fn);window.postMessage("browserify-tick","*")}else setTimeout(fn,0)}}();if(!process.title)process.title="browser";
if(!process.binding)process.binding=function(name){if(name==="evals")return require("vm");else throw new Error("No such module");};if(!process.cwd)process.cwd=function(){return"."};
require.define("path",function(require,module,exports,__dirname,__filename){function filter(xs,fn){var res=[];for(var i=0;i<xs.length;i++)if(fn(xs[i],i,xs))res.push(xs[i]);return res}function normalizeArray(parts,allowAboveRoot){var up=0;for(var i=parts.length;i>=0;i--){var last=parts[i];if(last==".")parts.splice(i,1);else if(last===".."){parts.splice(i,1);up++}else if(up){parts.splice(i,1);up--}}if(allowAboveRoot)for(;up--;up)parts.unshift("..");return parts}var splitPathRe=/^(.+\/(?!$)|\/)?((?:.+?)?(\.[^.]*)?)$/;
exports.resolve=function(){var resolvedPath="",resolvedAbsolute=false;for(var i=arguments.length;i>=-1&&!resolvedAbsolute;i--){var path=i>=0?arguments[i]:process.cwd();if(typeof path!=="string"||!path)continue;resolvedPath=path+"/"+resolvedPath;resolvedAbsolute=path.charAt(0)==="/"}resolvedPath=normalizeArray(filter(resolvedPath.split("/"),function(p){return!!p}),!resolvedAbsolute).join("/");return(resolvedAbsolute?"/":"")+resolvedPath||"."};exports.normalize=function(path){var isAbsolute=path.charAt(0)===
"/",trailingSlash=path.slice(-1)==="/";path=normalizeArray(filter(path.split("/"),function(p){return!!p}),!isAbsolute).join("/");if(!path&&!isAbsolute)path=".";if(path&&trailingSlash)path+="/";return(isAbsolute?"/":"")+path};exports.join=function(){var paths=Array.prototype.slice.call(arguments,0);return exports.normalize(filter(paths,function(p,index){return p&&typeof p==="string"}).join("/"))};exports.dirname=function(path){var dir=splitPathRe.exec(path)[1]||"";var isWindows=false;if(!dir)return".";
else if(dir.length===1||isWindows&&dir.length<=3&&dir.charAt(1)===":")return dir;else return dir.substring(0,dir.length-1)};exports.basename=function(path,ext){var f=splitPathRe.exec(path)[2]||"";if(ext&&f.substr(-1*ext.length)===ext)f=f.substr(0,f.length-ext.length);return f};exports.extname=function(path){return splitPathRe.exec(path)[3]||""}});require.define("/node_modules/flakey/package.json",function(require,module,exports,__dirname,__filename){module.exports={"main":"./flakey.js"}});
require.define("/node_modules/flakey/flakey.js",function(require,module,exports,__dirname,__filename){(function(){function diff_match_patch(){this.Diff_Timeout=1;this.Diff_EditCost=4;this.Match_Threshold=0.5;this.Match_Distance=1E3;this.Patch_DeleteThreshold=0.5;this.Patch_Margin=4;this.Match_MaxBits=32}var DIFF_DELETE=-1;var DIFF_INSERT=1;var DIFF_EQUAL=0;diff_match_patch.Diff;diff_match_patch.prototype.diff_main=function(text1,text2,opt_checklines,opt_deadline){if(typeof opt_deadline=="undefined")if(this.Diff_Timeout<=
0)opt_deadline=Number.MAX_VALUE;else opt_deadline=(new Date).getTime()+this.Diff_Timeout*1E3;var deadline=opt_deadline;if(text1==null||text2==null)throw new Error("Null input. (diff_main)");if(text1==text2){if(text1)return[[DIFF_EQUAL,text1]];return[]}if(typeof opt_checklines=="undefined")opt_checklines=true;var checklines=opt_checklines;var commonlength=this.diff_commonPrefix(text1,text2);var commonprefix=text1.substring(0,commonlength);text1=text1.substring(commonlength);text2=text2.substring(commonlength);
commonlength=this.diff_commonSuffix(text1,text2);var commonsuffix=text1.substring(text1.length-commonlength);text1=text1.substring(0,text1.length-commonlength);text2=text2.substring(0,text2.length-commonlength);var diffs=this.diff_compute_(text1,text2,checklines,deadline);if(commonprefix)diffs.unshift([DIFF_EQUAL,commonprefix]);if(commonsuffix)diffs.push([DIFF_EQUAL,commonsuffix]);this.diff_cleanupMerge(diffs);return diffs};diff_match_patch.prototype.diff_compute_=function(text1,text2,checklines,
deadline){var diffs;if(!text1)return[[DIFF_INSERT,text2]];if(!text2)return[[DIFF_DELETE,text1]];var longtext=text1.length>text2.length?text1:text2;var shorttext=text1.length>text2.length?text2:text1;var i=longtext.indexOf(shorttext);if(i!=-1){diffs=[[DIFF_INSERT,longtext.substring(0,i)],[DIFF_EQUAL,shorttext],[DIFF_INSERT,longtext.substring(i+shorttext.length)]];if(text1.length>text2.length)diffs[0][0]=diffs[2][0]=DIFF_DELETE;return diffs}if(shorttext.length==1)return[[DIFF_DELETE,text1],[DIFF_INSERT,
text2]];longtext=shorttext=null;var hm=this.diff_halfMatch_(text1,text2);if(hm){var text1_a=hm[0];var text1_b=hm[1];var text2_a=hm[2];var text2_b=hm[3];var mid_common=hm[4];var diffs_a=this.diff_main(text1_a,text2_a,checklines,deadline);var diffs_b=this.diff_main(text1_b,text2_b,checklines,deadline);return diffs_a.concat([[DIFF_EQUAL,mid_common]],diffs_b)}if(checklines&&text1.length>100&&text2.length>100)return this.diff_lineMode_(text1,text2,deadline);return this.diff_bisect_(text1,text2,deadline)};
diff_match_patch.prototype.diff_lineMode_=function(text1,text2,deadline){var a=this.diff_linesToChars_(text1,text2);text1=a[0];text2=a[1];var linearray=a[2];var diffs=this.diff_bisect_(text1,text2,deadline);this.diff_charsToLines_(diffs,linearray);this.diff_cleanupSemantic(diffs);diffs.push([DIFF_EQUAL,""]);var pointer=0;var count_delete=0;var count_insert=0;var text_delete="";var text_insert="";while(pointer<diffs.length){switch(diffs[pointer][0]){case DIFF_INSERT:count_insert++;text_insert+=diffs[pointer][1];
break;case DIFF_DELETE:count_delete++;text_delete+=diffs[pointer][1];break;case DIFF_EQUAL:if(count_delete>=1&&count_insert>=1){var a=this.diff_main(text_delete,text_insert,false,deadline);diffs.splice(pointer-count_delete-count_insert,count_delete+count_insert);pointer=pointer-count_delete-count_insert;for(var j=a.length-1;j>=0;j--)diffs.splice(pointer,0,a[j]);pointer=pointer+a.length}count_insert=0;count_delete=0;text_delete="";text_insert="";break}pointer++}diffs.pop();return diffs};diff_match_patch.prototype.diff_bisect_=
function(text1,text2,deadline){var text1_length=text1.length;var text2_length=text2.length;var max_d=Math.ceil((text1_length+text2_length)/2);var v_offset=max_d;var v_length=2*max_d;var v1=new Array(v_length);var v2=new Array(v_length);for(var x=0;x<v_length;x++){v1[x]=-1;v2[x]=-1}v1[v_offset+1]=0;v2[v_offset+1]=0;var delta=text1_length-text2_length;var front=delta%2!=0;var k1start=0;var k1end=0;var k2start=0;var k2end=0;for(var d=0;d<max_d;d++){if((new Date).getTime()>deadline)break;for(var k1=-d+
k1start;k1<=d-k1end;k1+=2){var k1_offset=v_offset+k1;var x1;if(k1==-d||k1!=d&&v1[k1_offset-1]<v1[k1_offset+1])x1=v1[k1_offset+1];else x1=v1[k1_offset-1]+1;var y1=x1-k1;while(x1<text1_length&&y1<text2_length&&text1.charAt(x1)==text2.charAt(y1)){x1++;y1++}v1[k1_offset]=x1;if(x1>text1_length)k1end+=2;else if(y1>text2_length)k1start+=2;else if(front){var k2_offset=v_offset+delta-k1;if(k2_offset>=0&&k2_offset<v_length&&v2[k2_offset]!=-1){var x2=text1_length-v2[k2_offset];if(x1>=x2)return this.diff_bisectSplit_(text1,
text2,x1,y1,deadline)}}}for(var k2=-d+k2start;k2<=d-k2end;k2+=2){var k2_offset=v_offset+k2;var x2;if(k2==-d||k2!=d&&v2[k2_offset-1]<v2[k2_offset+1])x2=v2[k2_offset+1];else x2=v2[k2_offset-1]+1;var y2=x2-k2;while(x2<text1_length&&y2<text2_length&&text1.charAt(text1_length-x2-1)==text2.charAt(text2_length-y2-1)){x2++;y2++}v2[k2_offset]=x2;if(x2>text1_length)k2end+=2;else if(y2>text2_length)k2start+=2;else if(!front){var k1_offset=v_offset+delta-k2;if(k1_offset>=0&&k1_offset<v_length&&v1[k1_offset]!=
-1){var x1=v1[k1_offset];var y1=v_offset+x1-k1_offset;x2=text1_length-x2;if(x1>=x2)return this.diff_bisectSplit_(text1,text2,x1,y1,deadline)}}}}return[[DIFF_DELETE,text1],[DIFF_INSERT,text2]]};diff_match_patch.prototype.diff_bisectSplit_=function(text1,text2,x,y,deadline){var text1a=text1.substring(0,x);var text2a=text2.substring(0,y);var text1b=text1.substring(x);var text2b=text2.substring(y);var diffs=this.diff_main(text1a,text2a,false,deadline);var diffsb=this.diff_main(text1b,text2b,false,deadline);
return diffs.concat(diffsb)};diff_match_patch.prototype.diff_linesToChars_=function(text1,text2){var lineArray=[];var lineHash={};lineArray[0]="";function diff_linesToCharsMunge_(text){var chars="";var lineStart=0;var lineEnd=-1;var lineArrayLength=lineArray.length;while(lineEnd<text.length-1){lineEnd=text.indexOf("\n",lineStart);if(lineEnd==-1)lineEnd=text.length-1;var line=text.substring(lineStart,lineEnd+1);lineStart=lineEnd+1;if(lineHash.hasOwnProperty?lineHash.hasOwnProperty(line):lineHash[line]!==
undefined)chars+=String.fromCharCode(lineHash[line]);else{chars+=String.fromCharCode(lineArrayLength);lineHash[line]=lineArrayLength;lineArray[lineArrayLength++]=line}}return chars}var chars1=diff_linesToCharsMunge_(text1);var chars2=diff_linesToCharsMunge_(text2);return[chars1,chars2,lineArray]};diff_match_patch.prototype.diff_charsToLines_=function(diffs,lineArray){for(var x=0;x<diffs.length;x++){var chars=diffs[x][1];var text=[];for(var y=0;y<chars.length;y++)text[y]=lineArray[chars.charCodeAt(y)];
diffs[x][1]=text.join("")}};diff_match_patch.prototype.diff_commonPrefix=function(text1,text2){if(!text1||!text2||text1.charAt(0)!=text2.charAt(0))return 0;var pointermin=0;var pointermax=Math.min(text1.length,text2.length);var pointermid=pointermax;var pointerstart=0;while(pointermin<pointermid){if(text1.substring(pointerstart,pointermid)==text2.substring(pointerstart,pointermid)){pointermin=pointermid;pointerstart=pointermin}else pointermax=pointermid;pointermid=Math.floor((pointermax-pointermin)/
2+pointermin)}return pointermid};diff_match_patch.prototype.diff_commonSuffix=function(text1,text2){if(!text1||!text2||text1.charAt(text1.length-1)!=text2.charAt(text2.length-1))return 0;var pointermin=0;var pointermax=Math.min(text1.length,text2.length);var pointermid=pointermax;var pointerend=0;while(pointermin<pointermid){if(text1.substring(text1.length-pointermid,text1.length-pointerend)==text2.substring(text2.length-pointermid,text2.length-pointerend)){pointermin=pointermid;pointerend=pointermin}else pointermax=
pointermid;pointermid=Math.floor((pointermax-pointermin)/2+pointermin)}return pointermid};diff_match_patch.prototype.diff_commonOverlap_=function(text1,text2){var text1_length=text1.length;var text2_length=text2.length;if(text1_length==0||text2_length==0)return 0;if(text1_length>text2_length)text1=text1.substring(text1_length-text2_length);else if(text1_length<text2_length)text2=text2.substring(0,text1_length);var text_length=Math.min(text1_length,text2_length);if(text1==text2)return text_length;
var best=0;var length=1;while(true){var pattern=text1.substring(text_length-length);var found=text2.indexOf(pattern);if(found==-1)return best;length+=found;if(found==0||text1.substring(text_length-length)==text2.substring(0,length)){best=length;length++}}};diff_match_patch.prototype.diff_halfMatch_=function(text1,text2){if(this.Diff_Timeout<=0)return null;var longtext=text1.length>text2.length?text1:text2;var shorttext=text1.length>text2.length?text2:text1;if(longtext.length<4||shorttext.length*2<
longtext.length)return null;var dmp=this;function diff_halfMatchI_(longtext,shorttext,i){var seed=longtext.substring(i,i+Math.floor(longtext.length/4));var j=-1;var best_common="";var best_longtext_a,best_longtext_b,best_shorttext_a,best_shorttext_b;while((j=shorttext.indexOf(seed,j+1))!=-1){var prefixLength=dmp.diff_commonPrefix(longtext.substring(i),shorttext.substring(j));var suffixLength=dmp.diff_commonSuffix(longtext.substring(0,i),shorttext.substring(0,j));if(best_common.length<suffixLength+
prefixLength){best_common=shorttext.substring(j-suffixLength,j)+shorttext.substring(j,j+prefixLength);best_longtext_a=longtext.substring(0,i-suffixLength);best_longtext_b=longtext.substring(i+prefixLength);best_shorttext_a=shorttext.substring(0,j-suffixLength);best_shorttext_b=shorttext.substring(j+prefixLength)}}if(best_common.length*2>=longtext.length)return[best_longtext_a,best_longtext_b,best_shorttext_a,best_shorttext_b,best_common];else return null}var hm1=diff_halfMatchI_(longtext,shorttext,
Math.ceil(longtext.length/4));var hm2=diff_halfMatchI_(longtext,shorttext,Math.ceil(longtext.length/2));var hm;if(!hm1&&!hm2)return null;else if(!hm2)hm=hm1;else if(!hm1)hm=hm2;else hm=hm1[4].length>hm2[4].length?hm1:hm2;var text1_a,text1_b,text2_a,text2_b;if(text1.length>text2.length){text1_a=hm[0];text1_b=hm[1];text2_a=hm[2];text2_b=hm[3]}else{text2_a=hm[0];text2_b=hm[1];text1_a=hm[2];text1_b=hm[3]}var mid_common=hm[4];return[text1_a,text1_b,text2_a,text2_b,mid_common]};diff_match_patch.prototype.diff_cleanupSemantic=
function(diffs){var changes=false;var equalities=[];var equalitiesLength=0;var lastequality=null;var pointer=0;var length_insertions1=0;var length_deletions1=0;var length_insertions2=0;var length_deletions2=0;while(pointer<diffs.length){if(diffs[pointer][0]==DIFF_EQUAL){equalities[equalitiesLength++]=pointer;length_insertions1=length_insertions2;length_deletions1=length_deletions2;length_insertions2=0;length_deletions2=0;lastequality=diffs[pointer][1]}else{if(diffs[pointer][0]==DIFF_INSERT)length_insertions2+=
diffs[pointer][1].length;else length_deletions2+=diffs[pointer][1].length;if(lastequality!==null&&lastequality.length<=Math.max(length_insertions1,length_deletions1)&&lastequality.length<=Math.max(length_insertions2,length_deletions2)){diffs.splice(equalities[equalitiesLength-1],0,[DIFF_DELETE,lastequality]);diffs[equalities[equalitiesLength-1]+1][0]=DIFF_INSERT;equalitiesLength--;equalitiesLength--;pointer=equalitiesLength>0?equalities[equalitiesLength-1]:-1;length_insertions1=0;length_deletions1=
0;length_insertions2=0;length_deletions2=0;lastequality=null;changes=true}}pointer++}if(changes)this.diff_cleanupMerge(diffs);this.diff_cleanupSemanticLossless(diffs);pointer=1;while(pointer<diffs.length){if(diffs[pointer-1][0]==DIFF_DELETE&&diffs[pointer][0]==DIFF_INSERT){var deletion=diffs[pointer-1][1];var insertion=diffs[pointer][1];var overlap_length1=this.diff_commonOverlap_(deletion,insertion);var overlap_length2=this.diff_commonOverlap_(insertion,deletion);if(overlap_length1>=overlap_length2){if(overlap_length1>=
deletion.length/2||overlap_length1>=insertion.length/2){diffs.splice(pointer,0,[DIFF_EQUAL,insertion.substring(0,overlap_length1)]);diffs[pointer-1][1]=deletion.substring(0,deletion.length-overlap_length1);diffs[pointer+1][1]=insertion.substring(overlap_length1);pointer++}}else if(overlap_length2>=deletion.length/2||overlap_length2>=insertion.length/2){diffs.splice(pointer,0,[DIFF_EQUAL,deletion.substring(0,overlap_length2)]);diffs[pointer-1]=[DIFF_INSERT,insertion.substring(0,insertion.length-overlap_length2)];
diffs[pointer+1]=[DIFF_DELETE,deletion.substring(overlap_length2)];pointer++}pointer++}pointer++}};diff_match_patch.prototype.diff_cleanupSemanticLossless=function(diffs){function diff_cleanupSemanticScore_(one,two){if(!one||!two)return 6;var char1=one.charAt(one.length-1);var char2=two.charAt(0);var nonAlphaNumeric1=char1.match(diff_match_patch.nonAlphaNumericRegex_);var nonAlphaNumeric2=char2.match(diff_match_patch.nonAlphaNumericRegex_);var whitespace1=nonAlphaNumeric1&&char1.match(diff_match_patch.whitespaceRegex_);
var whitespace2=nonAlphaNumeric2&&char2.match(diff_match_patch.whitespaceRegex_);var lineBreak1=whitespace1&&char1.match(diff_match_patch.linebreakRegex_);var lineBreak2=whitespace2&&char2.match(diff_match_patch.linebreakRegex_);var blankLine1=lineBreak1&&one.match(diff_match_patch.blanklineEndRegex_);var blankLine2=lineBreak2&&two.match(diff_match_patch.blanklineStartRegex_);if(blankLine1||blankLine2)return 5;else if(lineBreak1||lineBreak2)return 4;else if(nonAlphaNumeric1&&!whitespace1&&whitespace2)return 3;
else if(whitespace1||whitespace2)return 2;else if(nonAlphaNumeric1||nonAlphaNumeric2)return 1;return 0}var pointer=1;while(pointer<diffs.length-1){if(diffs[pointer-1][0]==DIFF_EQUAL&&diffs[pointer+1][0]==DIFF_EQUAL){var equality1=diffs[pointer-1][1];var edit=diffs[pointer][1];var equality2=diffs[pointer+1][1];var commonOffset=this.diff_commonSuffix(equality1,edit);if(commonOffset){var commonString=edit.substring(edit.length-commonOffset);equality1=equality1.substring(0,equality1.length-commonOffset);
edit=commonString+edit.substring(0,edit.length-commonOffset);equality2=commonString+equality2}var bestEquality1=equality1;var bestEdit=edit;var bestEquality2=equality2;var bestScore=diff_cleanupSemanticScore_(equality1,edit)+diff_cleanupSemanticScore_(edit,equality2);while(edit.charAt(0)===equality2.charAt(0)){equality1+=edit.charAt(0);edit=edit.substring(1)+equality2.charAt(0);equality2=equality2.substring(1);var score=diff_cleanupSemanticScore_(equality1,edit)+diff_cleanupSemanticScore_(edit,equality2);
if(score>=bestScore){bestScore=score;bestEquality1=equality1;bestEdit=edit;bestEquality2=equality2}}if(diffs[pointer-1][1]!=bestEquality1){if(bestEquality1)diffs[pointer-1][1]=bestEquality1;else{diffs.splice(pointer-1,1);pointer--}diffs[pointer][1]=bestEdit;if(bestEquality2)diffs[pointer+1][1]=bestEquality2;else{diffs.splice(pointer+1,1);pointer--}}}pointer++}};diff_match_patch.nonAlphaNumericRegex_=/[^a-zA-Z0-9]/;diff_match_patch.whitespaceRegex_=/\s/;diff_match_patch.linebreakRegex_=/[\r\n]/;diff_match_patch.blanklineEndRegex_=
/\n\r?\n$/;diff_match_patch.blanklineStartRegex_=/^\r?\n\r?\n/;diff_match_patch.prototype.diff_cleanupEfficiency=function(diffs){var changes=false;var equalities=[];var equalitiesLength=0;var lastequality="";var pointer=0;var pre_ins=false;var pre_del=false;var post_ins=false;var post_del=false;while(pointer<diffs.length){if(diffs[pointer][0]==DIFF_EQUAL){if(diffs[pointer][1].length<this.Diff_EditCost&&(post_ins||post_del)){equalities[equalitiesLength++]=pointer;pre_ins=post_ins;pre_del=post_del;
lastequality=diffs[pointer][1]}else{equalitiesLength=0;lastequality=""}post_ins=post_del=false}else{if(diffs[pointer][0]==DIFF_DELETE)post_del=true;else post_ins=true;if(lastequality&&(pre_ins&&pre_del&&post_ins&&post_del||lastequality.length<this.Diff_EditCost/2&&pre_ins+pre_del+post_ins+post_del==3)){diffs.splice(equalities[equalitiesLength-1],0,[DIFF_DELETE,lastequality]);diffs[equalities[equalitiesLength-1]+1][0]=DIFF_INSERT;equalitiesLength--;lastequality="";if(pre_ins&&pre_del){post_ins=post_del=
true;equalitiesLength=0}else{equalitiesLength--;pointer=equalitiesLength>0?equalities[equalitiesLength-1]:-1;post_ins=post_del=false}changes=true}}pointer++}if(changes)this.diff_cleanupMerge(diffs)};diff_match_patch.prototype.diff_cleanupMerge=function(diffs){diffs.push([DIFF_EQUAL,""]);var pointer=0;var count_delete=0;var count_insert=0;var text_delete="";var text_insert="";var commonlength;while(pointer<diffs.length)switch(diffs[pointer][0]){case DIFF_INSERT:count_insert++;text_insert+=diffs[pointer][1];
pointer++;break;case DIFF_DELETE:count_delete++;text_delete+=diffs[pointer][1];pointer++;break;case DIFF_EQUAL:if(count_delete+count_insert>1){if(count_delete!==0&&count_insert!==0){commonlength=this.diff_commonPrefix(text_insert,text_delete);if(commonlength!==0){if(pointer-count_delete-count_insert>0&&diffs[pointer-count_delete-count_insert-1][0]==DIFF_EQUAL)diffs[pointer-count_delete-count_insert-1][1]+=text_insert.substring(0,commonlength);else{diffs.splice(0,0,[DIFF_EQUAL,text_insert.substring(0,
commonlength)]);pointer++}text_insert=text_insert.substring(commonlength);text_delete=text_delete.substring(commonlength)}commonlength=this.diff_commonSuffix(text_insert,text_delete);if(commonlength!==0){diffs[pointer][1]=text_insert.substring(text_insert.length-commonlength)+diffs[pointer][1];text_insert=text_insert.substring(0,text_insert.length-commonlength);text_delete=text_delete.substring(0,text_delete.length-commonlength)}}if(count_delete===0)diffs.splice(pointer-count_delete-count_insert,
count_delete+count_insert,[DIFF_INSERT,text_insert]);else if(count_insert===0)diffs.splice(pointer-count_delete-count_insert,count_delete+count_insert,[DIFF_DELETE,text_delete]);else diffs.splice(pointer-count_delete-count_insert,count_delete+count_insert,[DIFF_DELETE,text_delete],[DIFF_INSERT,text_insert]);pointer=pointer-count_delete-count_insert+(count_delete?1:0)+(count_insert?1:0)+1}else if(pointer!==0&&diffs[pointer-1][0]==DIFF_EQUAL){diffs[pointer-1][1]+=diffs[pointer][1];diffs.splice(pointer,
1)}else pointer++;count_insert=0;count_delete=0;text_delete="";text_insert="";break}if(diffs[diffs.length-1][1]==="")diffs.pop();var changes=false;pointer=1;while(pointer<diffs.length-1){if(diffs[pointer-1][0]==DIFF_EQUAL&&diffs[pointer+1][0]==DIFF_EQUAL)if(diffs[pointer][1].substring(diffs[pointer][1].length-diffs[pointer-1][1].length)==diffs[pointer-1][1]){diffs[pointer][1]=diffs[pointer-1][1]+diffs[pointer][1].substring(0,diffs[pointer][1].length-diffs[pointer-1][1].length);diffs[pointer+1][1]=
diffs[pointer-1][1]+diffs[pointer+1][1];diffs.splice(pointer-1,1);changes=true}else if(diffs[pointer][1].substring(0,diffs[pointer+1][1].length)==diffs[pointer+1][1]){diffs[pointer-1][1]+=diffs[pointer+1][1];diffs[pointer][1]=diffs[pointer][1].substring(diffs[pointer+1][1].length)+diffs[pointer+1][1];diffs.splice(pointer+1,1);changes=true}pointer++}if(changes)this.diff_cleanupMerge(diffs)};diff_match_patch.prototype.diff_xIndex=function(diffs,loc){var chars1=0;var chars2=0;var last_chars1=0;var last_chars2=
0;var x;for(x=0;x<diffs.length;x++){if(diffs[x][0]!==DIFF_INSERT)chars1+=diffs[x][1].length;if(diffs[x][0]!==DIFF_DELETE)chars2+=diffs[x][1].length;if(chars1>loc)break;last_chars1=chars1;last_chars2=chars2}if(diffs.length!=x&&diffs[x][0]===DIFF_DELETE)return last_chars2;return last_chars2+(loc-last_chars1)};diff_match_patch.prototype.diff_prettyHtml=function(diffs){var html=[];var pattern_amp=/&/g;var pattern_lt=/</g;var pattern_gt=/>/g;var pattern_para=/\n/g;for(var x=0;x<diffs.length;x++){var op=
diffs[x][0];var data=diffs[x][1];var text=data.replace(pattern_amp,"&amp;").replace(pattern_lt,"&lt;").replace(pattern_gt,"&gt;").replace(pattern_para,"&para;<br>");switch(op){case DIFF_INSERT:html[x]='<ins style="background:#e6ffe6;">'+text+"</ins>";break;case DIFF_DELETE:html[x]='<del style="background:#ffe6e6;">'+text+"</del>";break;case DIFF_EQUAL:html[x]="<span>"+text+"</span>";break}}return html.join("")};diff_match_patch.prototype.diff_text1=function(diffs){var text=[];for(var x=0;x<diffs.length;x++)if(diffs[x][0]!==
DIFF_INSERT)text[x]=diffs[x][1];return text.join("")};diff_match_patch.prototype.diff_text2=function(diffs){var text=[];for(var x=0;x<diffs.length;x++)if(diffs[x][0]!==DIFF_DELETE)text[x]=diffs[x][1];return text.join("")};diff_match_patch.prototype.diff_levenshtein=function(diffs){var levenshtein=0;var insertions=0;var deletions=0;for(var x=0;x<diffs.length;x++){var op=diffs[x][0];var data=diffs[x][1];switch(op){case DIFF_INSERT:insertions+=data.length;break;case DIFF_DELETE:deletions+=data.length;
break;case DIFF_EQUAL:levenshtein+=Math.max(insertions,deletions);insertions=0;deletions=0;break}}levenshtein+=Math.max(insertions,deletions);return levenshtein};diff_match_patch.prototype.diff_toDelta=function(diffs){var text=[];for(var x=0;x<diffs.length;x++)switch(diffs[x][0]){case DIFF_INSERT:text[x]="+"+encodeURI(diffs[x][1]);break;case DIFF_DELETE:text[x]="-"+diffs[x][1].length;break;case DIFF_EQUAL:text[x]="="+diffs[x][1].length;break}return text.join("\t").replace(/%20/g," ")};diff_match_patch.prototype.diff_fromDelta=
function(text1,delta){var diffs=[];var diffsLength=0;var pointer=0;var tokens=delta.split(/\t/g);for(var x=0;x<tokens.length;x++){var param=tokens[x].substring(1);switch(tokens[x].charAt(0)){case "+":try{diffs[diffsLength++]=[DIFF_INSERT,decodeURI(param)]}catch(ex){throw new Error("Illegal escape in diff_fromDelta: "+param);}break;case "-":case "=":var n=parseInt(param,10);if(isNaN(n)||n<0)throw new Error("Invalid number in diff_fromDelta: "+param);var text=text1.substring(pointer,pointer+=n);if(tokens[x].charAt(0)==
"=")diffs[diffsLength++]=[DIFF_EQUAL,text];else diffs[diffsLength++]=[DIFF_DELETE,text];break;default:if(tokens[x])throw new Error("Invalid diff operation in diff_fromDelta: "+tokens[x]);}}if(pointer!=text1.length)throw new Error("Delta length ("+pointer+") does not equal source text length ("+text1.length+").");return diffs};diff_match_patch.prototype.match_main=function(text,pattern,loc){if(text==null||pattern==null||loc==null)throw new Error("Null input. (match_main)");loc=Math.max(0,Math.min(loc,
text.length));if(text==pattern)return 0;else if(!text.length)return-1;else if(text.substring(loc,loc+pattern.length)==pattern)return loc;else return this.match_bitap_(text,pattern,loc)};diff_match_patch.prototype.match_bitap_=function(text,pattern,loc){if(pattern.length>this.Match_MaxBits)throw new Error("Pattern too long for this browser.");var s=this.match_alphabet_(pattern);var dmp=this;function match_bitapScore_(e,x){var accuracy=e/pattern.length;var proximity=Math.abs(loc-x);if(!dmp.Match_Distance)return proximity?
1:accuracy;return accuracy+proximity/dmp.Match_Distance}var score_threshold=this.Match_Threshold;var best_loc=text.indexOf(pattern,loc);if(best_loc!=-1){score_threshold=Math.min(match_bitapScore_(0,best_loc),score_threshold);best_loc=text.lastIndexOf(pattern,loc+pattern.length);if(best_loc!=-1)score_threshold=Math.min(match_bitapScore_(0,best_loc),score_threshold)}var matchmask=1<<pattern.length-1;best_loc=-1;var bin_min,bin_mid;var bin_max=pattern.length+text.length;var last_rd;for(var d=0;d<pattern.length;d++){bin_min=
0;bin_mid=bin_max;while(bin_min<bin_mid){if(match_bitapScore_(d,loc+bin_mid)<=score_threshold)bin_min=bin_mid;else bin_max=bin_mid;bin_mid=Math.floor((bin_max-bin_min)/2+bin_min)}bin_max=bin_mid;var start=Math.max(1,loc-bin_mid+1);var finish=Math.min(loc+bin_mid,text.length)+pattern.length;var rd=Array(finish+2);rd[finish+1]=(1<<d)-1;for(var j=finish;j>=start;j--){var charMatch=s[text.charAt(j-1)];if(d===0)rd[j]=(rd[j+1]<<1|1)&charMatch;else rd[j]=(rd[j+1]<<1|1)&charMatch|(last_rd[j+1]|last_rd[j])<<
1|1|last_rd[j+1];if(rd[j]&matchmask){var score=match_bitapScore_(d,j-1);if(score<=score_threshold){score_threshold=score;best_loc=j-1;if(best_loc>loc)start=Math.max(1,2*loc-best_loc);else break}}}if(match_bitapScore_(d+1,loc)>score_threshold)break;last_rd=rd}return best_loc};diff_match_patch.prototype.match_alphabet_=function(pattern){var s={};for(var i=0;i<pattern.length;i++)s[pattern.charAt(i)]=0;for(var i=0;i<pattern.length;i++)s[pattern.charAt(i)]|=1<<pattern.length-i-1;return s};diff_match_patch.prototype.patch_addContext_=
function(patch,text){if(text.length==0)return;var pattern=text.substring(patch.start2,patch.start2+patch.length1);var padding=0;while(text.indexOf(pattern)!=text.lastIndexOf(pattern)&&pattern.length<this.Match_MaxBits-this.Patch_Margin-this.Patch_Margin){padding+=this.Patch_Margin;pattern=text.substring(patch.start2-padding,patch.start2+patch.length1+padding)}padding+=this.Patch_Margin;var prefix=text.substring(patch.start2-padding,patch.start2);if(prefix)patch.diffs.unshift([DIFF_EQUAL,prefix]);
var suffix=text.substring(patch.start2+patch.length1,patch.start2+patch.length1+padding);if(suffix)patch.diffs.push([DIFF_EQUAL,suffix]);patch.start1-=prefix.length;patch.start2-=prefix.length;patch.length1+=prefix.length+suffix.length;patch.length2+=prefix.length+suffix.length};diff_match_patch.prototype.patch_make=function(a,opt_b,opt_c){var text1,diffs;if(typeof a=="string"&&typeof opt_b=="string"&&typeof opt_c=="undefined"){text1=a;diffs=this.diff_main(text1,opt_b,true);if(diffs.length>2){this.diff_cleanupSemantic(diffs);
this.diff_cleanupEfficiency(diffs)}}else if(a&&typeof a=="object"&&typeof opt_b=="undefined"&&typeof opt_c=="undefined"){diffs=a;text1=this.diff_text1(diffs)}else if(typeof a=="string"&&opt_b&&typeof opt_b=="object"&&typeof opt_c=="undefined"){text1=a;diffs=opt_b}else if(typeof a=="string"&&typeof opt_b=="string"&&opt_c&&typeof opt_c=="object"){text1=a;diffs=opt_c}else throw new Error("Unknown call format to patch_make.");if(diffs.length===0)return[];var patches=[];var patch=new diff_match_patch.patch_obj;
var patchDiffLength=0;var char_count1=0;var char_count2=0;var prepatch_text=text1;var postpatch_text=text1;for(var x=0;x<diffs.length;x++){var diff_type=diffs[x][0];var diff_text=diffs[x][1];if(!patchDiffLength&&diff_type!==DIFF_EQUAL){patch.start1=char_count1;patch.start2=char_count2}switch(diff_type){case DIFF_INSERT:patch.diffs[patchDiffLength++]=diffs[x];patch.length2+=diff_text.length;postpatch_text=postpatch_text.substring(0,char_count2)+diff_text+postpatch_text.substring(char_count2);break;
case DIFF_DELETE:patch.length1+=diff_text.length;patch.diffs[patchDiffLength++]=diffs[x];postpatch_text=postpatch_text.substring(0,char_count2)+postpatch_text.substring(char_count2+diff_text.length);break;case DIFF_EQUAL:if(diff_text.length<=2*this.Patch_Margin&&patchDiffLength&&diffs.length!=x+1){patch.diffs[patchDiffLength++]=diffs[x];patch.length1+=diff_text.length;patch.length2+=diff_text.length}else if(diff_text.length>=2*this.Patch_Margin)if(patchDiffLength){this.patch_addContext_(patch,prepatch_text);
patches.push(patch);patch=new diff_match_patch.patch_obj;patchDiffLength=0;prepatch_text=postpatch_text;char_count1=char_count2}break}if(diff_type!==DIFF_INSERT)char_count1+=diff_text.length;if(diff_type!==DIFF_DELETE)char_count2+=diff_text.length}if(patchDiffLength){this.patch_addContext_(patch,prepatch_text);patches.push(patch)}return patches};diff_match_patch.prototype.patch_deepCopy=function(patches){var patchesCopy=[];for(var x=0;x<patches.length;x++){var patch=patches[x];var patchCopy=new diff_match_patch.patch_obj;
patchCopy.diffs=[];for(var y=0;y<patch.diffs.length;y++)patchCopy.diffs[y]=patch.diffs[y].slice();patchCopy.start1=patch.start1;patchCopy.start2=patch.start2;patchCopy.length1=patch.length1;patchCopy.length2=patch.length2;patchesCopy[x]=patchCopy}return patchesCopy};diff_match_patch.prototype.patch_apply=function(patches,text){if(patches.length==0)return[text,[]];patches=this.patch_deepCopy(patches);var nullPadding=this.patch_addPadding(patches);text=nullPadding+text+nullPadding;this.patch_splitMax(patches);
var delta=0;var results=[];for(var x=0;x<patches.length;x++){var expected_loc=patches[x].start2+delta;var text1=this.diff_text1(patches[x].diffs);var start_loc;var end_loc=-1;if(text1.length>this.Match_MaxBits){start_loc=this.match_main(text,text1.substring(0,this.Match_MaxBits),expected_loc);if(start_loc!=-1){end_loc=this.match_main(text,text1.substring(text1.length-this.Match_MaxBits),expected_loc+text1.length-this.Match_MaxBits);if(end_loc==-1||start_loc>=end_loc)start_loc=-1}}else start_loc=this.match_main(text,
text1,expected_loc);if(start_loc==-1){results[x]=false;delta-=patches[x].length2-patches[x].length1}else{results[x]=true;delta=start_loc-expected_loc;var text2;if(end_loc==-1)text2=text.substring(start_loc,start_loc+text1.length);else text2=text.substring(start_loc,end_loc+this.Match_MaxBits);if(text1==text2)text=text.substring(0,start_loc)+this.diff_text2(patches[x].diffs)+text.substring(start_loc+text1.length);else{var diffs=this.diff_main(text1,text2,false);if(text1.length>this.Match_MaxBits&&
this.diff_levenshtein(diffs)/text1.length>this.Patch_DeleteThreshold)results[x]=false;else{this.diff_cleanupSemanticLossless(diffs);var index1=0;var index2;for(var y=0;y<patches[x].diffs.length;y++){var mod=patches[x].diffs[y];if(mod[0]!==DIFF_EQUAL)index2=this.diff_xIndex(diffs,index1);if(mod[0]===DIFF_INSERT)text=text.substring(0,start_loc+index2)+mod[1]+text.substring(start_loc+index2);else if(mod[0]===DIFF_DELETE)text=text.substring(0,start_loc+index2)+text.substring(start_loc+this.diff_xIndex(diffs,
index1+mod[1].length));if(mod[0]!==DIFF_DELETE)index1+=mod[1].length}}}}}text=text.substring(nullPadding.length,text.length-nullPadding.length);return[text,results]};diff_match_patch.prototype.patch_addPadding=function(patches){var paddingLength=this.Patch_Margin;var nullPadding="";for(var x=1;x<=paddingLength;x++)nullPadding+=String.fromCharCode(x);for(var x=0;x<patches.length;x++){patches[x].start1+=paddingLength;patches[x].start2+=paddingLength}var patch=patches[0];var diffs=patch.diffs;if(diffs.length==
0||diffs[0][0]!=DIFF_EQUAL){diffs.unshift([DIFF_EQUAL,nullPadding]);patch.start1-=paddingLength;patch.start2-=paddingLength;patch.length1+=paddingLength;patch.length2+=paddingLength}else if(paddingLength>diffs[0][1].length){var extraLength=paddingLength-diffs[0][1].length;diffs[0][1]=nullPadding.substring(diffs[0][1].length)+diffs[0][1];patch.start1-=extraLength;patch.start2-=extraLength;patch.length1+=extraLength;patch.length2+=extraLength}patch=patches[patches.length-1];diffs=patch.diffs;if(diffs.length==
0||diffs[diffs.length-1][0]!=DIFF_EQUAL){diffs.push([DIFF_EQUAL,nullPadding]);patch.length1+=paddingLength;patch.length2+=paddingLength}else if(paddingLength>diffs[diffs.length-1][1].length){var extraLength=paddingLength-diffs[diffs.length-1][1].length;diffs[diffs.length-1][1]+=nullPadding.substring(0,extraLength);patch.length1+=extraLength;patch.length2+=extraLength}return nullPadding};diff_match_patch.prototype.patch_splitMax=function(patches){var patch_size=this.Match_MaxBits;for(var x=0;x<patches.length;x++)if(patches[x].length1>
patch_size){var bigpatch=patches[x];patches.splice(x--,1);var start1=bigpatch.start1;var start2=bigpatch.start2;var precontext="";while(bigpatch.diffs.length!==0){var patch=new diff_match_patch.patch_obj;var empty=true;patch.start1=start1-precontext.length;patch.start2=start2-precontext.length;if(precontext!==""){patch.length1=patch.length2=precontext.length;patch.diffs.push([DIFF_EQUAL,precontext])}while(bigpatch.diffs.length!==0&&patch.length1<patch_size-this.Patch_Margin){var diff_type=bigpatch.diffs[0][0];
var diff_text=bigpatch.diffs[0][1];if(diff_type===DIFF_INSERT){patch.length2+=diff_text.length;start2+=diff_text.length;patch.diffs.push(bigpatch.diffs.shift());empty=false}else if(diff_type===DIFF_DELETE&&patch.diffs.length==1&&patch.diffs[0][0]==DIFF_EQUAL&&diff_text.length>2*patch_size){patch.length1+=diff_text.length;start1+=diff_text.length;empty=false;patch.diffs.push([diff_type,diff_text]);bigpatch.diffs.shift()}else{diff_text=diff_text.substring(0,patch_size-patch.length1-this.Patch_Margin);
patch.length1+=diff_text.length;start1+=diff_text.length;if(diff_type===DIFF_EQUAL){patch.length2+=diff_text.length;start2+=diff_text.length}else empty=false;patch.diffs.push([diff_type,diff_text]);if(diff_text==bigpatch.diffs[0][1])bigpatch.diffs.shift();else bigpatch.diffs[0][1]=bigpatch.diffs[0][1].substring(diff_text.length)}}precontext=this.diff_text2(patch.diffs);precontext=precontext.substring(precontext.length-this.Patch_Margin);var postcontext=this.diff_text1(bigpatch.diffs).substring(0,
this.Patch_Margin);if(postcontext!==""){patch.length1+=postcontext.length;patch.length2+=postcontext.length;if(patch.diffs.length!==0&&patch.diffs[patch.diffs.length-1][0]===DIFF_EQUAL)patch.diffs[patch.diffs.length-1][1]+=postcontext;else patch.diffs.push([DIFF_EQUAL,postcontext])}if(!empty)patches.splice(++x,0,patch)}}};diff_match_patch.prototype.patch_toText=function(patches){var text=[];for(var x=0;x<patches.length;x++)text[x]=patches[x];return text.join("")};diff_match_patch.prototype.patch_fromText=
function(textline){var patches=[];if(!textline)return patches;var text=textline.split("\n");var textPointer=0;var patchHeader=/^@@ -(\d+),?(\d*) \+(\d+),?(\d*) @@$/;while(textPointer<text.length){var m=text[textPointer].match(patchHeader);if(!m)throw new Error("Invalid patch string: "+text[textPointer]);var patch=new diff_match_patch.patch_obj;patches.push(patch);patch.start1=parseInt(m[1],10);if(m[2]===""){patch.start1--;patch.length1=1}else if(m[2]=="0")patch.length1=0;else{patch.start1--;patch.length1=
parseInt(m[2],10)}patch.start2=parseInt(m[3],10);if(m[4]===""){patch.start2--;patch.length2=1}else if(m[4]=="0")patch.length2=0;else{patch.start2--;patch.length2=parseInt(m[4],10)}textPointer++;while(textPointer<text.length){var sign=text[textPointer].charAt(0);try{var line=decodeURI(text[textPointer].substring(1))}catch(ex){throw new Error("Illegal escape in patch_fromText: "+line);}if(sign=="-")patch.diffs.push([DIFF_DELETE,line]);else if(sign=="+")patch.diffs.push([DIFF_INSERT,line]);else if(sign==
" ")patch.diffs.push([DIFF_EQUAL,line]);else if(sign=="@")break;else if(sign==="");else throw new Error('Invalid patch mode "'+sign+'" in: '+line);textPointer++}}return patches};diff_match_patch.patch_obj=function(){this.diffs=[];this.start1=null;this.start2=null;this.length1=0;this.length2=0};diff_match_patch.patch_obj.prototype.toString=function(){var coords1,coords2;if(this.length1===0)coords1=this.start1+",0";else if(this.length1==1)coords1=this.start1+1;else coords1=this.start1+1+","+this.length1;
if(this.length2===0)coords2=this.start2+",0";else if(this.length2==1)coords2=this.start2+1;else coords2=this.start2+1+","+this.length2;var text=["@@ -"+coords1+" +"+coords2+" @@\n"];var op;for(var x=0;x<this.diffs.length;x++){switch(this.diffs[x][0]){case DIFF_INSERT:op="+";break;case DIFF_DELETE:op="-";break;case DIFF_EQUAL:op=" ";break}text[x+1]=op+encodeURI(this.diffs[x][1])+"\n"}return text.join("").replace(/%20/g," ")};this["diff_match_patch"]=diff_match_patch;this["DIFF_DELETE"]=DIFF_DELETE;
this["DIFF_INSERT"]=DIFF_INSERT;this["DIFF_EQUAL"]=DIFF_EQUAL;(function(window,undefined){var document=window.document,navigator=window.navigator,location=window.location;var jQuery=function(){var jQuery=function(selector,context){return new jQuery.fn.init(selector,context,rootjQuery)},_jQuery=window.jQuery,_$=window.$,rootjQuery,quickExpr=/^(?:[^#<]*(<[\w\W]+>)[^>]*$|#([\w\-]*)$)/,rnotwhite=/\S/,trimLeft=/^\s+/,trimRight=/\s+$/,rsingleTag=/^<(\w+)\s*\/?>(?:<\/\1>)?$/,rvalidchars=/^[\],:{}\s]*$/,
rvalidescape=/\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g,rvalidtokens=/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,rvalidbraces=/(?:^|:|,)(?:\s*\[)+/g,rwebkit=/(webkit)[ \/]([\w.]+)/,ropera=/(opera)(?:.*version)?[ \/]([\w.]+)/,rmsie=/(msie) ([\w.]+)/,rmozilla=/(mozilla)(?:.*? rv:([\w.]+))?/,rdashAlpha=/-([a-z]|[0-9])/ig,rmsPrefix=/^-ms-/,fcamelCase=function(all,letter){return(letter+"").toUpperCase()},userAgent=navigator.userAgent,browserMatch,readyList,DOMContentLoaded,toString=Object.prototype.toString,
hasOwn=Object.prototype.hasOwnProperty,push=Array.prototype.push,slice=Array.prototype.slice,trim=String.prototype.trim,indexOf=Array.prototype.indexOf,class2type={};jQuery.fn=jQuery.prototype={constructor:jQuery,init:function(selector,context,rootjQuery){var match,elem,ret,doc;if(!selector)return this;if(selector.nodeType){this.context=this[0]=selector;this.length=1;return this}if(selector==="body"&&!context&&document.body){this.context=document;this[0]=document.body;this.selector=selector;this.length=
1;return this}if(typeof selector==="string"){if(selector.charAt(0)==="<"&&selector.charAt(selector.length-1)===">"&&selector.length>=3)match=[null,selector,null];else match=quickExpr.exec(selector);if(match&&(match[1]||!context))if(match[1]){context=context instanceof jQuery?context[0]:context;doc=context?context.ownerDocument||context:document;ret=rsingleTag.exec(selector);if(ret)if(jQuery.isPlainObject(context)){selector=[document.createElement(ret[1])];jQuery.fn.attr.call(selector,context,true)}else selector=
[doc.createElement(ret[1])];else{ret=jQuery.buildFragment([match[1]],[doc]);selector=(ret.cacheable?jQuery.clone(ret.fragment):ret.fragment).childNodes}return jQuery.merge(this,selector)}else{elem=document.getElementById(match[2]);if(elem&&elem.parentNode){if(elem.id!==match[2])return rootjQuery.find(selector);this.length=1;this[0]=elem}this.context=document;this.selector=selector;return this}else if(!context||context.jquery)return(context||rootjQuery).find(selector);else return this.constructor(context).find(selector)}else if(jQuery.isFunction(selector))return rootjQuery.ready(selector);
if(selector.selector!==undefined){this.selector=selector.selector;this.context=selector.context}return jQuery.makeArray(selector,this)},selector:"",jquery:"1.7.1",length:0,size:function(){return this.length},toArray:function(){return slice.call(this,0)},get:function(num){return num==null?this.toArray():num<0?this[this.length+num]:this[num]},pushStack:function(elems,name,selector){var ret=this.constructor();if(jQuery.isArray(elems))push.apply(ret,elems);else jQuery.merge(ret,elems);ret.prevObject=
this;ret.context=this.context;if(name==="find")ret.selector=this.selector+(this.selector?" ":"")+selector;else if(name)ret.selector=this.selector+"."+name+"("+selector+")";return ret},each:function(callback,args){return jQuery.each(this,callback,args)},ready:function(fn){jQuery.bindReady();readyList.add(fn);return this},eq:function(i){i=+i;return i===-1?this.slice(i):this.slice(i,i+1)},first:function(){return this.eq(0)},last:function(){return this.eq(-1)},slice:function(){return this.pushStack(slice.apply(this,
arguments),"slice",slice.call(arguments).join(","))},map:function(callback){return this.pushStack(jQuery.map(this,function(elem,i){return callback.call(elem,i,elem)}))},end:function(){return this.prevObject||this.constructor(null)},push:push,sort:[].sort,splice:[].splice};jQuery.fn.init.prototype=jQuery.fn;jQuery.extend=jQuery.fn.extend=function(){var options,name,src,copy,copyIsArray,clone,target=arguments[0]||{},i=1,length=arguments.length,deep=false;if(typeof target==="boolean"){deep=target;target=
arguments[1]||{};i=2}if(typeof target!=="object"&&!jQuery.isFunction(target))target={};if(length===i){target=this;--i}for(;i<length;i++)if((options=arguments[i])!=null)for(name in options){src=target[name];copy=options[name];if(target===copy)continue;if(deep&&copy&&(jQuery.isPlainObject(copy)||(copyIsArray=jQuery.isArray(copy)))){if(copyIsArray){copyIsArray=false;clone=src&&jQuery.isArray(src)?src:[]}else clone=src&&jQuery.isPlainObject(src)?src:{};target[name]=jQuery.extend(deep,clone,copy)}else if(copy!==
undefined)target[name]=copy}return target};jQuery.extend({noConflict:function(deep){if(window.$===jQuery)window.$=_$;if(deep&&window.jQuery===jQuery)window.jQuery=_jQuery;return jQuery},isReady:false,readyWait:1,holdReady:function(hold){if(hold)jQuery.readyWait++;else jQuery.ready(true)},ready:function(wait){if(wait===true&&!--jQuery.readyWait||wait!==true&&!jQuery.isReady){if(!document.body)return setTimeout(jQuery.ready,1);jQuery.isReady=true;if(wait!==true&&--jQuery.readyWait>0)return;readyList.fireWith(document,
[jQuery]);if(jQuery.fn.trigger)jQuery(document).trigger("ready").off("ready")}},bindReady:function(){if(readyList)return;readyList=jQuery.Callbacks("once memory");if(document.readyState==="complete")return setTimeout(jQuery.ready,1);if(document.addEventListener){document.addEventListener("DOMContentLoaded",DOMContentLoaded,false);window.addEventListener("load",jQuery.ready,false)}else if(document.attachEvent){document.attachEvent("onreadystatechange",DOMContentLoaded);window.attachEvent("onload",
jQuery.ready);var toplevel=false;try{toplevel=window.frameElement==null}catch(e){}if(document.documentElement.doScroll&&toplevel)doScrollCheck()}},isFunction:function(obj){return jQuery.type(obj)==="function"},isArray:Array.isArray||function(obj){return jQuery.type(obj)==="array"},isWindow:function(obj){return obj&&typeof obj==="object"&&"setInterval"in obj},isNumeric:function(obj){return!isNaN(parseFloat(obj))&&isFinite(obj)},type:function(obj){return obj==null?String(obj):class2type[toString.call(obj)]||
"object"},isPlainObject:function(obj){if(!obj||jQuery.type(obj)!=="object"||obj.nodeType||jQuery.isWindow(obj))return false;try{if(obj.constructor&&!hasOwn.call(obj,"constructor")&&!hasOwn.call(obj.constructor.prototype,"isPrototypeOf"))return false}catch(e){return false}var key;for(key in obj);return key===undefined||hasOwn.call(obj,key)},isEmptyObject:function(obj){for(var name in obj)return false;return true},error:function(msg){throw new Error(msg);},parseJSON:function(data){if(typeof data!==
"string"||!data)return null;data=jQuery.trim(data);if(window.JSON&&window.JSON.parse)return window.JSON.parse(data);if(rvalidchars.test(data.replace(rvalidescape,"@").replace(rvalidtokens,"]").replace(rvalidbraces,"")))return(new Function("return "+data))();jQuery.error("Invalid JSON: "+data)},parseXML:function(data){var xml,tmp;try{if(window.DOMParser){tmp=new DOMParser;xml=tmp.parseFromString(data,"text/xml")}else{xml=new ActiveXObject("Microsoft.XMLDOM");xml.async="false";xml.loadXML(data)}}catch(e){xml=
undefined}if(!xml||!xml.documentElement||xml.getElementsByTagName("parsererror").length)jQuery.error("Invalid XML: "+data);return xml},noop:function(){},globalEval:function(data){if(data&&rnotwhite.test(data))(window.execScript||function(data){window["eval"].call(window,data)})(data)},camelCase:function(string){return string.replace(rmsPrefix,"ms-").replace(rdashAlpha,fcamelCase)},nodeName:function(elem,name){return elem.nodeName&&elem.nodeName.toUpperCase()===name.toUpperCase()},each:function(object,
callback,args){var name,i=0,length=object.length,isObj=length===undefined||jQuery.isFunction(object);if(args)if(isObj)for(name in object){if(callback.apply(object[name],args)===false)break}else for(;i<length;){if(callback.apply(object[i++],args)===false)break}else if(isObj)for(name in object){if(callback.call(object[name],name,object[name])===false)break}else for(;i<length;)if(callback.call(object[i],i,object[i++])===false)break;return object},trim:trim?function(text){return text==null?"":trim.call(text)}:
function(text){return text==null?"":text.toString().replace(trimLeft,"").replace(trimRight,"")},makeArray:function(array,results){var ret=results||[];if(array!=null){var type=jQuery.type(array);if(array.length==null||type==="string"||type==="function"||type==="regexp"||jQuery.isWindow(array))push.call(ret,array);else jQuery.merge(ret,array)}return ret},inArray:function(elem,array,i){var len;if(array){if(indexOf)return indexOf.call(array,elem,i);len=array.length;i=i?i<0?Math.max(0,len+i):i:0;for(;i<
len;i++)if(i in array&&array[i]===elem)return i}return-1},merge:function(first,second){var i=first.length,j=0;if(typeof second.length==="number")for(var l=second.length;j<l;j++)first[i++]=second[j];else while(second[j]!==undefined)first[i++]=second[j++];first.length=i;return first},grep:function(elems,callback,inv){var ret=[],retVal;inv=!!inv;for(var i=0,length=elems.length;i<length;i++){retVal=!!callback(elems[i],i);if(inv!==retVal)ret.push(elems[i])}return ret},map:function(elems,callback,arg){var value,
key,ret=[],i=0,length=elems.length,isArray=elems instanceof jQuery||length!==undefined&&typeof length==="number"&&(length>0&&elems[0]&&elems[length-1]||length===0||jQuery.isArray(elems));if(isArray)for(;i<length;i++){value=callback(elems[i],i,arg);if(value!=null)ret[ret.length]=value}else for(key in elems){value=callback(elems[key],key,arg);if(value!=null)ret[ret.length]=value}return ret.concat.apply([],ret)},guid:1,proxy:function(fn,context){if(typeof context==="string"){var tmp=fn[context];context=
fn;fn=tmp}if(!jQuery.isFunction(fn))return undefined;var args=slice.call(arguments,2),proxy=function(){return fn.apply(context,args.concat(slice.call(arguments)))};proxy.guid=fn.guid=fn.guid||proxy.guid||jQuery.guid++;return proxy},access:function(elems,key,value,exec,fn,pass){var length=elems.length;if(typeof key==="object"){for(var k in key)jQuery.access(elems,k,key[k],exec,fn,value);return elems}if(value!==undefined){exec=!pass&&exec&&jQuery.isFunction(value);for(var i=0;i<length;i++)fn(elems[i],
key,exec?value.call(elems[i],i,fn(elems[i],key)):value,pass);return elems}return length?fn(elems[0],key):undefined},now:function(){return(new Date).getTime()},uaMatch:function(ua){ua=ua.toLowerCase();var match=rwebkit.exec(ua)||ropera.exec(ua)||rmsie.exec(ua)||ua.indexOf("compatible")<0&&rmozilla.exec(ua)||[];return{browser:match[1]||"",version:match[2]||"0"}},sub:function(){function jQuerySub(selector,context){return new jQuerySub.fn.init(selector,context)}jQuery.extend(true,jQuerySub,this);jQuerySub.superclass=
this;jQuerySub.fn=jQuerySub.prototype=this();jQuerySub.fn.constructor=jQuerySub;jQuerySub.sub=this.sub;jQuerySub.fn.init=function init(selector,context){if(context&&context instanceof jQuery&&!(context instanceof jQuerySub))context=jQuerySub(context);return jQuery.fn.init.call(this,selector,context,rootjQuerySub)};jQuerySub.fn.init.prototype=jQuerySub.fn;var rootjQuerySub=jQuerySub(document);return jQuerySub},browser:{}});jQuery.each("Boolean Number String Function Array Date RegExp Object".split(" "),
function(i,name){class2type["[object "+name+"]"]=name.toLowerCase()});browserMatch=jQuery.uaMatch(userAgent);if(browserMatch.browser){jQuery.browser[browserMatch.browser]=true;jQuery.browser.version=browserMatch.version}if(jQuery.browser.webkit)jQuery.browser.safari=true;if(rnotwhite.test("\u00a0")){trimLeft=/^[\s\xA0]+/;trimRight=/[\s\xA0]+$/}rootjQuery=jQuery(document);if(document.addEventListener)DOMContentLoaded=function(){document.removeEventListener("DOMContentLoaded",DOMContentLoaded,false);
jQuery.ready()};else if(document.attachEvent)DOMContentLoaded=function(){if(document.readyState==="complete"){document.detachEvent("onreadystatechange",DOMContentLoaded);jQuery.ready()}};function doScrollCheck(){if(jQuery.isReady)return;try{document.documentElement.doScroll("left")}catch(e){setTimeout(doScrollCheck,1);return}jQuery.ready()}return jQuery}();var flagsCache={};function createFlags(flags){var object=flagsCache[flags]={},i,length;flags=flags.split(/\s+/);for(i=0,length=flags.length;i<
length;i++)object[flags[i]]=true;return object}jQuery.Callbacks=function(flags){flags=flags?flagsCache[flags]||createFlags(flags):{};var list=[],stack=[],memory,firing,firingStart,firingLength,firingIndex,add=function(args){var i,length,elem,type,actual;for(i=0,length=args.length;i<length;i++){elem=args[i];type=jQuery.type(elem);if(type==="array")add(elem);else if(type==="function")if(!flags.unique||!self.has(elem))list.push(elem)}},fire=function(context,args){args=args||[];memory=!flags.memory||
[context,args];firing=true;firingIndex=firingStart||0;firingStart=0;firingLength=list.length;for(;list&&firingIndex<firingLength;firingIndex++)if(list[firingIndex].apply(context,args)===false&&flags.stopOnFalse){memory=true;break}firing=false;if(list)if(!flags.once){if(stack&&stack.length){memory=stack.shift();self.fireWith(memory[0],memory[1])}}else if(memory===true)self.disable();else list=[]},self={add:function(){if(list){var length=list.length;add(arguments);if(firing)firingLength=list.length;
else if(memory&&memory!==true){firingStart=length;fire(memory[0],memory[1])}}return this},remove:function(){if(list){var args=arguments,argIndex=0,argLength=args.length;for(;argIndex<argLength;argIndex++)for(var i=0;i<list.length;i++)if(args[argIndex]===list[i]){if(firing)if(i<=firingLength){firingLength--;if(i<=firingIndex)firingIndex--}list.splice(i--,1);if(flags.unique)break}}return this},has:function(fn){if(list){var i=0,length=list.length;for(;i<length;i++)if(fn===list[i])return true}return false},
empty:function(){list=[];return this},disable:function(){list=stack=memory=undefined;return this},disabled:function(){return!list},lock:function(){stack=undefined;if(!memory||memory===true)self.disable();return this},locked:function(){return!stack},fireWith:function(context,args){if(stack)if(firing){if(!flags.once)stack.push([context,args])}else if(!(flags.once&&memory))fire(context,args);return this},fire:function(){self.fireWith(this,arguments);return this},fired:function(){return!!memory}};return self};
var sliceDeferred=[].slice;jQuery.extend({Deferred:function(func){var doneList=jQuery.Callbacks("once memory"),failList=jQuery.Callbacks("once memory"),progressList=jQuery.Callbacks("memory"),state="pending",lists={resolve:doneList,reject:failList,notify:progressList},promise={done:doneList.add,fail:failList.add,progress:progressList.add,state:function(){return state},isResolved:doneList.fired,isRejected:failList.fired,then:function(doneCallbacks,failCallbacks,progressCallbacks){deferred.done(doneCallbacks).fail(failCallbacks).progress(progressCallbacks);
return this},always:function(){deferred.done.apply(deferred,arguments).fail.apply(deferred,arguments);return this},pipe:function(fnDone,fnFail,fnProgress){return jQuery.Deferred(function(newDefer){jQuery.each({done:[fnDone,"resolve"],fail:[fnFail,"reject"],progress:[fnProgress,"notify"]},function(handler,data){var fn=data[0],action=data[1],returned;if(jQuery.isFunction(fn))deferred[handler](function(){returned=fn.apply(this,arguments);if(returned&&jQuery.isFunction(returned.promise))returned.promise().then(newDefer.resolve,
newDefer.reject,newDefer.notify);else newDefer[action+"With"](this===deferred?newDefer:this,[returned])});else deferred[handler](newDefer[action])})}).promise()},promise:function(obj){if(obj==null)obj=promise;else for(var key in promise)obj[key]=promise[key];return obj}},deferred=promise.promise({}),key;for(key in lists){deferred[key]=lists[key].fire;deferred[key+"With"]=lists[key].fireWith}deferred.done(function(){state="resolved"},failList.disable,progressList.lock).fail(function(){state="rejected"},
doneList.disable,progressList.lock);if(func)func.call(deferred,deferred);return deferred},when:function(firstParam){var args=sliceDeferred.call(arguments,0),i=0,length=args.length,pValues=new Array(length),count=length,pCount=length,deferred=length<=1&&firstParam&&jQuery.isFunction(firstParam.promise)?firstParam:jQuery.Deferred(),promise=deferred.promise();function resolveFunc(i){return function(value){args[i]=arguments.length>1?sliceDeferred.call(arguments,0):value;if(!--count)deferred.resolveWith(deferred,
args)}}function progressFunc(i){return function(value){pValues[i]=arguments.length>1?sliceDeferred.call(arguments,0):value;deferred.notifyWith(promise,pValues)}}if(length>1){for(;i<length;i++)if(args[i]&&args[i].promise&&jQuery.isFunction(args[i].promise))args[i].promise().then(resolveFunc(i),deferred.reject,progressFunc(i));else--count;if(!count)deferred.resolveWith(deferred,args)}else if(deferred!==firstParam)deferred.resolveWith(deferred,length?[firstParam]:[]);return promise}});jQuery.support=
function(){var support,all,a,select,opt,input,marginDiv,fragment,tds,events,eventName,i,isSupported,div=document.createElement("div"),documentElement=document.documentElement;div.setAttribute("className","t");div.innerHTML="   <link/><table></table><a href='/a' style='top:1px;float:left;opacity:.55;'>a</a><input type='checkbox'/>";all=div.getElementsByTagName("*");a=div.getElementsByTagName("a")[0];if(!all||!all.length||!a)return{};select=document.createElement("select");opt=select.appendChild(document.createElement("option"));
input=div.getElementsByTagName("input")[0];support={leadingWhitespace:div.firstChild.nodeType===3,tbody:!div.getElementsByTagName("tbody").length,htmlSerialize:!!div.getElementsByTagName("link").length,style:/top/.test(a.getAttribute("style")),hrefNormalized:a.getAttribute("href")==="/a",opacity:/^0.55/.test(a.style.opacity),cssFloat:!!a.style.cssFloat,checkOn:input.value==="on",optSelected:opt.selected,getSetAttribute:div.className!=="t",enctype:!!document.createElement("form").enctype,html5Clone:document.createElement("nav").cloneNode(true).outerHTML!==
"<:nav></:nav>",submitBubbles:true,changeBubbles:true,focusinBubbles:false,deleteExpando:true,noCloneEvent:true,inlineBlockNeedsLayout:false,shrinkWrapBlocks:false,reliableMarginRight:true};input.checked=true;support.noCloneChecked=input.cloneNode(true).checked;select.disabled=true;support.optDisabled=!opt.disabled;try{delete div.test}catch(e){support.deleteExpando=false}if(!div.addEventListener&&div.attachEvent&&div.fireEvent){div.attachEvent("onclick",function(){support.noCloneEvent=false});div.cloneNode(true).fireEvent("onclick")}input=
document.createElement("input");input.value="t";input.setAttribute("type","radio");support.radioValue=input.value==="t";input.setAttribute("checked","checked");div.appendChild(input);fragment=document.createDocumentFragment();fragment.appendChild(div.lastChild);support.checkClone=fragment.cloneNode(true).cloneNode(true).lastChild.checked;support.appendChecked=input.checked;fragment.removeChild(input);fragment.appendChild(div);div.innerHTML="";if(window.getComputedStyle){marginDiv=document.createElement("div");
marginDiv.style.width="0";marginDiv.style.marginRight="0";div.style.width="2px";div.appendChild(marginDiv);support.reliableMarginRight=(parseInt((window.getComputedStyle(marginDiv,null)||{marginRight:0}).marginRight,10)||0)===0}if(div.attachEvent)for(i in{submit:1,change:1,focusin:1}){eventName="on"+i;isSupported=eventName in div;if(!isSupported){div.setAttribute(eventName,"return;");isSupported=typeof div[eventName]==="function"}support[i+"Bubbles"]=isSupported}fragment.removeChild(div);fragment=
select=opt=marginDiv=div=input=null;jQuery(function(){var container,outer,inner,table,td,offsetSupport,conMarginTop,ptlm,vb,style,html,body=document.getElementsByTagName("body")[0];if(!body)return;conMarginTop=1;ptlm="position:absolute;top:0;left:0;width:1px;height:1px;margin:0;";vb="visibility:hidden;border:0;";style="style='"+ptlm+"border:5px solid #000;padding:0;'";html="<div "+style+"><div></div></div>"+"<table "+style+" cellpadding='0' cellspacing='0'>"+"<tr><td></td></tr></table>";container=
document.createElement("div");container.style.cssText=vb+"width:0;height:0;position:static;top:0;margin-top:"+conMarginTop+"px";body.insertBefore(container,body.firstChild);div=document.createElement("div");container.appendChild(div);div.innerHTML="<table><tr><td style='padding:0;border:0;display:none'></td><td>t</td></tr></table>";tds=div.getElementsByTagName("td");isSupported=tds[0].offsetHeight===0;tds[0].style.display="";tds[1].style.display="none";support.reliableHiddenOffsets=isSupported&&tds[0].offsetHeight===
0;div.innerHTML="";div.style.width=div.style.paddingLeft="1px";jQuery.boxModel=support.boxModel=div.offsetWidth===2;if(typeof div.style.zoom!=="undefined"){div.style.display="inline";div.style.zoom=1;support.inlineBlockNeedsLayout=div.offsetWidth===2;div.style.display="";div.innerHTML="<div style='width:4px;'></div>";support.shrinkWrapBlocks=div.offsetWidth!==2}div.style.cssText=ptlm+vb;div.innerHTML=html;outer=div.firstChild;inner=outer.firstChild;td=outer.nextSibling.firstChild.firstChild;offsetSupport=
{doesNotAddBorder:inner.offsetTop!==5,doesAddBorderForTableAndCells:td.offsetTop===5};inner.style.position="fixed";inner.style.top="20px";offsetSupport.fixedPosition=inner.offsetTop===20||inner.offsetTop===15;inner.style.position=inner.style.top="";outer.style.overflow="hidden";outer.style.position="relative";offsetSupport.subtractsBorderForOverflowNotVisible=inner.offsetTop===-5;offsetSupport.doesNotIncludeMarginInBodyOffset=body.offsetTop!==conMarginTop;body.removeChild(container);div=container=
null;jQuery.extend(support,offsetSupport)});return support}();var rbrace=/^(?:\{.*\}|\[.*\])$/,rmultiDash=/([A-Z])/g;jQuery.extend({cache:{},uuid:0,expando:"jQuery"+(jQuery.fn.jquery+Math.random()).replace(/\D/g,""),noData:{"embed":true,"object":"clsid:D27CDB6E-AE6D-11cf-96B8-444553540000","applet":true},hasData:function(elem){elem=elem.nodeType?jQuery.cache[elem[jQuery.expando]]:elem[jQuery.expando];return!!elem&&!isEmptyDataObject(elem)},data:function(elem,name,data,pvt){if(!jQuery.acceptData(elem))return;
var privateCache,thisCache,ret,internalKey=jQuery.expando,getByName=typeof name==="string",isNode=elem.nodeType,cache=isNode?jQuery.cache:elem,id=isNode?elem[internalKey]:elem[internalKey]&&internalKey,isEvents=name==="events";if((!id||!cache[id]||!isEvents&&!pvt&&!cache[id].data)&&getByName&&data===undefined)return;if(!id)if(isNode)elem[internalKey]=id=++jQuery.uuid;else id=internalKey;if(!cache[id]){cache[id]={};if(!isNode)cache[id].toJSON=jQuery.noop}if(typeof name==="object"||typeof name==="function")if(pvt)cache[id]=
jQuery.extend(cache[id],name);else cache[id].data=jQuery.extend(cache[id].data,name);privateCache=thisCache=cache[id];if(!pvt){if(!thisCache.data)thisCache.data={};thisCache=thisCache.data}if(data!==undefined)thisCache[jQuery.camelCase(name)]=data;if(isEvents&&!thisCache[name])return privateCache.events;if(getByName){ret=thisCache[name];if(ret==null)ret=thisCache[jQuery.camelCase(name)]}else ret=thisCache;return ret},removeData:function(elem,name,pvt){if(!jQuery.acceptData(elem))return;var thisCache,
i,l,internalKey=jQuery.expando,isNode=elem.nodeType,cache=isNode?jQuery.cache:elem,id=isNode?elem[internalKey]:internalKey;if(!cache[id])return;if(name){thisCache=pvt?cache[id]:cache[id].data;if(thisCache){if(!jQuery.isArray(name))if(name in thisCache)name=[name];else{name=jQuery.camelCase(name);if(name in thisCache)name=[name];else name=name.split(" ")}for(i=0,l=name.length;i<l;i++)delete thisCache[name[i]];if(!(pvt?isEmptyDataObject:jQuery.isEmptyObject)(thisCache))return}}if(!pvt){delete cache[id].data;
if(!isEmptyDataObject(cache[id]))return}if(jQuery.support.deleteExpando||!cache.setInterval)delete cache[id];else cache[id]=null;if(isNode)if(jQuery.support.deleteExpando)delete elem[internalKey];else if(elem.removeAttribute)elem.removeAttribute(internalKey);else elem[internalKey]=null},_data:function(elem,name,data){return jQuery.data(elem,name,data,true)},acceptData:function(elem){if(elem.nodeName){var match=jQuery.noData[elem.nodeName.toLowerCase()];if(match)return!(match===true||elem.getAttribute("classid")!==
match)}return true}});jQuery.fn.extend({data:function(key,value){var parts,attr,name,data=null;if(typeof key==="undefined"){if(this.length){data=jQuery.data(this[0]);if(this[0].nodeType===1&&!jQuery._data(this[0],"parsedAttrs")){attr=this[0].attributes;for(var i=0,l=attr.length;i<l;i++){name=attr[i].name;if(name.indexOf("data-")===0){name=jQuery.camelCase(name.substring(5));dataAttr(this[0],name,data[name])}}jQuery._data(this[0],"parsedAttrs",true)}}return data}else if(typeof key==="object")return this.each(function(){jQuery.data(this,
key)});parts=key.split(".");parts[1]=parts[1]?"."+parts[1]:"";if(value===undefined){data=this.triggerHandler("getData"+parts[1]+"!",[parts[0]]);if(data===undefined&&this.length){data=jQuery.data(this[0],key);data=dataAttr(this[0],key,data)}return data===undefined&&parts[1]?this.data(parts[0]):data}else return this.each(function(){var self=jQuery(this),args=[parts[0],value];self.triggerHandler("setData"+parts[1]+"!",args);jQuery.data(this,key,value);self.triggerHandler("changeData"+parts[1]+"!",args)})},
removeData:function(key){return this.each(function(){jQuery.removeData(this,key)})}});function dataAttr(elem,key,data){if(data===undefined&&elem.nodeType===1){var name="data-"+key.replace(rmultiDash,"-$1").toLowerCase();data=elem.getAttribute(name);if(typeof data==="string"){try{data=data==="true"?true:data==="false"?false:data==="null"?null:jQuery.isNumeric(data)?parseFloat(data):rbrace.test(data)?jQuery.parseJSON(data):data}catch(e){}jQuery.data(elem,key,data)}else data=undefined}return data}function isEmptyDataObject(obj){for(var name in obj){if(name===
"data"&&jQuery.isEmptyObject(obj[name]))continue;if(name!=="toJSON")return false}return true}function handleQueueMarkDefer(elem,type,src){var deferDataKey=type+"defer",queueDataKey=type+"queue",markDataKey=type+"mark",defer=jQuery._data(elem,deferDataKey);if(defer&&(src==="queue"||!jQuery._data(elem,queueDataKey))&&(src==="mark"||!jQuery._data(elem,markDataKey)))setTimeout(function(){if(!jQuery._data(elem,queueDataKey)&&!jQuery._data(elem,markDataKey)){jQuery.removeData(elem,deferDataKey,true);defer.fire()}},
0)}jQuery.extend({_mark:function(elem,type){if(elem){type=(type||"fx")+"mark";jQuery._data(elem,type,(jQuery._data(elem,type)||0)+1)}},_unmark:function(force,elem,type){if(force!==true){type=elem;elem=force;force=false}if(elem){type=type||"fx";var key=type+"mark",count=force?0:(jQuery._data(elem,key)||1)-1;if(count)jQuery._data(elem,key,count);else{jQuery.removeData(elem,key,true);handleQueueMarkDefer(elem,type,"mark")}}},queue:function(elem,type,data){var q;if(elem){type=(type||"fx")+"queue";q=jQuery._data(elem,
type);if(data)if(!q||jQuery.isArray(data))q=jQuery._data(elem,type,jQuery.makeArray(data));else q.push(data);return q||[]}},dequeue:function(elem,type){type=type||"fx";var queue=jQuery.queue(elem,type),fn=queue.shift(),hooks={};if(fn==="inprogress")fn=queue.shift();if(fn){if(type==="fx")queue.unshift("inprogress");jQuery._data(elem,type+".run",hooks);fn.call(elem,function(){jQuery.dequeue(elem,type)},hooks)}if(!queue.length){jQuery.removeData(elem,type+"queue "+type+".run",true);handleQueueMarkDefer(elem,
type,"queue")}}});jQuery.fn.extend({queue:function(type,data){if(typeof type!=="string"){data=type;type="fx"}if(data===undefined)return jQuery.queue(this[0],type);return this.each(function(){var queue=jQuery.queue(this,type,data);if(type==="fx"&&queue[0]!=="inprogress")jQuery.dequeue(this,type)})},dequeue:function(type){return this.each(function(){jQuery.dequeue(this,type)})},delay:function(time,type){time=jQuery.fx?jQuery.fx.speeds[time]||time:time;type=type||"fx";return this.queue(type,function(next,
hooks){var timeout=setTimeout(next,time);hooks.stop=function(){clearTimeout(timeout)}})},clearQueue:function(type){return this.queue(type||"fx",[])},promise:function(type,object){if(typeof type!=="string"){object=type;type=undefined}type=type||"fx";var defer=jQuery.Deferred(),elements=this,i=elements.length,count=1,deferDataKey=type+"defer",queueDataKey=type+"queue",markDataKey=type+"mark",tmp;function resolve(){if(!--count)defer.resolveWith(elements,[elements])}while(i--)if(tmp=jQuery.data(elements[i],
deferDataKey,undefined,true)||(jQuery.data(elements[i],queueDataKey,undefined,true)||jQuery.data(elements[i],markDataKey,undefined,true))&&jQuery.data(elements[i],deferDataKey,jQuery.Callbacks("once memory"),true)){count++;tmp.add(resolve)}resolve();return defer.promise()}});var rclass=/[\n\t\r]/g,rspace=/\s+/,rreturn=/\r/g,rtype=/^(?:button|input)$/i,rfocusable=/^(?:button|input|object|select|textarea)$/i,rclickable=/^a(?:rea)?$/i,rboolean=/^(?:autofocus|autoplay|async|checked|controls|defer|disabled|hidden|loop|multiple|open|readonly|required|scoped|selected)$/i,
getSetAttribute=jQuery.support.getSetAttribute,nodeHook,boolHook,fixSpecified;jQuery.fn.extend({attr:function(name,value){return jQuery.access(this,name,value,true,jQuery.attr)},removeAttr:function(name){return this.each(function(){jQuery.removeAttr(this,name)})},prop:function(name,value){return jQuery.access(this,name,value,true,jQuery.prop)},removeProp:function(name){name=jQuery.propFix[name]||name;return this.each(function(){try{this[name]=undefined;delete this[name]}catch(e){}})},addClass:function(value){var classNames,
i,l,elem,setClass,c,cl;if(jQuery.isFunction(value))return this.each(function(j){jQuery(this).addClass(value.call(this,j,this.className))});if(value&&typeof value==="string"){classNames=value.split(rspace);for(i=0,l=this.length;i<l;i++){elem=this[i];if(elem.nodeType===1)if(!elem.className&&classNames.length===1)elem.className=value;else{setClass=" "+elem.className+" ";for(c=0,cl=classNames.length;c<cl;c++)if(!~setClass.indexOf(" "+classNames[c]+" "))setClass+=classNames[c]+" ";elem.className=jQuery.trim(setClass)}}}return this},
removeClass:function(value){var classNames,i,l,elem,className,c,cl;if(jQuery.isFunction(value))return this.each(function(j){jQuery(this).removeClass(value.call(this,j,this.className))});if(value&&typeof value==="string"||value===undefined){classNames=(value||"").split(rspace);for(i=0,l=this.length;i<l;i++){elem=this[i];if(elem.nodeType===1&&elem.className)if(value){className=(" "+elem.className+" ").replace(rclass," ");for(c=0,cl=classNames.length;c<cl;c++)className=className.replace(" "+classNames[c]+
" "," ");elem.className=jQuery.trim(className)}else elem.className=""}}return this},toggleClass:function(value,stateVal){var type=typeof value,isBool=typeof stateVal==="boolean";if(jQuery.isFunction(value))return this.each(function(i){jQuery(this).toggleClass(value.call(this,i,this.className,stateVal),stateVal)});return this.each(function(){if(type==="string"){var className,i=0,self=jQuery(this),state=stateVal,classNames=value.split(rspace);while(className=classNames[i++]){state=isBool?state:!self.hasClass(className);
self[state?"addClass":"removeClass"](className)}}else if(type==="undefined"||type==="boolean"){if(this.className)jQuery._data(this,"__className__",this.className);this.className=this.className||value===false?"":jQuery._data(this,"__className__")||""}})},hasClass:function(selector){var className=" "+selector+" ",i=0,l=this.length;for(;i<l;i++)if(this[i].nodeType===1&&(" "+this[i].className+" ").replace(rclass," ").indexOf(className)>-1)return true;return false},val:function(value){var hooks,ret,isFunction,
elem=this[0];if(!arguments.length){if(elem){hooks=jQuery.valHooks[elem.nodeName.toLowerCase()]||jQuery.valHooks[elem.type];if(hooks&&"get"in hooks&&(ret=hooks.get(elem,"value"))!==undefined)return ret;ret=elem.value;return typeof ret==="string"?ret.replace(rreturn,""):ret==null?"":ret}return}isFunction=jQuery.isFunction(value);return this.each(function(i){var self=jQuery(this),val;if(this.nodeType!==1)return;if(isFunction)val=value.call(this,i,self.val());else val=value;if(val==null)val="";else if(typeof val===
"number")val+="";else if(jQuery.isArray(val))val=jQuery.map(val,function(value){return value==null?"":value+""});hooks=jQuery.valHooks[this.nodeName.toLowerCase()]||jQuery.valHooks[this.type];if(!hooks||!("set"in hooks)||hooks.set(this,val,"value")===undefined)this.value=val})}});jQuery.extend({valHooks:{option:{get:function(elem){var val=elem.attributes.value;return!val||val.specified?elem.value:elem.text}},select:{get:function(elem){var value,i,max,option,index=elem.selectedIndex,values=[],options=
elem.options,one=elem.type==="select-one";if(index<0)return null;i=one?index:0;max=one?index+1:options.length;for(;i<max;i++){option=options[i];if(option.selected&&(jQuery.support.optDisabled?!option.disabled:option.getAttribute("disabled")===null)&&(!option.parentNode.disabled||!jQuery.nodeName(option.parentNode,"optgroup"))){value=jQuery(option).val();if(one)return value;values.push(value)}}if(one&&!values.length&&options.length)return jQuery(options[index]).val();return values},set:function(elem,
value){var values=jQuery.makeArray(value);jQuery(elem).find("option").each(function(){this.selected=jQuery.inArray(jQuery(this).val(),values)>=0});if(!values.length)elem.selectedIndex=-1;return values}}},attrFn:{val:true,css:true,html:true,text:true,data:true,width:true,height:true,offset:true},attr:function(elem,name,value,pass){var ret,hooks,notxml,nType=elem.nodeType;if(!elem||nType===3||nType===8||nType===2)return;if(pass&&name in jQuery.attrFn)return jQuery(elem)[name](value);if(typeof elem.getAttribute===
"undefined")return jQuery.prop(elem,name,value);notxml=nType!==1||!jQuery.isXMLDoc(elem);if(notxml){name=name.toLowerCase();hooks=jQuery.attrHooks[name]||(rboolean.test(name)?boolHook:nodeHook)}if(value!==undefined)if(value===null){jQuery.removeAttr(elem,name);return}else if(hooks&&"set"in hooks&&notxml&&(ret=hooks.set(elem,value,name))!==undefined)return ret;else{elem.setAttribute(name,""+value);return value}else if(hooks&&"get"in hooks&&notxml&&(ret=hooks.get(elem,name))!==null)return ret;else{ret=
elem.getAttribute(name);return ret===null?undefined:ret}},removeAttr:function(elem,value){var propName,attrNames,name,l,i=0;if(value&&elem.nodeType===1){attrNames=value.toLowerCase().split(rspace);l=attrNames.length;for(;i<l;i++){name=attrNames[i];if(name){propName=jQuery.propFix[name]||name;jQuery.attr(elem,name,"");elem.removeAttribute(getSetAttribute?name:propName);if(rboolean.test(name)&&propName in elem)elem[propName]=false}}}},attrHooks:{type:{set:function(elem,value){if(rtype.test(elem.nodeName)&&
elem.parentNode)jQuery.error("type property can't be changed");else if(!jQuery.support.radioValue&&value==="radio"&&jQuery.nodeName(elem,"input")){var val=elem.value;elem.setAttribute("type",value);if(val)elem.value=val;return value}}},value:{get:function(elem,name){if(nodeHook&&jQuery.nodeName(elem,"button"))return nodeHook.get(elem,name);return name in elem?elem.value:null},set:function(elem,value,name){if(nodeHook&&jQuery.nodeName(elem,"button"))return nodeHook.set(elem,value,name);elem.value=
value}}},propFix:{tabindex:"tabIndex",readonly:"readOnly","for":"htmlFor","class":"className",maxlength:"maxLength",cellspacing:"cellSpacing",cellpadding:"cellPadding",rowspan:"rowSpan",colspan:"colSpan",usemap:"useMap",frameborder:"frameBorder",contenteditable:"contentEditable"},prop:function(elem,name,value){var ret,hooks,notxml,nType=elem.nodeType;if(!elem||nType===3||nType===8||nType===2)return;notxml=nType!==1||!jQuery.isXMLDoc(elem);if(notxml){name=jQuery.propFix[name]||name;hooks=jQuery.propHooks[name]}if(value!==
undefined)if(hooks&&"set"in hooks&&(ret=hooks.set(elem,value,name))!==undefined)return ret;else return elem[name]=value;else if(hooks&&"get"in hooks&&(ret=hooks.get(elem,name))!==null)return ret;else return elem[name]},propHooks:{tabIndex:{get:function(elem){var attributeNode=elem.getAttributeNode("tabindex");return attributeNode&&attributeNode.specified?parseInt(attributeNode.value,10):rfocusable.test(elem.nodeName)||rclickable.test(elem.nodeName)&&elem.href?0:undefined}}}});jQuery.attrHooks.tabindex=
jQuery.propHooks.tabIndex;boolHook={get:function(elem,name){var attrNode,property=jQuery.prop(elem,name);return property===true||typeof property!=="boolean"&&(attrNode=elem.getAttributeNode(name))&&attrNode.nodeValue!==false?name.toLowerCase():undefined},set:function(elem,value,name){var propName;if(value===false)jQuery.removeAttr(elem,name);else{propName=jQuery.propFix[name]||name;if(propName in elem)elem[propName]=true;elem.setAttribute(name,name.toLowerCase())}return name}};if(!getSetAttribute){fixSpecified=
{name:true,id:true};nodeHook=jQuery.valHooks.button={get:function(elem,name){var ret;ret=elem.getAttributeNode(name);return ret&&(fixSpecified[name]?ret.nodeValue!=="":ret.specified)?ret.nodeValue:undefined},set:function(elem,value,name){var ret=elem.getAttributeNode(name);if(!ret){ret=document.createAttribute(name);elem.setAttributeNode(ret)}return ret.nodeValue=value+""}};jQuery.attrHooks.tabindex.set=nodeHook.set;jQuery.each(["width","height"],function(i,name){jQuery.attrHooks[name]=jQuery.extend(jQuery.attrHooks[name],
{set:function(elem,value){if(value===""){elem.setAttribute(name,"auto");return value}}})});jQuery.attrHooks.contenteditable={get:nodeHook.get,set:function(elem,value,name){if(value==="")value="false";nodeHook.set(elem,value,name)}}}if(!jQuery.support.hrefNormalized)jQuery.each(["href","src","width","height"],function(i,name){jQuery.attrHooks[name]=jQuery.extend(jQuery.attrHooks[name],{get:function(elem){var ret=elem.getAttribute(name,2);return ret===null?undefined:ret}})});if(!jQuery.support.style)jQuery.attrHooks.style=
{get:function(elem){return elem.style.cssText.toLowerCase()||undefined},set:function(elem,value){return elem.style.cssText=""+value}};if(!jQuery.support.optSelected)jQuery.propHooks.selected=jQuery.extend(jQuery.propHooks.selected,{get:function(elem){var parent=elem.parentNode;if(parent){parent.selectedIndex;if(parent.parentNode)parent.parentNode.selectedIndex}return null}});if(!jQuery.support.enctype)jQuery.propFix.enctype="encoding";if(!jQuery.support.checkOn)jQuery.each(["radio","checkbox"],function(){jQuery.valHooks[this]=
{get:function(elem){return elem.getAttribute("value")===null?"on":elem.value}}});jQuery.each(["radio","checkbox"],function(){jQuery.valHooks[this]=jQuery.extend(jQuery.valHooks[this],{set:function(elem,value){if(jQuery.isArray(value))return elem.checked=jQuery.inArray(jQuery(elem).val(),value)>=0}})});var rformElems=/^(?:textarea|input|select)$/i,rtypenamespace=/^([^\.]*)?(?:\.(.+))?$/,rhoverHack=/\bhover(\.\S+)?\b/,rkeyEvent=/^key/,rmouseEvent=/^(?:mouse|contextmenu)|click/,rfocusMorph=/^(?:focusinfocus|focusoutblur)$/,
rquickIs=/^(\w*)(?:#([\w\-]+))?(?:\.([\w\-]+))?$/,quickParse=function(selector){var quick=rquickIs.exec(selector);if(quick){quick[1]=(quick[1]||"").toLowerCase();quick[3]=quick[3]&&new RegExp("(?:^|\\s)"+quick[3]+"(?:\\s|$)")}return quick},quickIs=function(elem,m){var attrs=elem.attributes||{};return(!m[1]||elem.nodeName.toLowerCase()===m[1])&&(!m[2]||(attrs.id||{}).value===m[2])&&(!m[3]||m[3].test((attrs["class"]||{}).value))},hoverHack=function(events){return jQuery.event.special.hover?events:events.replace(rhoverHack,
"mouseenter$1 mouseleave$1")};jQuery.event={add:function(elem,types,handler,data,selector){var elemData,eventHandle,events,t,tns,type,namespaces,handleObj,handleObjIn,quick,handlers,special;if(elem.nodeType===3||elem.nodeType===8||!types||!handler||!(elemData=jQuery._data(elem)))return;if(handler.handler){handleObjIn=handler;handler=handleObjIn.handler}if(!handler.guid)handler.guid=jQuery.guid++;events=elemData.events;if(!events)elemData.events=events={};eventHandle=elemData.handle;if(!eventHandle){elemData.handle=
eventHandle=function(e){return typeof jQuery!=="undefined"&&(!e||jQuery.event.triggered!==e.type)?jQuery.event.dispatch.apply(eventHandle.elem,arguments):undefined};eventHandle.elem=elem}types=jQuery.trim(hoverHack(types)).split(" ");for(t=0;t<types.length;t++){tns=rtypenamespace.exec(types[t])||[];type=tns[1];namespaces=(tns[2]||"").split(".").sort();special=jQuery.event.special[type]||{};type=(selector?special.delegateType:special.bindType)||type;special=jQuery.event.special[type]||{};handleObj=
jQuery.extend({type:type,origType:tns[1],data:data,handler:handler,guid:handler.guid,selector:selector,quick:quickParse(selector),namespace:namespaces.join(".")},handleObjIn);handlers=events[type];if(!handlers){handlers=events[type]=[];handlers.delegateCount=0;if(!special.setup||special.setup.call(elem,data,namespaces,eventHandle)===false)if(elem.addEventListener)elem.addEventListener(type,eventHandle,false);else if(elem.attachEvent)elem.attachEvent("on"+type,eventHandle)}if(special.add){special.add.call(elem,
handleObj);if(!handleObj.handler.guid)handleObj.handler.guid=handler.guid}if(selector)handlers.splice(handlers.delegateCount++,0,handleObj);else handlers.push(handleObj);jQuery.event.global[type]=true}elem=null},global:{},remove:function(elem,types,handler,selector,mappedTypes){var elemData=jQuery.hasData(elem)&&jQuery._data(elem),t,tns,type,origType,namespaces,origCount,j,events,special,handle,eventType,handleObj;if(!elemData||!(events=elemData.events))return;types=jQuery.trim(hoverHack(types||"")).split(" ");
for(t=0;t<types.length;t++){tns=rtypenamespace.exec(types[t])||[];type=origType=tns[1];namespaces=tns[2];if(!type){for(type in events)jQuery.event.remove(elem,type+types[t],handler,selector,true);continue}special=jQuery.event.special[type]||{};type=(selector?special.delegateType:special.bindType)||type;eventType=events[type]||[];origCount=eventType.length;namespaces=namespaces?new RegExp("(^|\\.)"+namespaces.split(".").sort().join("\\.(?:.*\\.)?")+"(\\.|$)"):null;for(j=0;j<eventType.length;j++){handleObj=
eventType[j];if((mappedTypes||origType===handleObj.origType)&&(!handler||handler.guid===handleObj.guid)&&(!namespaces||namespaces.test(handleObj.namespace))&&(!selector||selector===handleObj.selector||selector==="**"&&handleObj.selector)){eventType.splice(j--,1);if(handleObj.selector)eventType.delegateCount--;if(special.remove)special.remove.call(elem,handleObj)}}if(eventType.length===0&&origCount!==eventType.length){if(!special.teardown||special.teardown.call(elem,namespaces)===false)jQuery.removeEvent(elem,
type,elemData.handle);delete events[type]}}if(jQuery.isEmptyObject(events)){handle=elemData.handle;if(handle)handle.elem=null;jQuery.removeData(elem,["events","handle"],true)}},customEvent:{"getData":true,"setData":true,"changeData":true},trigger:function(event,data,elem,onlyHandlers){if(elem&&(elem.nodeType===3||elem.nodeType===8))return;var type=event.type||event,namespaces=[],cache,exclusive,i,cur,old,ontype,special,handle,eventPath,bubbleType;if(rfocusMorph.test(type+jQuery.event.triggered))return;
if(type.indexOf("!")>=0){type=type.slice(0,-1);exclusive=true}if(type.indexOf(".")>=0){namespaces=type.split(".");type=namespaces.shift();namespaces.sort()}if((!elem||jQuery.event.customEvent[type])&&!jQuery.event.global[type])return;event=typeof event==="object"?event[jQuery.expando]?event:new jQuery.Event(type,event):new jQuery.Event(type);event.type=type;event.isTrigger=true;event.exclusive=exclusive;event.namespace=namespaces.join(".");event.namespace_re=event.namespace?new RegExp("(^|\\.)"+namespaces.join("\\.(?:.*\\.)?")+
"(\\.|$)"):null;ontype=type.indexOf(":")<0?"on"+type:"";if(!elem){cache=jQuery.cache;for(i in cache)if(cache[i].events&&cache[i].events[type])jQuery.event.trigger(event,data,cache[i].handle.elem,true);return}event.result=undefined;if(!event.target)event.target=elem;data=data!=null?jQuery.makeArray(data):[];data.unshift(event);special=jQuery.event.special[type]||{};if(special.trigger&&special.trigger.apply(elem,data)===false)return;eventPath=[[elem,special.bindType||type]];if(!onlyHandlers&&!special.noBubble&&
!jQuery.isWindow(elem)){bubbleType=special.delegateType||type;cur=rfocusMorph.test(bubbleType+type)?elem:elem.parentNode;old=null;for(;cur;cur=cur.parentNode){eventPath.push([cur,bubbleType]);old=cur}if(old&&old===elem.ownerDocument)eventPath.push([old.defaultView||old.parentWindow||window,bubbleType])}for(i=0;i<eventPath.length&&!event.isPropagationStopped();i++){cur=eventPath[i][0];event.type=eventPath[i][1];handle=(jQuery._data(cur,"events")||{})[event.type]&&jQuery._data(cur,"handle");if(handle)handle.apply(cur,
data);handle=ontype&&cur[ontype];if(handle&&jQuery.acceptData(cur)&&handle.apply(cur,data)===false)event.preventDefault()}event.type=type;if(!onlyHandlers&&!event.isDefaultPrevented())if((!special._default||special._default.apply(elem.ownerDocument,data)===false)&&!(type==="click"&&jQuery.nodeName(elem,"a"))&&jQuery.acceptData(elem))if(ontype&&elem[type]&&(type!=="focus"&&type!=="blur"||event.target.offsetWidth!==0)&&!jQuery.isWindow(elem)){old=elem[ontype];if(old)elem[ontype]=null;jQuery.event.triggered=
type;elem[type]();jQuery.event.triggered=undefined;if(old)elem[ontype]=old}return event.result},dispatch:function(event){event=jQuery.event.fix(event||window.event);var handlers=(jQuery._data(this,"events")||{})[event.type]||[],delegateCount=handlers.delegateCount,args=[].slice.call(arguments,0),run_all=!event.exclusive&&!event.namespace,handlerQueue=[],i,j,cur,jqcur,ret,selMatch,matched,matches,handleObj,sel,related;args[0]=event;event.delegateTarget=this;if(delegateCount&&!event.target.disabled&&
!(event.button&&event.type==="click")){jqcur=jQuery(this);jqcur.context=this.ownerDocument||this;for(cur=event.target;cur!=this;cur=cur.parentNode||this){selMatch={};matches=[];jqcur[0]=cur;for(i=0;i<delegateCount;i++){handleObj=handlers[i];sel=handleObj.selector;if(selMatch[sel]===undefined)selMatch[sel]=handleObj.quick?quickIs(cur,handleObj.quick):jqcur.is(sel);if(selMatch[sel])matches.push(handleObj)}if(matches.length)handlerQueue.push({elem:cur,matches:matches})}}if(handlers.length>delegateCount)handlerQueue.push({elem:this,
matches:handlers.slice(delegateCount)});for(i=0;i<handlerQueue.length&&!event.isPropagationStopped();i++){matched=handlerQueue[i];event.currentTarget=matched.elem;for(j=0;j<matched.matches.length&&!event.isImmediatePropagationStopped();j++){handleObj=matched.matches[j];if(run_all||!event.namespace&&!handleObj.namespace||event.namespace_re&&event.namespace_re.test(handleObj.namespace)){event.data=handleObj.data;event.handleObj=handleObj;ret=((jQuery.event.special[handleObj.origType]||{}).handle||handleObj.handler).apply(matched.elem,
args);if(ret!==undefined){event.result=ret;if(ret===false){event.preventDefault();event.stopPropagation()}}}}}return event.result},props:"attrChange attrName relatedNode srcElement altKey bubbles cancelable ctrlKey currentTarget eventPhase metaKey relatedTarget shiftKey target timeStamp view which".split(" "),fixHooks:{},keyHooks:{props:"char charCode key keyCode".split(" "),filter:function(event,original){if(event.which==null)event.which=original.charCode!=null?original.charCode:original.keyCode;
return event}},mouseHooks:{props:"button buttons clientX clientY fromElement offsetX offsetY pageX pageY screenX screenY toElement".split(" "),filter:function(event,original){var eventDoc,doc,body,button=original.button,fromElement=original.fromElement;if(event.pageX==null&&original.clientX!=null){eventDoc=event.target.ownerDocument||document;doc=eventDoc.documentElement;body=eventDoc.body;event.pageX=original.clientX+(doc&&doc.scrollLeft||body&&body.scrollLeft||0)-(doc&&doc.clientLeft||body&&body.clientLeft||
0);event.pageY=original.clientY+(doc&&doc.scrollTop||body&&body.scrollTop||0)-(doc&&doc.clientTop||body&&body.clientTop||0)}if(!event.relatedTarget&&fromElement)event.relatedTarget=fromElement===event.target?original.toElement:fromElement;if(!event.which&&button!==undefined)event.which=button&1?1:button&2?3:button&4?2:0;return event}},fix:function(event){if(event[jQuery.expando])return event;var i,prop,originalEvent=event,fixHook=jQuery.event.fixHooks[event.type]||{},copy=fixHook.props?this.props.concat(fixHook.props):
this.props;event=jQuery.Event(originalEvent);for(i=copy.length;i;){prop=copy[--i];event[prop]=originalEvent[prop]}if(!event.target)event.target=originalEvent.srcElement||document;if(event.target.nodeType===3)event.target=event.target.parentNode;if(event.metaKey===undefined)event.metaKey=event.ctrlKey;return fixHook.filter?fixHook.filter(event,originalEvent):event},special:{ready:{setup:jQuery.bindReady},load:{noBubble:true},focus:{delegateType:"focusin"},blur:{delegateType:"focusout"},beforeunload:{setup:function(data,
namespaces,eventHandle){if(jQuery.isWindow(this))this.onbeforeunload=eventHandle},teardown:function(namespaces,eventHandle){if(this.onbeforeunload===eventHandle)this.onbeforeunload=null}}},simulate:function(type,elem,event,bubble){var e=jQuery.extend(new jQuery.Event,event,{type:type,isSimulated:true,originalEvent:{}});if(bubble)jQuery.event.trigger(e,null,elem);else jQuery.event.dispatch.call(elem,e);if(e.isDefaultPrevented())event.preventDefault()}};jQuery.event.handle=jQuery.event.dispatch;jQuery.removeEvent=
document.removeEventListener?function(elem,type,handle){if(elem.removeEventListener)elem.removeEventListener(type,handle,false)}:function(elem,type,handle){if(elem.detachEvent)elem.detachEvent("on"+type,handle)};jQuery.Event=function(src,props){if(!(this instanceof jQuery.Event))return new jQuery.Event(src,props);if(src&&src.type){this.originalEvent=src;this.type=src.type;this.isDefaultPrevented=src.defaultPrevented||src.returnValue===false||src.getPreventDefault&&src.getPreventDefault()?returnTrue:
returnFalse}else this.type=src;if(props)jQuery.extend(this,props);this.timeStamp=src&&src.timeStamp||jQuery.now();this[jQuery.expando]=true};function returnFalse(){return false}function returnTrue(){return true}jQuery.Event.prototype={preventDefault:function(){this.isDefaultPrevented=returnTrue;var e=this.originalEvent;if(!e)return;if(e.preventDefault)e.preventDefault();else e.returnValue=false},stopPropagation:function(){this.isPropagationStopped=returnTrue;var e=this.originalEvent;if(!e)return;
if(e.stopPropagation)e.stopPropagation();e.cancelBubble=true},stopImmediatePropagation:function(){this.isImmediatePropagationStopped=returnTrue;this.stopPropagation()},isDefaultPrevented:returnFalse,isPropagationStopped:returnFalse,isImmediatePropagationStopped:returnFalse};jQuery.each({mouseenter:"mouseover",mouseleave:"mouseout"},function(orig,fix){jQuery.event.special[orig]={delegateType:fix,bindType:fix,handle:function(event){var target=this,related=event.relatedTarget,handleObj=event.handleObj,
selector=handleObj.selector,ret;if(!related||related!==target&&!jQuery.contains(target,related)){event.type=handleObj.origType;ret=handleObj.handler.apply(this,arguments);event.type=fix}return ret}}});if(!jQuery.support.submitBubbles)jQuery.event.special.submit={setup:function(){if(jQuery.nodeName(this,"form"))return false;jQuery.event.add(this,"click._submit keypress._submit",function(e){var elem=e.target,form=jQuery.nodeName(elem,"input")||jQuery.nodeName(elem,"button")?elem.form:undefined;if(form&&
!form._submit_attached){jQuery.event.add(form,"submit._submit",function(event){if(this.parentNode&&!event.isTrigger)jQuery.event.simulate("submit",this.parentNode,event,true)});form._submit_attached=true}})},teardown:function(){if(jQuery.nodeName(this,"form"))return false;jQuery.event.remove(this,"._submit")}};if(!jQuery.support.changeBubbles)jQuery.event.special.change={setup:function(){if(rformElems.test(this.nodeName)){if(this.type==="checkbox"||this.type==="radio"){jQuery.event.add(this,"propertychange._change",
function(event){if(event.originalEvent.propertyName==="checked")this._just_changed=true});jQuery.event.add(this,"click._change",function(event){if(this._just_changed&&!event.isTrigger){this._just_changed=false;jQuery.event.simulate("change",this,event,true)}})}return false}jQuery.event.add(this,"beforeactivate._change",function(e){var elem=e.target;if(rformElems.test(elem.nodeName)&&!elem._change_attached){jQuery.event.add(elem,"change._change",function(event){if(this.parentNode&&!event.isSimulated&&
!event.isTrigger)jQuery.event.simulate("change",this.parentNode,event,true)});elem._change_attached=true}})},handle:function(event){var elem=event.target;if(this!==elem||event.isSimulated||event.isTrigger||elem.type!=="radio"&&elem.type!=="checkbox")return event.handleObj.handler.apply(this,arguments)},teardown:function(){jQuery.event.remove(this,"._change");return rformElems.test(this.nodeName)}};if(!jQuery.support.focusinBubbles)jQuery.each({focus:"focusin",blur:"focusout"},function(orig,fix){var attaches=
0,handler=function(event){jQuery.event.simulate(fix,event.target,jQuery.event.fix(event),true)};jQuery.event.special[fix]={setup:function(){if(attaches++===0)document.addEventListener(orig,handler,true)},teardown:function(){if(--attaches===0)document.removeEventListener(orig,handler,true)}}});jQuery.fn.extend({on:function(types,selector,data,fn,one){var origFn,type;if(typeof types==="object"){if(typeof selector!=="string"){data=selector;selector=undefined}for(type in types)this.on(type,selector,data,
types[type],one);return this}if(data==null&&fn==null){fn=selector;data=selector=undefined}else if(fn==null)if(typeof selector==="string"){fn=data;data=undefined}else{fn=data;data=selector;selector=undefined}if(fn===false)fn=returnFalse;else if(!fn)return this;if(one===1){origFn=fn;fn=function(event){jQuery().off(event);return origFn.apply(this,arguments)};fn.guid=origFn.guid||(origFn.guid=jQuery.guid++)}return this.each(function(){jQuery.event.add(this,types,fn,data,selector)})},one:function(types,
selector,data,fn){return this.on.call(this,types,selector,data,fn,1)},off:function(types,selector,fn){if(types&&types.preventDefault&&types.handleObj){var handleObj=types.handleObj;jQuery(types.delegateTarget).off(handleObj.namespace?handleObj.type+"."+handleObj.namespace:handleObj.type,handleObj.selector,handleObj.handler);return this}if(typeof types==="object"){for(var type in types)this.off(type,selector,types[type]);return this}if(selector===false||typeof selector==="function"){fn=selector;selector=
undefined}if(fn===false)fn=returnFalse;return this.each(function(){jQuery.event.remove(this,types,fn,selector)})},bind:function(types,data,fn){return this.on(types,null,data,fn)},unbind:function(types,fn){return this.off(types,null,fn)},live:function(types,data,fn){jQuery(this.context).on(types,this.selector,data,fn);return this},die:function(types,fn){jQuery(this.context).off(types,this.selector||"**",fn);return this},delegate:function(selector,types,data,fn){return this.on(types,selector,data,fn)},
undelegate:function(selector,types,fn){return arguments.length==1?this.off(selector,"**"):this.off(types,selector,fn)},trigger:function(type,data){return this.each(function(){jQuery.event.trigger(type,data,this)})},triggerHandler:function(type,data){if(this[0])return jQuery.event.trigger(type,data,this[0],true)},toggle:function(fn){var args=arguments,guid=fn.guid||jQuery.guid++,i=0,toggler=function(event){var lastToggle=(jQuery._data(this,"lastToggle"+fn.guid)||0)%i;jQuery._data(this,"lastToggle"+
fn.guid,lastToggle+1);event.preventDefault();return args[lastToggle].apply(this,arguments)||false};toggler.guid=guid;while(i<args.length)args[i++].guid=guid;return this.click(toggler)},hover:function(fnOver,fnOut){return this.mouseenter(fnOver).mouseleave(fnOut||fnOver)}});jQuery.each(("blur focus focusin focusout load resize scroll unload click dblclick "+"mousedown mouseup mousemove mouseover mouseout mouseenter mouseleave "+"change select submit keydown keypress keyup error contextmenu").split(" "),
function(i,name){jQuery.fn[name]=function(data,fn){if(fn==null){fn=data;data=null}return arguments.length>0?this.on(name,null,data,fn):this.trigger(name)};if(jQuery.attrFn)jQuery.attrFn[name]=true;if(rkeyEvent.test(name))jQuery.event.fixHooks[name]=jQuery.event.keyHooks;if(rmouseEvent.test(name))jQuery.event.fixHooks[name]=jQuery.event.mouseHooks});(function(){var chunker=/((?:\((?:\([^()]+\)|[^()]+)+\)|\[(?:\[[^\[\]]*\]|['"][^'"]*['"]|[^\[\]'"]+)+\]|\\.|[^ >+~,(\[\\]+)+|[>+~])(\s*,\s*)?((?:.|\r|\n)*)/g,
expando="sizcache"+(Math.random()+"").replace(".",""),done=0,toString=Object.prototype.toString,hasDuplicate=false,baseHasDuplicate=true,rBackslash=/\\/g,rReturn=/\r\n/g,rNonWord=/\W/;[0,0].sort(function(){baseHasDuplicate=false;return 0});var Sizzle=function(selector,context,results,seed){results=results||[];context=context||document;var origContext=context;if(context.nodeType!==1&&context.nodeType!==9)return[];if(!selector||typeof selector!=="string")return results;var m,set,checkSet,extra,ret,
cur,pop,i,prune=true,contextXML=Sizzle.isXML(context),parts=[],soFar=selector;do{chunker.exec("");m=chunker.exec(soFar);if(m){soFar=m[3];parts.push(m[1]);if(m[2]){extra=m[3];break}}}while(m);if(parts.length>1&&origPOS.exec(selector))if(parts.length===2&&Expr.relative[parts[0]])set=posProcess(parts[0]+parts[1],context,seed);else{set=Expr.relative[parts[0]]?[context]:Sizzle(parts.shift(),context);while(parts.length){selector=parts.shift();if(Expr.relative[selector])selector+=parts.shift();set=posProcess(selector,
set,seed)}}else{if(!seed&&parts.length>1&&context.nodeType===9&&!contextXML&&Expr.match.ID.test(parts[0])&&!Expr.match.ID.test(parts[parts.length-1])){ret=Sizzle.find(parts.shift(),context,contextXML);context=ret.expr?Sizzle.filter(ret.expr,ret.set)[0]:ret.set[0]}if(context){ret=seed?{expr:parts.pop(),set:makeArray(seed)}:Sizzle.find(parts.pop(),parts.length===1&&(parts[0]==="~"||parts[0]==="+")&&context.parentNode?context.parentNode:context,contextXML);set=ret.expr?Sizzle.filter(ret.expr,ret.set):
ret.set;if(parts.length>0)checkSet=makeArray(set);else prune=false;while(parts.length){cur=parts.pop();pop=cur;if(!Expr.relative[cur])cur="";else pop=parts.pop();if(pop==null)pop=context;Expr.relative[cur](checkSet,pop,contextXML)}}else checkSet=parts=[]}if(!checkSet)checkSet=set;if(!checkSet)Sizzle.error(cur||selector);if(toString.call(checkSet)==="[object Array]")if(!prune)results.push.apply(results,checkSet);else if(context&&context.nodeType===1)for(i=0;checkSet[i]!=null;i++){if(checkSet[i]&&(checkSet[i]===
true||checkSet[i].nodeType===1&&Sizzle.contains(context,checkSet[i])))results.push(set[i])}else for(i=0;checkSet[i]!=null;i++){if(checkSet[i]&&checkSet[i].nodeType===1)results.push(set[i])}else makeArray(checkSet,results);if(extra){Sizzle(extra,origContext,results,seed);Sizzle.uniqueSort(results)}return results};Sizzle.uniqueSort=function(results){if(sortOrder){hasDuplicate=baseHasDuplicate;results.sort(sortOrder);if(hasDuplicate)for(var i=1;i<results.length;i++)if(results[i]===results[i-1])results.splice(i--,
1)}return results};Sizzle.matches=function(expr,set){return Sizzle(expr,null,null,set)};Sizzle.matchesSelector=function(node,expr){return Sizzle(expr,null,null,[node]).length>0};Sizzle.find=function(expr,context,isXML){var set,i,len,match,type,left;if(!expr)return[];for(i=0,len=Expr.order.length;i<len;i++){type=Expr.order[i];if(match=Expr.leftMatch[type].exec(expr)){left=match[1];match.splice(1,1);if(left.substr(left.length-1)!=="\\"){match[1]=(match[1]||"").replace(rBackslash,"");set=Expr.find[type](match,
context,isXML);if(set!=null){expr=expr.replace(Expr.match[type],"");break}}}}if(!set)set=typeof context.getElementsByTagName!=="undefined"?context.getElementsByTagName("*"):[];return{set:set,expr:expr}};Sizzle.filter=function(expr,set,inplace,not){var match,anyFound,type,found,item,filter,left,i,pass,old=expr,result=[],curLoop=set,isXMLFilter=set&&set[0]&&Sizzle.isXML(set[0]);while(expr&&set.length){for(type in Expr.filter)if((match=Expr.leftMatch[type].exec(expr))!=null&&match[2]){filter=Expr.filter[type];
left=match[1];anyFound=false;match.splice(1,1);if(left.substr(left.length-1)==="\\")continue;if(curLoop===result)result=[];if(Expr.preFilter[type]){match=Expr.preFilter[type](match,curLoop,inplace,result,not,isXMLFilter);if(!match)anyFound=found=true;else if(match===true)continue}if(match)for(i=0;(item=curLoop[i])!=null;i++)if(item){found=filter(item,match,i,curLoop);pass=not^found;if(inplace&&found!=null)if(pass)anyFound=true;else curLoop[i]=false;else if(pass){result.push(item);anyFound=true}}if(found!==
undefined){if(!inplace)curLoop=result;expr=expr.replace(Expr.match[type],"");if(!anyFound)return[];break}}if(expr===old)if(anyFound==null)Sizzle.error(expr);else break;old=expr}return curLoop};Sizzle.error=function(msg){throw new Error("Syntax error, unrecognized expression: "+msg);};var getText=Sizzle.getText=function(elem){var i,node,nodeType=elem.nodeType,ret="";if(nodeType)if(nodeType===1||nodeType===9)if(typeof elem.textContent==="string")return elem.textContent;else if(typeof elem.innerText===
"string")return elem.innerText.replace(rReturn,"");else for(elem=elem.firstChild;elem;elem=elem.nextSibling)ret+=getText(elem);else{if(nodeType===3||nodeType===4)return elem.nodeValue}else for(i=0;node=elem[i];i++)if(node.nodeType!==8)ret+=getText(node);return ret};var Expr=Sizzle.selectors={order:["ID","NAME","TAG"],match:{ID:/#((?:[\w\u00c0-\uFFFF\-]|\\.)+)/,CLASS:/\.((?:[\w\u00c0-\uFFFF\-]|\\.)+)/,NAME:/\[name=['"]*((?:[\w\u00c0-\uFFFF\-]|\\.)+)['"]*\]/,ATTR:/\[\s*((?:[\w\u00c0-\uFFFF\-]|\\.)+)\s*(?:(\S?=)\s*(?:(['"])(.*?)\3|(#?(?:[\w\u00c0-\uFFFF\-]|\\.)*)|)|)\s*\]/,
TAG:/^((?:[\w\u00c0-\uFFFF\*\-]|\\.)+)/,CHILD:/:(only|nth|last|first)-child(?:\(\s*(even|odd|(?:[+\-]?\d+|(?:[+\-]?\d*)?n\s*(?:[+\-]\s*\d+)?))\s*\))?/,POS:/:(nth|eq|gt|lt|first|last|even|odd)(?:\((\d*)\))?(?=[^\-]|$)/,PSEUDO:/:((?:[\w\u00c0-\uFFFF\-]|\\.)+)(?:\((['"]?)((?:\([^\)]+\)|[^\(\)]*)+)\2\))?/},leftMatch:{},attrMap:{"class":"className","for":"htmlFor"},attrHandle:{href:function(elem){return elem.getAttribute("href")},type:function(elem){return elem.getAttribute("type")}},relative:{"+":function(checkSet,
part){var isPartStr=typeof part==="string",isTag=isPartStr&&!rNonWord.test(part),isPartStrNotTag=isPartStr&&!isTag;if(isTag)part=part.toLowerCase();for(var i=0,l=checkSet.length,elem;i<l;i++)if(elem=checkSet[i]){while((elem=elem.previousSibling)&&elem.nodeType!==1);checkSet[i]=isPartStrNotTag||elem&&elem.nodeName.toLowerCase()===part?elem||false:elem===part}if(isPartStrNotTag)Sizzle.filter(part,checkSet,true)},">":function(checkSet,part){var elem,isPartStr=typeof part==="string",i=0,l=checkSet.length;
if(isPartStr&&!rNonWord.test(part)){part=part.toLowerCase();for(;i<l;i++){elem=checkSet[i];if(elem){var parent=elem.parentNode;checkSet[i]=parent.nodeName.toLowerCase()===part?parent:false}}}else{for(;i<l;i++){elem=checkSet[i];if(elem)checkSet[i]=isPartStr?elem.parentNode:elem.parentNode===part}if(isPartStr)Sizzle.filter(part,checkSet,true)}},"":function(checkSet,part,isXML){var nodeCheck,doneName=done++,checkFn=dirCheck;if(typeof part==="string"&&!rNonWord.test(part)){part=part.toLowerCase();nodeCheck=
part;checkFn=dirNodeCheck}checkFn("parentNode",part,doneName,checkSet,nodeCheck,isXML)},"~":function(checkSet,part,isXML){var nodeCheck,doneName=done++,checkFn=dirCheck;if(typeof part==="string"&&!rNonWord.test(part)){part=part.toLowerCase();nodeCheck=part;checkFn=dirNodeCheck}checkFn("previousSibling",part,doneName,checkSet,nodeCheck,isXML)}},find:{ID:function(match,context,isXML){if(typeof context.getElementById!=="undefined"&&!isXML){var m=context.getElementById(match[1]);return m&&m.parentNode?
[m]:[]}},NAME:function(match,context){if(typeof context.getElementsByName!=="undefined"){var ret=[],results=context.getElementsByName(match[1]);for(var i=0,l=results.length;i<l;i++)if(results[i].getAttribute("name")===match[1])ret.push(results[i]);return ret.length===0?null:ret}},TAG:function(match,context){if(typeof context.getElementsByTagName!=="undefined")return context.getElementsByTagName(match[1])}},preFilter:{CLASS:function(match,curLoop,inplace,result,not,isXML){match=" "+match[1].replace(rBackslash,
"")+" ";if(isXML)return match;for(var i=0,elem;(elem=curLoop[i])!=null;i++)if(elem)if(not^(elem.className&&(" "+elem.className+" ").replace(/[\t\n\r]/g," ").indexOf(match)>=0)){if(!inplace)result.push(elem)}else if(inplace)curLoop[i]=false;return false},ID:function(match){return match[1].replace(rBackslash,"")},TAG:function(match,curLoop){return match[1].replace(rBackslash,"").toLowerCase()},CHILD:function(match){if(match[1]==="nth"){if(!match[2])Sizzle.error(match[0]);match[2]=match[2].replace(/^\+|\s*/g,
"");var test=/(-?)(\d*)(?:n([+\-]?\d*))?/.exec(match[2]==="even"&&"2n"||match[2]==="odd"&&"2n+1"||!/\D/.test(match[2])&&"0n+"+match[2]||match[2]);match[2]=test[1]+(test[2]||1)-0;match[3]=test[3]-0}else if(match[2])Sizzle.error(match[0]);match[0]=done++;return match},ATTR:function(match,curLoop,inplace,result,not,isXML){var name=match[1]=match[1].replace(rBackslash,"");if(!isXML&&Expr.attrMap[name])match[1]=Expr.attrMap[name];match[4]=(match[4]||match[5]||"").replace(rBackslash,"");if(match[2]==="~=")match[4]=
" "+match[4]+" ";return match},PSEUDO:function(match,curLoop,inplace,result,not){if(match[1]==="not")if((chunker.exec(match[3])||"").length>1||/^\w/.test(match[3]))match[3]=Sizzle(match[3],null,null,curLoop);else{var ret=Sizzle.filter(match[3],curLoop,inplace,true^not);if(!inplace)result.push.apply(result,ret);return false}else if(Expr.match.POS.test(match[0])||Expr.match.CHILD.test(match[0]))return true;return match},POS:function(match){match.unshift(true);return match}},filters:{enabled:function(elem){return elem.disabled===
false&&elem.type!=="hidden"},disabled:function(elem){return elem.disabled===true},checked:function(elem){return elem.checked===true},selected:function(elem){if(elem.parentNode)elem.parentNode.selectedIndex;return elem.selected===true},parent:function(elem){return!!elem.firstChild},empty:function(elem){return!elem.firstChild},has:function(elem,i,match){return!!Sizzle(match[3],elem).length},header:function(elem){return/h\d/i.test(elem.nodeName)},text:function(elem){var attr=elem.getAttribute("type"),
type=elem.type;return elem.nodeName.toLowerCase()==="input"&&"text"===type&&(attr===type||attr===null)},radio:function(elem){return elem.nodeName.toLowerCase()==="input"&&"radio"===elem.type},checkbox:function(elem){return elem.nodeName.toLowerCase()==="input"&&"checkbox"===elem.type},file:function(elem){return elem.nodeName.toLowerCase()==="input"&&"file"===elem.type},password:function(elem){return elem.nodeName.toLowerCase()==="input"&&"password"===elem.type},submit:function(elem){var name=elem.nodeName.toLowerCase();
return(name==="input"||name==="button")&&"submit"===elem.type},image:function(elem){return elem.nodeName.toLowerCase()==="input"&&"image"===elem.type},reset:function(elem){var name=elem.nodeName.toLowerCase();return(name==="input"||name==="button")&&"reset"===elem.type},button:function(elem){var name=elem.nodeName.toLowerCase();return name==="input"&&"button"===elem.type||name==="button"},input:function(elem){return/input|select|textarea|button/i.test(elem.nodeName)},focus:function(elem){return elem===
elem.ownerDocument.activeElement}},setFilters:{first:function(elem,i){return i===0},last:function(elem,i,match,array){return i===array.length-1},even:function(elem,i){return i%2===0},odd:function(elem,i){return i%2===1},lt:function(elem,i,match){return i<match[3]-0},gt:function(elem,i,match){return i>match[3]-0},nth:function(elem,i,match){return match[3]-0===i},eq:function(elem,i,match){return match[3]-0===i}},filter:{PSEUDO:function(elem,match,i,array){var name=match[1],filter=Expr.filters[name];
if(filter)return filter(elem,i,match,array);else if(name==="contains")return(elem.textContent||elem.innerText||getText([elem])||"").indexOf(match[3])>=0;else if(name==="not"){var not=match[3];for(var j=0,l=not.length;j<l;j++)if(not[j]===elem)return false;return true}else Sizzle.error(name)},CHILD:function(elem,match){var first,last,doneName,parent,cache,count,diff,type=match[1],node=elem;switch(type){case "only":case "first":while(node=node.previousSibling)if(node.nodeType===1)return false;if(type===
"first")return true;node=elem;case "last":while(node=node.nextSibling)if(node.nodeType===1)return false;return true;case "nth":first=match[2];last=match[3];if(first===1&&last===0)return true;doneName=match[0];parent=elem.parentNode;if(parent&&(parent[expando]!==doneName||!elem.nodeIndex)){count=0;for(node=parent.firstChild;node;node=node.nextSibling)if(node.nodeType===1)node.nodeIndex=++count;parent[expando]=doneName}diff=elem.nodeIndex-last;if(first===0)return diff===0;else return diff%first===0&&
diff/first>=0}},ID:function(elem,match){return elem.nodeType===1&&elem.getAttribute("id")===match},TAG:function(elem,match){return match==="*"&&elem.nodeType===1||!!elem.nodeName&&elem.nodeName.toLowerCase()===match},CLASS:function(elem,match){return(" "+(elem.className||elem.getAttribute("class"))+" ").indexOf(match)>-1},ATTR:function(elem,match){var name=match[1],result=Sizzle.attr?Sizzle.attr(elem,name):Expr.attrHandle[name]?Expr.attrHandle[name](elem):elem[name]!=null?elem[name]:elem.getAttribute(name),
value=result+"",type=match[2],check=match[4];return result==null?type==="!=":!type&&Sizzle.attr?result!=null:type==="="?value===check:type==="*="?value.indexOf(check)>=0:type==="~="?(" "+value+" ").indexOf(check)>=0:!check?value&&result!==false:type==="!="?value!==check:type==="^="?value.indexOf(check)===0:type==="$="?value.substr(value.length-check.length)===check:type==="|="?value===check||value.substr(0,check.length+1)===check+"-":false},POS:function(elem,match,i,array){var name=match[2],filter=
Expr.setFilters[name];if(filter)return filter(elem,i,match,array)}}};var origPOS=Expr.match.POS,fescape=function(all,num){return"\\"+(num-0+1)};for(var type in Expr.match){Expr.match[type]=new RegExp(Expr.match[type].source+/(?![^\[]*\])(?![^\(]*\))/.source);Expr.leftMatch[type]=new RegExp(/(^(?:.|\r|\n)*?)/.source+Expr.match[type].source.replace(/\\(\d+)/g,fescape))}var makeArray=function(array,results){array=Array.prototype.slice.call(array,0);if(results){results.push.apply(results,array);return results}return array};
try{Array.prototype.slice.call(document.documentElement.childNodes,0)[0].nodeType}catch(e){makeArray=function(array,results){var i=0,ret=results||[];if(toString.call(array)==="[object Array]")Array.prototype.push.apply(ret,array);else if(typeof array.length==="number")for(var l=array.length;i<l;i++)ret.push(array[i]);else for(;array[i];i++)ret.push(array[i]);return ret}}var sortOrder,siblingCheck;if(document.documentElement.compareDocumentPosition)sortOrder=function(a,b){if(a===b){hasDuplicate=true;
return 0}if(!a.compareDocumentPosition||!b.compareDocumentPosition)return a.compareDocumentPosition?-1:1;return a.compareDocumentPosition(b)&4?-1:1};else{sortOrder=function(a,b){if(a===b){hasDuplicate=true;return 0}else if(a.sourceIndex&&b.sourceIndex)return a.sourceIndex-b.sourceIndex;var al,bl,ap=[],bp=[],aup=a.parentNode,bup=b.parentNode,cur=aup;if(aup===bup)return siblingCheck(a,b);else if(!aup)return-1;else if(!bup)return 1;while(cur){ap.unshift(cur);cur=cur.parentNode}cur=bup;while(cur){bp.unshift(cur);
cur=cur.parentNode}al=ap.length;bl=bp.length;for(var i=0;i<al&&i<bl;i++)if(ap[i]!==bp[i])return siblingCheck(ap[i],bp[i]);return i===al?siblingCheck(a,bp[i],-1):siblingCheck(ap[i],b,1)};siblingCheck=function(a,b,ret){if(a===b)return ret;var cur=a.nextSibling;while(cur){if(cur===b)return-1;cur=cur.nextSibling}return 1}}(function(){var form=document.createElement("div"),id="script"+(new Date).getTime(),root=document.documentElement;form.innerHTML="<a name='"+id+"'/>";root.insertBefore(form,root.firstChild);
if(document.getElementById(id)){Expr.find.ID=function(match,context,isXML){if(typeof context.getElementById!=="undefined"&&!isXML){var m=context.getElementById(match[1]);return m?m.id===match[1]||typeof m.getAttributeNode!=="undefined"&&m.getAttributeNode("id").nodeValue===match[1]?[m]:undefined:[]}};Expr.filter.ID=function(elem,match){var node=typeof elem.getAttributeNode!=="undefined"&&elem.getAttributeNode("id");return elem.nodeType===1&&node&&node.nodeValue===match}}root.removeChild(form);root=
form=null})();(function(){var div=document.createElement("div");div.appendChild(document.createComment(""));if(div.getElementsByTagName("*").length>0)Expr.find.TAG=function(match,context){var results=context.getElementsByTagName(match[1]);if(match[1]==="*"){var tmp=[];for(var i=0;results[i];i++)if(results[i].nodeType===1)tmp.push(results[i]);results=tmp}return results};div.innerHTML="<a href='#'></a>";if(div.firstChild&&typeof div.firstChild.getAttribute!=="undefined"&&div.firstChild.getAttribute("href")!==
"#")Expr.attrHandle.href=function(elem){return elem.getAttribute("href",2)};div=null})();if(document.querySelectorAll)(function(){var oldSizzle=Sizzle,div=document.createElement("div"),id="__sizzle__";div.innerHTML="<p class='TEST'></p>";if(div.querySelectorAll&&div.querySelectorAll(".TEST").length===0)return;Sizzle=function(query,context,extra,seed){context=context||document;if(!seed&&!Sizzle.isXML(context)){var match=/^(\w+$)|^\.([\w\-]+$)|^#([\w\-]+$)/.exec(query);if(match&&(context.nodeType===
1||context.nodeType===9))if(match[1])return makeArray(context.getElementsByTagName(query),extra);else if(match[2]&&Expr.find.CLASS&&context.getElementsByClassName)return makeArray(context.getElementsByClassName(match[2]),extra);if(context.nodeType===9){if(query==="body"&&context.body)return makeArray([context.body],extra);else if(match&&match[3]){var elem=context.getElementById(match[3]);if(elem&&elem.parentNode){if(elem.id===match[3])return makeArray([elem],extra)}else return makeArray([],extra)}try{return makeArray(context.querySelectorAll(query),
extra)}catch(qsaError){}}else if(context.nodeType===1&&context.nodeName.toLowerCase()!=="object"){var oldContext=context,old=context.getAttribute("id"),nid=old||id,hasParent=context.parentNode,relativeHierarchySelector=/^\s*[+~]/.test(query);if(!old)context.setAttribute("id",nid);else nid=nid.replace(/'/g,"\\$&");if(relativeHierarchySelector&&hasParent)context=context.parentNode;try{if(!relativeHierarchySelector||hasParent)return makeArray(context.querySelectorAll("[id='"+nid+"'] "+query),extra)}catch(pseudoError){}finally{if(!old)oldContext.removeAttribute("id")}}}return oldSizzle(query,
context,extra,seed)};for(var prop in oldSizzle)Sizzle[prop]=oldSizzle[prop];div=null})();(function(){var html=document.documentElement,matches=html.matchesSelector||html.mozMatchesSelector||html.webkitMatchesSelector||html.msMatchesSelector;if(matches){var disconnectedMatch=!matches.call(document.createElement("div"),"div"),pseudoWorks=false;try{matches.call(document.documentElement,"[test!='']:sizzle")}catch(pseudoError){pseudoWorks=true}Sizzle.matchesSelector=function(node,expr){expr=expr.replace(/\=\s*([^'"\]]*)\s*\]/g,
"='$1']");if(!Sizzle.isXML(node))try{if(pseudoWorks||!Expr.match.PSEUDO.test(expr)&&!/!=/.test(expr)){var ret=matches.call(node,expr);if(ret||!disconnectedMatch||node.document&&node.document.nodeType!==11)return ret}}catch(e){}return Sizzle(expr,null,null,[node]).length>0}}})();(function(){var div=document.createElement("div");div.innerHTML="<div class='test e'></div><div class='test'></div>";if(!div.getElementsByClassName||div.getElementsByClassName("e").length===0)return;div.lastChild.className=
"e";if(div.getElementsByClassName("e").length===1)return;Expr.order.splice(1,0,"CLASS");Expr.find.CLASS=function(match,context,isXML){if(typeof context.getElementsByClassName!=="undefined"&&!isXML)return context.getElementsByClassName(match[1])};div=null})();function dirNodeCheck(dir,cur,doneName,checkSet,nodeCheck,isXML){for(var i=0,l=checkSet.length;i<l;i++){var elem=checkSet[i];if(elem){var match=false;elem=elem[dir];while(elem){if(elem[expando]===doneName){match=checkSet[elem.sizset];break}if(elem.nodeType===
1&&!isXML){elem[expando]=doneName;elem.sizset=i}if(elem.nodeName.toLowerCase()===cur){match=elem;break}elem=elem[dir]}checkSet[i]=match}}}function dirCheck(dir,cur,doneName,checkSet,nodeCheck,isXML){for(var i=0,l=checkSet.length;i<l;i++){var elem=checkSet[i];if(elem){var match=false;elem=elem[dir];while(elem){if(elem[expando]===doneName){match=checkSet[elem.sizset];break}if(elem.nodeType===1){if(!isXML){elem[expando]=doneName;elem.sizset=i}if(typeof cur!=="string"){if(elem===cur){match=true;break}}else if(Sizzle.filter(cur,
[elem]).length>0){match=elem;break}}elem=elem[dir]}checkSet[i]=match}}}if(document.documentElement.contains)Sizzle.contains=function(a,b){return a!==b&&(a.contains?a.contains(b):true)};else if(document.documentElement.compareDocumentPosition)Sizzle.contains=function(a,b){return!!(a.compareDocumentPosition(b)&16)};else Sizzle.contains=function(){return false};Sizzle.isXML=function(elem){var documentElement=(elem?elem.ownerDocument||elem:0).documentElement;return documentElement?documentElement.nodeName!==
"HTML":false};var posProcess=function(selector,context,seed){var match,tmpSet=[],later="",root=context.nodeType?[context]:context;while(match=Expr.match.PSEUDO.exec(selector)){later+=match[0];selector=selector.replace(Expr.match.PSEUDO,"")}selector=Expr.relative[selector]?selector+"*":selector;for(var i=0,l=root.length;i<l;i++)Sizzle(selector,root[i],tmpSet,seed);return Sizzle.filter(later,tmpSet)};Sizzle.attr=jQuery.attr;Sizzle.selectors.attrMap={};jQuery.find=Sizzle;jQuery.expr=Sizzle.selectors;
jQuery.expr[":"]=jQuery.expr.filters;jQuery.unique=Sizzle.uniqueSort;jQuery.text=Sizzle.getText;jQuery.isXMLDoc=Sizzle.isXML;jQuery.contains=Sizzle.contains})();var runtil=/Until$/,rparentsprev=/^(?:parents|prevUntil|prevAll)/,rmultiselector=/,/,isSimple=/^.[^:#\[\.,]*$/,slice=Array.prototype.slice,POS=jQuery.expr.match.POS,guaranteedUnique={children:true,contents:true,next:true,prev:true};jQuery.fn.extend({find:function(selector){var self=this,i,l;if(typeof selector!=="string")return jQuery(selector).filter(function(){for(i=
0,l=self.length;i<l;i++)if(jQuery.contains(self[i],this))return true});var ret=this.pushStack("","find",selector),length,n,r;for(i=0,l=this.length;i<l;i++){length=ret.length;jQuery.find(selector,this[i],ret);if(i>0)for(n=length;n<ret.length;n++)for(r=0;r<length;r++)if(ret[r]===ret[n]){ret.splice(n--,1);break}}return ret},has:function(target){var targets=jQuery(target);return this.filter(function(){for(var i=0,l=targets.length;i<l;i++)if(jQuery.contains(this,targets[i]))return true})},not:function(selector){return this.pushStack(winnow(this,
selector,false),"not",selector)},filter:function(selector){return this.pushStack(winnow(this,selector,true),"filter",selector)},is:function(selector){return!!selector&&(typeof selector==="string"?POS.test(selector)?jQuery(selector,this.context).index(this[0])>=0:jQuery.filter(selector,this).length>0:this.filter(selector).length>0)},closest:function(selectors,context){var ret=[],i,l,cur=this[0];if(jQuery.isArray(selectors)){var level=1;while(cur&&cur.ownerDocument&&cur!==context){for(i=0;i<selectors.length;i++)if(jQuery(cur).is(selectors[i]))ret.push({selector:selectors[i],
elem:cur,level:level});cur=cur.parentNode;level++}return ret}var pos=POS.test(selectors)||typeof selectors!=="string"?jQuery(selectors,context||this.context):0;for(i=0,l=this.length;i<l;i++){cur=this[i];while(cur)if(pos?pos.index(cur)>-1:jQuery.find.matchesSelector(cur,selectors)){ret.push(cur);break}else{cur=cur.parentNode;if(!cur||!cur.ownerDocument||cur===context||cur.nodeType===11)break}}ret=ret.length>1?jQuery.unique(ret):ret;return this.pushStack(ret,"closest",selectors)},index:function(elem){if(!elem)return this[0]&&
this[0].parentNode?this.prevAll().length:-1;if(typeof elem==="string")return jQuery.inArray(this[0],jQuery(elem));return jQuery.inArray(elem.jquery?elem[0]:elem,this)},add:function(selector,context){var set=typeof selector==="string"?jQuery(selector,context):jQuery.makeArray(selector&&selector.nodeType?[selector]:selector),all=jQuery.merge(this.get(),set);return this.pushStack(isDisconnected(set[0])||isDisconnected(all[0])?all:jQuery.unique(all))},andSelf:function(){return this.add(this.prevObject)}});
function isDisconnected(node){return!node||!node.parentNode||node.parentNode.nodeType===11}jQuery.each({parent:function(elem){var parent=elem.parentNode;return parent&&parent.nodeType!==11?parent:null},parents:function(elem){return jQuery.dir(elem,"parentNode")},parentsUntil:function(elem,i,until){return jQuery.dir(elem,"parentNode",until)},next:function(elem){return jQuery.nth(elem,2,"nextSibling")},prev:function(elem){return jQuery.nth(elem,2,"previousSibling")},nextAll:function(elem){return jQuery.dir(elem,
"nextSibling")},prevAll:function(elem){return jQuery.dir(elem,"previousSibling")},nextUntil:function(elem,i,until){return jQuery.dir(elem,"nextSibling",until)},prevUntil:function(elem,i,until){return jQuery.dir(elem,"previousSibling",until)},siblings:function(elem){return jQuery.sibling(elem.parentNode.firstChild,elem)},children:function(elem){return jQuery.sibling(elem.firstChild)},contents:function(elem){return jQuery.nodeName(elem,"iframe")?elem.contentDocument||elem.contentWindow.document:jQuery.makeArray(elem.childNodes)}},
function(name,fn){jQuery.fn[name]=function(until,selector){var ret=jQuery.map(this,fn,until);if(!runtil.test(name))selector=until;if(selector&&typeof selector==="string")ret=jQuery.filter(selector,ret);ret=this.length>1&&!guaranteedUnique[name]?jQuery.unique(ret):ret;if((this.length>1||rmultiselector.test(selector))&&rparentsprev.test(name))ret=ret.reverse();return this.pushStack(ret,name,slice.call(arguments).join(","))}});jQuery.extend({filter:function(expr,elems,not){if(not)expr=":not("+expr+")";
return elems.length===1?jQuery.find.matchesSelector(elems[0],expr)?[elems[0]]:[]:jQuery.find.matches(expr,elems)},dir:function(elem,dir,until){var matched=[],cur=elem[dir];while(cur&&cur.nodeType!==9&&(until===undefined||cur.nodeType!==1||!jQuery(cur).is(until))){if(cur.nodeType===1)matched.push(cur);cur=cur[dir]}return matched},nth:function(cur,result,dir,elem){result=result||1;var num=0;for(;cur;cur=cur[dir])if(cur.nodeType===1&&++num===result)break;return cur},sibling:function(n,elem){var r=[];
for(;n;n=n.nextSibling)if(n.nodeType===1&&n!==elem)r.push(n);return r}});function winnow(elements,qualifier,keep){qualifier=qualifier||0;if(jQuery.isFunction(qualifier))return jQuery.grep(elements,function(elem,i){var retVal=!!qualifier.call(elem,i,elem);return retVal===keep});else if(qualifier.nodeType)return jQuery.grep(elements,function(elem,i){return elem===qualifier===keep});else if(typeof qualifier==="string"){var filtered=jQuery.grep(elements,function(elem){return elem.nodeType===1});if(isSimple.test(qualifier))return jQuery.filter(qualifier,
filtered,!keep);else qualifier=jQuery.filter(qualifier,filtered)}return jQuery.grep(elements,function(elem,i){return jQuery.inArray(elem,qualifier)>=0===keep})}function createSafeFragment(document){var list=nodeNames.split("|"),safeFrag=document.createDocumentFragment();if(safeFrag.createElement)while(list.length)safeFrag.createElement(list.pop());return safeFrag}var nodeNames="abbr|article|aside|audio|canvas|datalist|details|figcaption|figure|footer|"+"header|hgroup|mark|meter|nav|output|progress|section|summary|time|video",
rinlinejQuery=/ jQuery\d+="(?:\d+|null)"/g,rleadingWhitespace=/^\s+/,rxhtmlTag=/<(?!area|br|col|embed|hr|img|input|link|meta|param)(([\w:]+)[^>]*)\/>/ig,rtagName=/<([\w:]+)/,rtbody=/<tbody/i,rhtml=/<|&#?\w+;/,rnoInnerhtml=/<(?:script|style)/i,rnocache=/<(?:script|object|embed|option|style)/i,rnoshimcache=new RegExp("<(?:"+nodeNames+")","i"),rchecked=/checked\s*(?:[^=]|=\s*.checked.)/i,rscriptType=/\/(java|ecma)script/i,rcleanScript=/^\s*<!(?:\[CDATA\[|\-\-)/,wrapMap={option:[1,"<select multiple='multiple'>",
"</select>"],legend:[1,"<fieldset>","</fieldset>"],thead:[1,"<table>","</table>"],tr:[2,"<table><tbody>","</tbody></table>"],td:[3,"<table><tbody><tr>","</tr></tbody></table>"],col:[2,"<table><tbody></tbody><colgroup>","</colgroup></table>"],area:[1,"<map>","</map>"],_default:[0,"",""]},safeFragment=createSafeFragment(document);wrapMap.optgroup=wrapMap.option;wrapMap.tbody=wrapMap.tfoot=wrapMap.colgroup=wrapMap.caption=wrapMap.thead;wrapMap.th=wrapMap.td;if(!jQuery.support.htmlSerialize)wrapMap._default=
[1,"div<div>","</div>"];jQuery.fn.extend({text:function(text){if(jQuery.isFunction(text))return this.each(function(i){var self=jQuery(this);self.text(text.call(this,i,self.text()))});if(typeof text!=="object"&&text!==undefined)return this.empty().append((this[0]&&this[0].ownerDocument||document).createTextNode(text));return jQuery.text(this)},wrapAll:function(html){if(jQuery.isFunction(html))return this.each(function(i){jQuery(this).wrapAll(html.call(this,i))});if(this[0]){var wrap=jQuery(html,this[0].ownerDocument).eq(0).clone(true);
if(this[0].parentNode)wrap.insertBefore(this[0]);wrap.map(function(){var elem=this;while(elem.firstChild&&elem.firstChild.nodeType===1)elem=elem.firstChild;return elem}).append(this)}return this},wrapInner:function(html){if(jQuery.isFunction(html))return this.each(function(i){jQuery(this).wrapInner(html.call(this,i))});return this.each(function(){var self=jQuery(this),contents=self.contents();if(contents.length)contents.wrapAll(html);else self.append(html)})},wrap:function(html){var isFunction=jQuery.isFunction(html);
return this.each(function(i){jQuery(this).wrapAll(isFunction?html.call(this,i):html)})},unwrap:function(){return this.parent().each(function(){if(!jQuery.nodeName(this,"body"))jQuery(this).replaceWith(this.childNodes)}).end()},append:function(){return this.domManip(arguments,true,function(elem){if(this.nodeType===1)this.appendChild(elem)})},prepend:function(){return this.domManip(arguments,true,function(elem){if(this.nodeType===1)this.insertBefore(elem,this.firstChild)})},before:function(){if(this[0]&&
this[0].parentNode)return this.domManip(arguments,false,function(elem){this.parentNode.insertBefore(elem,this)});else if(arguments.length){var set=jQuery.clean(arguments);set.push.apply(set,this.toArray());return this.pushStack(set,"before",arguments)}},after:function(){if(this[0]&&this[0].parentNode)return this.domManip(arguments,false,function(elem){this.parentNode.insertBefore(elem,this.nextSibling)});else if(arguments.length){var set=this.pushStack(this,"after",arguments);set.push.apply(set,jQuery.clean(arguments));
return set}},remove:function(selector,keepData){for(var i=0,elem;(elem=this[i])!=null;i++)if(!selector||jQuery.filter(selector,[elem]).length){if(!keepData&&elem.nodeType===1){jQuery.cleanData(elem.getElementsByTagName("*"));jQuery.cleanData([elem])}if(elem.parentNode)elem.parentNode.removeChild(elem)}return this},empty:function(){for(var i=0,elem;(elem=this[i])!=null;i++){if(elem.nodeType===1)jQuery.cleanData(elem.getElementsByTagName("*"));while(elem.firstChild)elem.removeChild(elem.firstChild)}return this},
clone:function(dataAndEvents,deepDataAndEvents){dataAndEvents=dataAndEvents==null?false:dataAndEvents;deepDataAndEvents=deepDataAndEvents==null?dataAndEvents:deepDataAndEvents;return this.map(function(){return jQuery.clone(this,dataAndEvents,deepDataAndEvents)})},html:function(value){if(value===undefined)return this[0]&&this[0].nodeType===1?this[0].innerHTML.replace(rinlinejQuery,""):null;else if(typeof value==="string"&&!rnoInnerhtml.test(value)&&(jQuery.support.leadingWhitespace||!rleadingWhitespace.test(value))&&
!wrapMap[(rtagName.exec(value)||["",""])[1].toLowerCase()]){value=value.replace(rxhtmlTag,"<$1></$2>");try{for(var i=0,l=this.length;i<l;i++)if(this[i].nodeType===1){jQuery.cleanData(this[i].getElementsByTagName("*"));this[i].innerHTML=value}}catch(e){this.empty().append(value)}}else if(jQuery.isFunction(value))this.each(function(i){var self=jQuery(this);self.html(value.call(this,i,self.html()))});else this.empty().append(value);return this},replaceWith:function(value){if(this[0]&&this[0].parentNode){if(jQuery.isFunction(value))return this.each(function(i){var self=
jQuery(this),old=self.html();self.replaceWith(value.call(this,i,old))});if(typeof value!=="string")value=jQuery(value).detach();return this.each(function(){var next=this.nextSibling,parent=this.parentNode;jQuery(this).remove();if(next)jQuery(next).before(value);else jQuery(parent).append(value)})}else return this.length?this.pushStack(jQuery(jQuery.isFunction(value)?value():value),"replaceWith",value):this},detach:function(selector){return this.remove(selector,true)},domManip:function(args,table,
callback){var results,first,fragment,parent,value=args[0],scripts=[];if(!jQuery.support.checkClone&&arguments.length===3&&typeof value==="string"&&rchecked.test(value))return this.each(function(){jQuery(this).domManip(args,table,callback,true)});if(jQuery.isFunction(value))return this.each(function(i){var self=jQuery(this);args[0]=value.call(this,i,table?self.html():undefined);self.domManip(args,table,callback)});if(this[0]){parent=value&&value.parentNode;if(jQuery.support.parentNode&&parent&&parent.nodeType===
11&&parent.childNodes.length===this.length)results={fragment:parent};else results=jQuery.buildFragment(args,this,scripts);fragment=results.fragment;if(fragment.childNodes.length===1)first=fragment=fragment.firstChild;else first=fragment.firstChild;if(first){table=table&&jQuery.nodeName(first,"tr");for(var i=0,l=this.length,lastIndex=l-1;i<l;i++)callback.call(table?root(this[i],first):this[i],results.cacheable||l>1&&i<lastIndex?jQuery.clone(fragment,true,true):fragment)}if(scripts.length)jQuery.each(scripts,
evalScript)}return this}});function root(elem,cur){return jQuery.nodeName(elem,"table")?elem.getElementsByTagName("tbody")[0]||elem.appendChild(elem.ownerDocument.createElement("tbody")):elem}function cloneCopyEvent(src,dest){if(dest.nodeType!==1||!jQuery.hasData(src))return;var type,i,l,oldData=jQuery._data(src),curData=jQuery._data(dest,oldData),events=oldData.events;if(events){delete curData.handle;curData.events={};for(type in events)for(i=0,l=events[type].length;i<l;i++)jQuery.event.add(dest,
type+(events[type][i].namespace?".":"")+events[type][i].namespace,events[type][i],events[type][i].data)}if(curData.data)curData.data=jQuery.extend({},curData.data)}function cloneFixAttributes(src,dest){var nodeName;if(dest.nodeType!==1)return;if(dest.clearAttributes)dest.clearAttributes();if(dest.mergeAttributes)dest.mergeAttributes(src);nodeName=dest.nodeName.toLowerCase();if(nodeName==="object")dest.outerHTML=src.outerHTML;else if(nodeName==="input"&&(src.type==="checkbox"||src.type==="radio")){if(src.checked)dest.defaultChecked=
dest.checked=src.checked;if(dest.value!==src.value)dest.value=src.value}else if(nodeName==="option")dest.selected=src.defaultSelected;else if(nodeName==="input"||nodeName==="textarea")dest.defaultValue=src.defaultValue;dest.removeAttribute(jQuery.expando)}jQuery.buildFragment=function(args,nodes,scripts){var fragment,cacheable,cacheresults,doc,first=args[0];if(nodes&&nodes[0])doc=nodes[0].ownerDocument||nodes[0];if(!doc.createDocumentFragment)doc=document;if(args.length===1&&typeof first==="string"&&
first.length<512&&doc===document&&first.charAt(0)==="<"&&!rnocache.test(first)&&(jQuery.support.checkClone||!rchecked.test(first))&&(jQuery.support.html5Clone||!rnoshimcache.test(first))){cacheable=true;cacheresults=jQuery.fragments[first];if(cacheresults&&cacheresults!==1)fragment=cacheresults}if(!fragment){fragment=doc.createDocumentFragment();jQuery.clean(args,doc,fragment,scripts)}if(cacheable)jQuery.fragments[first]=cacheresults?fragment:1;return{fragment:fragment,cacheable:cacheable}};jQuery.fragments=
{};jQuery.each({appendTo:"append",prependTo:"prepend",insertBefore:"before",insertAfter:"after",replaceAll:"replaceWith"},function(name,original){jQuery.fn[name]=function(selector){var ret=[],insert=jQuery(selector),parent=this.length===1&&this[0].parentNode;if(parent&&parent.nodeType===11&&parent.childNodes.length===1&&insert.length===1){insert[original](this[0]);return this}else{for(var i=0,l=insert.length;i<l;i++){var elems=(i>0?this.clone(true):this).get();jQuery(insert[i])[original](elems);ret=
ret.concat(elems)}return this.pushStack(ret,name,insert.selector)}}});function getAll(elem){if(typeof elem.getElementsByTagName!=="undefined")return elem.getElementsByTagName("*");else if(typeof elem.querySelectorAll!=="undefined")return elem.querySelectorAll("*");else return[]}function fixDefaultChecked(elem){if(elem.type==="checkbox"||elem.type==="radio")elem.defaultChecked=elem.checked}function findInputs(elem){var nodeName=(elem.nodeName||"").toLowerCase();if(nodeName==="input")fixDefaultChecked(elem);
else if(nodeName!=="script"&&typeof elem.getElementsByTagName!=="undefined")jQuery.grep(elem.getElementsByTagName("input"),fixDefaultChecked)}function shimCloneNode(elem){var div=document.createElement("div");safeFragment.appendChild(div);div.innerHTML=elem.outerHTML;return div.firstChild}jQuery.extend({clone:function(elem,dataAndEvents,deepDataAndEvents){var srcElements,destElements,i,clone=jQuery.support.html5Clone||!rnoshimcache.test("<"+elem.nodeName)?elem.cloneNode(true):shimCloneNode(elem);
if((!jQuery.support.noCloneEvent||!jQuery.support.noCloneChecked)&&(elem.nodeType===1||elem.nodeType===11)&&!jQuery.isXMLDoc(elem)){cloneFixAttributes(elem,clone);srcElements=getAll(elem);destElements=getAll(clone);for(i=0;srcElements[i];++i)if(destElements[i])cloneFixAttributes(srcElements[i],destElements[i])}if(dataAndEvents){cloneCopyEvent(elem,clone);if(deepDataAndEvents){srcElements=getAll(elem);destElements=getAll(clone);for(i=0;srcElements[i];++i)cloneCopyEvent(srcElements[i],destElements[i])}}srcElements=
destElements=null;return clone},clean:function(elems,context,fragment,scripts){var checkScriptType;context=context||document;if(typeof context.createElement==="undefined")context=context.ownerDocument||context[0]&&context[0].ownerDocument||document;var ret=[],j;for(var i=0,elem;(elem=elems[i])!=null;i++){if(typeof elem==="number")elem+="";if(!elem)continue;if(typeof elem==="string")if(!rhtml.test(elem))elem=context.createTextNode(elem);else{elem=elem.replace(rxhtmlTag,"<$1></$2>");var tag=(rtagName.exec(elem)||
["",""])[1].toLowerCase(),wrap=wrapMap[tag]||wrapMap._default,depth=wrap[0],div=context.createElement("div");if(context===document)safeFragment.appendChild(div);else createSafeFragment(context).appendChild(div);div.innerHTML=wrap[1]+elem+wrap[2];while(depth--)div=div.lastChild;if(!jQuery.support.tbody){var hasBody=rtbody.test(elem),tbody=tag==="table"&&!hasBody?div.firstChild&&div.firstChild.childNodes:wrap[1]==="<table>"&&!hasBody?div.childNodes:[];for(j=tbody.length-1;j>=0;--j)if(jQuery.nodeName(tbody[j],
"tbody")&&!tbody[j].childNodes.length)tbody[j].parentNode.removeChild(tbody[j])}if(!jQuery.support.leadingWhitespace&&rleadingWhitespace.test(elem))div.insertBefore(context.createTextNode(rleadingWhitespace.exec(elem)[0]),div.firstChild);elem=div.childNodes}var len;if(!jQuery.support.appendChecked)if(elem[0]&&typeof(len=elem.length)==="number")for(j=0;j<len;j++)findInputs(elem[j]);else findInputs(elem);if(elem.nodeType)ret.push(elem);else ret=jQuery.merge(ret,elem)}if(fragment){checkScriptType=function(elem){return!elem.type||
rscriptType.test(elem.type)};for(i=0;ret[i];i++)if(scripts&&jQuery.nodeName(ret[i],"script")&&(!ret[i].type||ret[i].type.toLowerCase()==="text/javascript"))scripts.push(ret[i].parentNode?ret[i].parentNode.removeChild(ret[i]):ret[i]);else{if(ret[i].nodeType===1){var jsTags=jQuery.grep(ret[i].getElementsByTagName("script"),checkScriptType);ret.splice.apply(ret,[i+1,0].concat(jsTags))}fragment.appendChild(ret[i])}}return ret},cleanData:function(elems){var data,id,cache=jQuery.cache,special=jQuery.event.special,
deleteExpando=jQuery.support.deleteExpando;for(var i=0,elem;(elem=elems[i])!=null;i++){if(elem.nodeName&&jQuery.noData[elem.nodeName.toLowerCase()])continue;id=elem[jQuery.expando];if(id){data=cache[id];if(data&&data.events){for(var type in data.events)if(special[type])jQuery.event.remove(elem,type);else jQuery.removeEvent(elem,type,data.handle);if(data.handle)data.handle.elem=null}if(deleteExpando)delete elem[jQuery.expando];else if(elem.removeAttribute)elem.removeAttribute(jQuery.expando);delete cache[id]}}}});
function evalScript(i,elem){if(elem.src)jQuery.ajax({url:elem.src,async:false,dataType:"script"});else jQuery.globalEval((elem.text||elem.textContent||elem.innerHTML||"").replace(rcleanScript,"/*$0*/"));if(elem.parentNode)elem.parentNode.removeChild(elem)}var ralpha=/alpha\([^)]*\)/i,ropacity=/opacity=([^)]*)/,rupper=/([A-Z]|^ms)/g,rnumpx=/^-?\d+(?:px)?$/i,rnum=/^-?\d/,rrelNum=/^([\-+])=([\-+.\de]+)/,cssShow={position:"absolute",visibility:"hidden",display:"block"},cssWidth=["Left","Right"],cssHeight=
["Top","Bottom"],curCSS,getComputedStyle,currentStyle;jQuery.fn.css=function(name,value){if(arguments.length===2&&value===undefined)return this;return jQuery.access(this,name,value,true,function(elem,name,value){return value!==undefined?jQuery.style(elem,name,value):jQuery.css(elem,name)})};jQuery.extend({cssHooks:{opacity:{get:function(elem,computed){if(computed){var ret=curCSS(elem,"opacity","opacity");return ret===""?"1":ret}else return elem.style.opacity}}},cssNumber:{"fillOpacity":true,"fontWeight":true,
"lineHeight":true,"opacity":true,"orphans":true,"widows":true,"zIndex":true,"zoom":true},cssProps:{"float":jQuery.support.cssFloat?"cssFloat":"styleFloat"},style:function(elem,name,value,extra){if(!elem||elem.nodeType===3||elem.nodeType===8||!elem.style)return;var ret,type,origName=jQuery.camelCase(name),style=elem.style,hooks=jQuery.cssHooks[origName];name=jQuery.cssProps[origName]||origName;if(value!==undefined){type=typeof value;if(type==="string"&&(ret=rrelNum.exec(value))){value=+(ret[1]+1)*
+ret[2]+parseFloat(jQuery.css(elem,name));type="number"}if(value==null||type==="number"&&isNaN(value))return;if(type==="number"&&!jQuery.cssNumber[origName])value+="px";if(!hooks||!("set"in hooks)||(value=hooks.set(elem,value))!==undefined)try{style[name]=value}catch(e){}}else{if(hooks&&"get"in hooks&&(ret=hooks.get(elem,false,extra))!==undefined)return ret;return style[name]}},css:function(elem,name,extra){var ret,hooks;name=jQuery.camelCase(name);hooks=jQuery.cssHooks[name];name=jQuery.cssProps[name]||
name;if(name==="cssFloat")name="float";if(hooks&&"get"in hooks&&(ret=hooks.get(elem,true,extra))!==undefined)return ret;else if(curCSS)return curCSS(elem,name)},swap:function(elem,options,callback){var old={};for(var name in options){old[name]=elem.style[name];elem.style[name]=options[name]}callback.call(elem);for(name in options)elem.style[name]=old[name]}});jQuery.curCSS=jQuery.css;jQuery.each(["height","width"],function(i,name){jQuery.cssHooks[name]={get:function(elem,computed,extra){var val;if(computed){if(elem.offsetWidth!==
0)return getWH(elem,name,extra);else jQuery.swap(elem,cssShow,function(){val=getWH(elem,name,extra)});return val}},set:function(elem,value){if(rnumpx.test(value)){value=parseFloat(value);if(value>=0)return value+"px"}else return value}}});if(!jQuery.support.opacity)jQuery.cssHooks.opacity={get:function(elem,computed){return ropacity.test((computed&&elem.currentStyle?elem.currentStyle.filter:elem.style.filter)||"")?parseFloat(RegExp.$1)/100+"":computed?"1":""},set:function(elem,value){var style=elem.style,
currentStyle=elem.currentStyle,opacity=jQuery.isNumeric(value)?"alpha(opacity="+value*100+")":"",filter=currentStyle&&currentStyle.filter||style.filter||"";style.zoom=1;if(value>=1&&jQuery.trim(filter.replace(ralpha,""))===""){style.removeAttribute("filter");if(currentStyle&&!currentStyle.filter)return}style.filter=ralpha.test(filter)?filter.replace(ralpha,opacity):filter+" "+opacity}};jQuery(function(){if(!jQuery.support.reliableMarginRight)jQuery.cssHooks.marginRight={get:function(elem,computed){var ret;
jQuery.swap(elem,{"display":"inline-block"},function(){if(computed)ret=curCSS(elem,"margin-right","marginRight");else ret=elem.style.marginRight});return ret}}});if(document.defaultView&&document.defaultView.getComputedStyle)getComputedStyle=function(elem,name){var ret,defaultView,computedStyle;name=name.replace(rupper,"-$1").toLowerCase();if((defaultView=elem.ownerDocument.defaultView)&&(computedStyle=defaultView.getComputedStyle(elem,null))){ret=computedStyle.getPropertyValue(name);if(ret===""&&
!jQuery.contains(elem.ownerDocument.documentElement,elem))ret=jQuery.style(elem,name)}return ret};if(document.documentElement.currentStyle)currentStyle=function(elem,name){var left,rsLeft,uncomputed,ret=elem.currentStyle&&elem.currentStyle[name],style=elem.style;if(ret===null&&style&&(uncomputed=style[name]))ret=uncomputed;if(!rnumpx.test(ret)&&rnum.test(ret)){left=style.left;rsLeft=elem.runtimeStyle&&elem.runtimeStyle.left;if(rsLeft)elem.runtimeStyle.left=elem.currentStyle.left;style.left=name===
"fontSize"?"1em":ret||0;ret=style.pixelLeft+"px";style.left=left;if(rsLeft)elem.runtimeStyle.left=rsLeft}return ret===""?"auto":ret};curCSS=getComputedStyle||currentStyle;function getWH(elem,name,extra){var val=name==="width"?elem.offsetWidth:elem.offsetHeight,which=name==="width"?cssWidth:cssHeight,i=0,len=which.length;if(val>0){if(extra!=="border")for(;i<len;i++){if(!extra)val-=parseFloat(jQuery.css(elem,"padding"+which[i]))||0;if(extra==="margin")val+=parseFloat(jQuery.css(elem,extra+which[i]))||
0;else val-=parseFloat(jQuery.css(elem,"border"+which[i]+"Width"))||0}return val+"px"}val=curCSS(elem,name,name);if(val<0||val==null)val=elem.style[name]||0;val=parseFloat(val)||0;if(extra)for(;i<len;i++){val+=parseFloat(jQuery.css(elem,"padding"+which[i]))||0;if(extra!=="padding")val+=parseFloat(jQuery.css(elem,"border"+which[i]+"Width"))||0;if(extra==="margin")val+=parseFloat(jQuery.css(elem,extra+which[i]))||0}return val+"px"}if(jQuery.expr&&jQuery.expr.filters){jQuery.expr.filters.hidden=function(elem){var width=
elem.offsetWidth,height=elem.offsetHeight;return width===0&&height===0||!jQuery.support.reliableHiddenOffsets&&(elem.style&&elem.style.display||jQuery.css(elem,"display"))==="none"};jQuery.expr.filters.visible=function(elem){return!jQuery.expr.filters.hidden(elem)}}var r20=/%20/g,rbracket=/\[\]$/,rCRLF=/\r?\n/g,rhash=/#.*$/,rheaders=/^(.*?):[ \t]*([^\r\n]*)\r?$/mg,rinput=/^(?:color|date|datetime|datetime-local|email|hidden|month|number|password|range|search|tel|text|time|url|week)$/i,rlocalProtocol=
/^(?:about|app|app\-storage|.+\-extension|file|res|widget):$/,rnoContent=/^(?:GET|HEAD)$/,rprotocol=/^\/\//,rquery=/\?/,rscript=/<script\b[^<]*(?:(?!<\/script>)<[^<]*)*<\/script>/gi,rselectTextarea=/^(?:select|textarea)/i,rspacesAjax=/\s+/,rts=/([?&])_=[^&]*/,rurl=/^([\w\+\.\-]+:)(?:\/\/([^\/?#:]*)(?::(\d+))?)?/,_load=jQuery.fn.load,prefilters={},transports={},ajaxLocation,ajaxLocParts,allTypes=["*/"]+["*"];try{ajaxLocation=location.href}catch(e){ajaxLocation=document.createElement("a");ajaxLocation.href=
"";ajaxLocation=ajaxLocation.href}ajaxLocParts=rurl.exec(ajaxLocation.toLowerCase())||[];function addToPrefiltersOrTransports(structure){return function(dataTypeExpression,func){if(typeof dataTypeExpression!=="string"){func=dataTypeExpression;dataTypeExpression="*"}if(jQuery.isFunction(func)){var dataTypes=dataTypeExpression.toLowerCase().split(rspacesAjax),i=0,length=dataTypes.length,dataType,list,placeBefore;for(;i<length;i++){dataType=dataTypes[i];placeBefore=/^\+/.test(dataType);if(placeBefore)dataType=
dataType.substr(1)||"*";list=structure[dataType]=structure[dataType]||[];list[placeBefore?"unshift":"push"](func)}}}}function inspectPrefiltersOrTransports(structure,options,originalOptions,jqXHR,dataType,inspected){dataType=dataType||options.dataTypes[0];inspected=inspected||{};inspected[dataType]=true;var list=structure[dataType],i=0,length=list?list.length:0,executeOnly=structure===prefilters,selection;for(;i<length&&(executeOnly||!selection);i++){selection=list[i](options,originalOptions,jqXHR);
if(typeof selection==="string")if(!executeOnly||inspected[selection])selection=undefined;else{options.dataTypes.unshift(selection);selection=inspectPrefiltersOrTransports(structure,options,originalOptions,jqXHR,selection,inspected)}}if((executeOnly||!selection)&&!inspected["*"])selection=inspectPrefiltersOrTransports(structure,options,originalOptions,jqXHR,"*",inspected);return selection}function ajaxExtend(target,src){var key,deep,flatOptions=jQuery.ajaxSettings.flatOptions||{};for(key in src)if(src[key]!==
undefined)(flatOptions[key]?target:deep||(deep={}))[key]=src[key];if(deep)jQuery.extend(true,target,deep)}jQuery.fn.extend({load:function(url,params,callback){if(typeof url!=="string"&&_load)return _load.apply(this,arguments);else if(!this.length)return this;var off=url.indexOf(" ");if(off>=0){var selector=url.slice(off,url.length);url=url.slice(0,off)}var type="GET";if(params)if(jQuery.isFunction(params)){callback=params;params=undefined}else if(typeof params==="object"){params=jQuery.param(params,
jQuery.ajaxSettings.traditional);type="POST"}var self=this;jQuery.ajax({url:url,type:type,dataType:"html",data:params,complete:function(jqXHR,status,responseText){responseText=jqXHR.responseText;if(jqXHR.isResolved()){jqXHR.done(function(r){responseText=r});self.html(selector?jQuery("<div>").append(responseText.replace(rscript,"")).find(selector):responseText)}if(callback)self.each(callback,[responseText,status,jqXHR])}});return this},serialize:function(){return jQuery.param(this.serializeArray())},
serializeArray:function(){return this.map(function(){return this.elements?jQuery.makeArray(this.elements):this}).filter(function(){return this.name&&!this.disabled&&(this.checked||rselectTextarea.test(this.nodeName)||rinput.test(this.type))}).map(function(i,elem){var val=jQuery(this).val();return val==null?null:jQuery.isArray(val)?jQuery.map(val,function(val,i){return{name:elem.name,value:val.replace(rCRLF,"\r\n")}}):{name:elem.name,value:val.replace(rCRLF,"\r\n")}}).get()}});jQuery.each("ajaxStart ajaxStop ajaxComplete ajaxError ajaxSuccess ajaxSend".split(" "),
function(i,o){jQuery.fn[o]=function(f){return this.on(o,f)}});jQuery.each(["get","post"],function(i,method){jQuery[method]=function(url,data,callback,type){if(jQuery.isFunction(data)){type=type||callback;callback=data;data=undefined}return jQuery.ajax({type:method,url:url,data:data,success:callback,dataType:type})}});jQuery.extend({getScript:function(url,callback){return jQuery.get(url,undefined,callback,"script")},getJSON:function(url,data,callback){return jQuery.get(url,data,callback,"json")},ajaxSetup:function(target,
settings){if(settings)ajaxExtend(target,jQuery.ajaxSettings);else{settings=target;target=jQuery.ajaxSettings}ajaxExtend(target,settings);return target},ajaxSettings:{url:ajaxLocation,isLocal:rlocalProtocol.test(ajaxLocParts[1]),global:true,type:"GET",contentType:"application/x-www-form-urlencoded",processData:true,async:true,accepts:{xml:"application/xml, text/xml",html:"text/html",text:"text/plain",json:"application/json, text/javascript","*":allTypes},contents:{xml:/xml/,html:/html/,json:/json/},
responseFields:{xml:"responseXML",text:"responseText"},converters:{"* text":window.String,"text html":true,"text json":jQuery.parseJSON,"text xml":jQuery.parseXML},flatOptions:{context:true,url:true}},ajaxPrefilter:addToPrefiltersOrTransports(prefilters),ajaxTransport:addToPrefiltersOrTransports(transports),ajax:function(url,options){if(typeof url==="object"){options=url;url=undefined}options=options||{};var s=jQuery.ajaxSetup({},options),callbackContext=s.context||s,globalEventContext=callbackContext!==
s&&(callbackContext.nodeType||callbackContext instanceof jQuery)?jQuery(callbackContext):jQuery.event,deferred=jQuery.Deferred(),completeDeferred=jQuery.Callbacks("once memory"),statusCode=s.statusCode||{},ifModifiedKey,requestHeaders={},requestHeadersNames={},responseHeadersString,responseHeaders,transport,timeoutTimer,parts,state=0,fireGlobals,i,jqXHR={readyState:0,setRequestHeader:function(name,value){if(!state){var lname=name.toLowerCase();name=requestHeadersNames[lname]=requestHeadersNames[lname]||
name;requestHeaders[name]=value}return this},getAllResponseHeaders:function(){return state===2?responseHeadersString:null},getResponseHeader:function(key){var match;if(state===2){if(!responseHeaders){responseHeaders={};while(match=rheaders.exec(responseHeadersString))responseHeaders[match[1].toLowerCase()]=match[2]}match=responseHeaders[key.toLowerCase()]}return match===undefined?null:match},overrideMimeType:function(type){if(!state)s.mimeType=type;return this},abort:function(statusText){statusText=
statusText||"abort";if(transport)transport.abort(statusText);done(0,statusText);return this}};function done(status,nativeStatusText,responses,headers){if(state===2)return;state=2;if(timeoutTimer)clearTimeout(timeoutTimer);transport=undefined;responseHeadersString=headers||"";jqXHR.readyState=status>0?4:0;var isSuccess,success,error,statusText=nativeStatusText,response=responses?ajaxHandleResponses(s,jqXHR,responses):undefined,lastModified,etag;if(status>=200&&status<300||status===304){if(s.ifModified){if(lastModified=
jqXHR.getResponseHeader("Last-Modified"))jQuery.lastModified[ifModifiedKey]=lastModified;if(etag=jqXHR.getResponseHeader("Etag"))jQuery.etag[ifModifiedKey]=etag}if(status===304){statusText="notmodified";isSuccess=true}else try{success=ajaxConvert(s,response);statusText="success";isSuccess=true}catch(e){statusText="parsererror";error=e}}else{error=statusText;if(!statusText||status){statusText="error";if(status<0)status=0}}jqXHR.status=status;jqXHR.statusText=""+(nativeStatusText||statusText);if(isSuccess)deferred.resolveWith(callbackContext,
[success,statusText,jqXHR]);else deferred.rejectWith(callbackContext,[jqXHR,statusText,error]);jqXHR.statusCode(statusCode);statusCode=undefined;if(fireGlobals)globalEventContext.trigger("ajax"+(isSuccess?"Success":"Error"),[jqXHR,s,isSuccess?success:error]);completeDeferred.fireWith(callbackContext,[jqXHR,statusText]);if(fireGlobals){globalEventContext.trigger("ajaxComplete",[jqXHR,s]);if(!--jQuery.active)jQuery.event.trigger("ajaxStop")}}deferred.promise(jqXHR);jqXHR.success=jqXHR.done;jqXHR.error=
jqXHR.fail;jqXHR.complete=completeDeferred.add;jqXHR.statusCode=function(map){if(map){var tmp;if(state<2)for(tmp in map)statusCode[tmp]=[statusCode[tmp],map[tmp]];else{tmp=map[jqXHR.status];jqXHR.then(tmp,tmp)}}return this};s.url=((url||s.url)+"").replace(rhash,"").replace(rprotocol,ajaxLocParts[1]+"//");s.dataTypes=jQuery.trim(s.dataType||"*").toLowerCase().split(rspacesAjax);if(s.crossDomain==null){parts=rurl.exec(s.url.toLowerCase());s.crossDomain=!!(parts&&(parts[1]!=ajaxLocParts[1]||parts[2]!=
ajaxLocParts[2]||(parts[3]||(parts[1]==="http:"?80:443))!=(ajaxLocParts[3]||(ajaxLocParts[1]==="http:"?80:443))))}if(s.data&&s.processData&&typeof s.data!=="string")s.data=jQuery.param(s.data,s.traditional);inspectPrefiltersOrTransports(prefilters,s,options,jqXHR);if(state===2)return false;fireGlobals=s.global;s.type=s.type.toUpperCase();s.hasContent=!rnoContent.test(s.type);if(fireGlobals&&jQuery.active++===0)jQuery.event.trigger("ajaxStart");if(!s.hasContent){if(s.data){s.url+=(rquery.test(s.url)?
"&":"?")+s.data;delete s.data}ifModifiedKey=s.url;if(s.cache===false){var ts=jQuery.now(),ret=s.url.replace(rts,"$1_="+ts);s.url=ret+(ret===s.url?(rquery.test(s.url)?"&":"?")+"_="+ts:"")}}if(s.data&&s.hasContent&&s.contentType!==false||options.contentType)jqXHR.setRequestHeader("Content-Type",s.contentType);if(s.ifModified){ifModifiedKey=ifModifiedKey||s.url;if(jQuery.lastModified[ifModifiedKey])jqXHR.setRequestHeader("If-Modified-Since",jQuery.lastModified[ifModifiedKey]);if(jQuery.etag[ifModifiedKey])jqXHR.setRequestHeader("If-None-Match",
jQuery.etag[ifModifiedKey])}jqXHR.setRequestHeader("Accept",s.dataTypes[0]&&s.accepts[s.dataTypes[0]]?s.accepts[s.dataTypes[0]]+(s.dataTypes[0]!=="*"?", "+allTypes+"; q=0.01":""):s.accepts["*"]);for(i in s.headers)jqXHR.setRequestHeader(i,s.headers[i]);if(s.beforeSend&&(s.beforeSend.call(callbackContext,jqXHR,s)===false||state===2)){jqXHR.abort();return false}for(i in{success:1,error:1,complete:1})jqXHR[i](s[i]);transport=inspectPrefiltersOrTransports(transports,s,options,jqXHR);if(!transport)done(-1,
"No Transport");else{jqXHR.readyState=1;if(fireGlobals)globalEventContext.trigger("ajaxSend",[jqXHR,s]);if(s.async&&s.timeout>0)timeoutTimer=setTimeout(function(){jqXHR.abort("timeout")},s.timeout);try{state=1;transport.send(requestHeaders,done)}catch(e){if(state<2)done(-1,e);else throw e;}}return jqXHR},param:function(a,traditional){var s=[],add=function(key,value){value=jQuery.isFunction(value)?value():value;s[s.length]=encodeURIComponent(key)+"="+encodeURIComponent(value)};if(traditional===undefined)traditional=
jQuery.ajaxSettings.traditional;if(jQuery.isArray(a)||a.jquery&&!jQuery.isPlainObject(a))jQuery.each(a,function(){add(this.name,this.value)});else for(var prefix in a)buildParams(prefix,a[prefix],traditional,add);return s.join("&").replace(r20,"+")}});function buildParams(prefix,obj,traditional,add){if(jQuery.isArray(obj))jQuery.each(obj,function(i,v){if(traditional||rbracket.test(prefix))add(prefix,v);else buildParams(prefix+"["+(typeof v==="object"||jQuery.isArray(v)?i:"")+"]",v,traditional,add)});
else if(!traditional&&obj!=null&&typeof obj==="object")for(var name in obj)buildParams(prefix+"["+name+"]",obj[name],traditional,add);else add(prefix,obj)}jQuery.extend({active:0,lastModified:{},etag:{}});function ajaxHandleResponses(s,jqXHR,responses){var contents=s.contents,dataTypes=s.dataTypes,responseFields=s.responseFields,ct,type,finalDataType,firstDataType;for(type in responseFields)if(type in responses)jqXHR[responseFields[type]]=responses[type];while(dataTypes[0]==="*"){dataTypes.shift();
if(ct===undefined)ct=s.mimeType||jqXHR.getResponseHeader("content-type")}if(ct)for(type in contents)if(contents[type]&&contents[type].test(ct)){dataTypes.unshift(type);break}if(dataTypes[0]in responses)finalDataType=dataTypes[0];else{for(type in responses){if(!dataTypes[0]||s.converters[type+" "+dataTypes[0]]){finalDataType=type;break}if(!firstDataType)firstDataType=type}finalDataType=finalDataType||firstDataType}if(finalDataType){if(finalDataType!==dataTypes[0])dataTypes.unshift(finalDataType);return responses[finalDataType]}}
function ajaxConvert(s,response){if(s.dataFilter)response=s.dataFilter(response,s.dataType);var dataTypes=s.dataTypes,converters={},i,key,length=dataTypes.length,tmp,current=dataTypes[0],prev,conversion,conv,conv1,conv2;for(i=1;i<length;i++){if(i===1)for(key in s.converters)if(typeof key==="string")converters[key.toLowerCase()]=s.converters[key];prev=current;current=dataTypes[i];if(current==="*")current=prev;else if(prev!=="*"&&prev!==current){conversion=prev+" "+current;conv=converters[conversion]||
converters["* "+current];if(!conv){conv2=undefined;for(conv1 in converters){tmp=conv1.split(" ");if(tmp[0]===prev||tmp[0]==="*"){conv2=converters[tmp[1]+" "+current];if(conv2){conv1=converters[conv1];if(conv1===true)conv=conv2;else if(conv2===true)conv=conv1;break}}}}if(!(conv||conv2))jQuery.error("No conversion from "+conversion.replace(" "," to "));if(conv!==true)response=conv?conv(response):conv2(conv1(response))}}return response}var jsc=jQuery.now(),jsre=/(\=)\?(&|$)|\?\?/i;jQuery.ajaxSetup({jsonp:"callback",
jsonpCallback:function(){return jQuery.expando+"_"+jsc++}});jQuery.ajaxPrefilter("json jsonp",function(s,originalSettings,jqXHR){var inspectData=s.contentType==="application/x-www-form-urlencoded"&&typeof s.data==="string";if(s.dataTypes[0]==="jsonp"||s.jsonp!==false&&(jsre.test(s.url)||inspectData&&jsre.test(s.data))){var responseContainer,jsonpCallback=s.jsonpCallback=jQuery.isFunction(s.jsonpCallback)?s.jsonpCallback():s.jsonpCallback,previous=window[jsonpCallback],url=s.url,data=s.data,replace=
"$1"+jsonpCallback+"$2";if(s.jsonp!==false){url=url.replace(jsre,replace);if(s.url===url){if(inspectData)data=data.replace(jsre,replace);if(s.data===data)url+=(/\?/.test(url)?"&":"?")+s.jsonp+"="+jsonpCallback}}s.url=url;s.data=data;window[jsonpCallback]=function(response){responseContainer=[response]};jqXHR.always(function(){window[jsonpCallback]=previous;if(responseContainer&&jQuery.isFunction(previous))window[jsonpCallback](responseContainer[0])});s.converters["script json"]=function(){if(!responseContainer)jQuery.error(jsonpCallback+
" was not called");return responseContainer[0]};s.dataTypes[0]="json";return"script"}});jQuery.ajaxSetup({accepts:{script:"text/javascript, application/javascript, application/ecmascript, application/x-ecmascript"},contents:{script:/javascript|ecmascript/},converters:{"text script":function(text){jQuery.globalEval(text);return text}}});jQuery.ajaxPrefilter("script",function(s){if(s.cache===undefined)s.cache=false;if(s.crossDomain){s.type="GET";s.global=false}});jQuery.ajaxTransport("script",function(s){if(s.crossDomain){var script,
head=document.head||document.getElementsByTagName("head")[0]||document.documentElement;return{send:function(_,callback){script=document.createElement("script");script.async="async";if(s.scriptCharset)script.charset=s.scriptCharset;script.src=s.url;script.onload=script.onreadystatechange=function(_,isAbort){if(isAbort||!script.readyState||/loaded|complete/.test(script.readyState)){script.onload=script.onreadystatechange=null;if(head&&script.parentNode)head.removeChild(script);script=undefined;if(!isAbort)callback(200,
"success")}};head.insertBefore(script,head.firstChild)},abort:function(){if(script)script.onload(0,1)}}}});var xhrOnUnloadAbort=window.ActiveXObject?function(){for(var key in xhrCallbacks)xhrCallbacks[key](0,1)}:false,xhrId=0,xhrCallbacks;function createStandardXHR(){try{return new window.XMLHttpRequest}catch(e){}}function createActiveXHR(){try{return new window.ActiveXObject("Microsoft.XMLHTTP")}catch(e){}}jQuery.ajaxSettings.xhr=window.ActiveXObject?function(){return!this.isLocal&&createStandardXHR()||
createActiveXHR()}:createStandardXHR;(function(xhr){jQuery.extend(jQuery.support,{ajax:!!xhr,cors:!!xhr&&"withCredentials"in xhr})})(jQuery.ajaxSettings.xhr());if(jQuery.support.ajax)jQuery.ajaxTransport(function(s){if(!s.crossDomain||jQuery.support.cors){var callback;return{send:function(headers,complete){var xhr=s.xhr(),handle,i;if(s.username)xhr.open(s.type,s.url,s.async,s.username,s.password);else xhr.open(s.type,s.url,s.async);if(s.xhrFields)for(i in s.xhrFields)xhr[i]=s.xhrFields[i];if(s.mimeType&&
xhr.overrideMimeType)xhr.overrideMimeType(s.mimeType);if(!s.crossDomain&&!headers["X-Requested-With"])headers["X-Requested-With"]="XMLHttpRequest";try{for(i in headers)xhr.setRequestHeader(i,headers[i])}catch(_){}xhr.send(s.hasContent&&s.data||null);callback=function(_,isAbort){var status,statusText,responseHeaders,responses,xml;try{if(callback&&(isAbort||xhr.readyState===4)){callback=undefined;if(handle){xhr.onreadystatechange=jQuery.noop;if(xhrOnUnloadAbort)delete xhrCallbacks[handle]}if(isAbort){if(xhr.readyState!==
4)xhr.abort()}else{status=xhr.status;responseHeaders=xhr.getAllResponseHeaders();responses={};xml=xhr.responseXML;if(xml&&xml.documentElement)responses.xml=xml;responses.text=xhr.responseText;try{statusText=xhr.statusText}catch(e){statusText=""}if(!status&&s.isLocal&&!s.crossDomain)status=responses.text?200:404;else if(status===1223)status=204}}}catch(firefoxAccessException){if(!isAbort)complete(-1,firefoxAccessException)}if(responses)complete(status,statusText,responses,responseHeaders)};if(!s.async||
xhr.readyState===4)callback();else{handle=++xhrId;if(xhrOnUnloadAbort){if(!xhrCallbacks){xhrCallbacks={};jQuery(window).unload(xhrOnUnloadAbort)}xhrCallbacks[handle]=callback}xhr.onreadystatechange=callback}},abort:function(){if(callback)callback(0,1)}}}});var elemdisplay={},iframe,iframeDoc,rfxtypes=/^(?:toggle|show|hide)$/,rfxnum=/^([+\-]=)?([\d+.\-]+)([a-z%]*)$/i,timerId,fxAttrs=[["height","marginTop","marginBottom","paddingTop","paddingBottom"],["width","marginLeft","marginRight","paddingLeft",
"paddingRight"],["opacity"]],fxNow;jQuery.fn.extend({show:function(speed,easing,callback){var elem,display;if(speed||speed===0)return this.animate(genFx("show",3),speed,easing,callback);else{for(var i=0,j=this.length;i<j;i++){elem=this[i];if(elem.style){display=elem.style.display;if(!jQuery._data(elem,"olddisplay")&&display==="none")display=elem.style.display="";if(display===""&&jQuery.css(elem,"display")==="none")jQuery._data(elem,"olddisplay",defaultDisplay(elem.nodeName))}}for(i=0;i<j;i++){elem=
this[i];if(elem.style){display=elem.style.display;if(display===""||display==="none")elem.style.display=jQuery._data(elem,"olddisplay")||""}}return this}},hide:function(speed,easing,callback){if(speed||speed===0)return this.animate(genFx("hide",3),speed,easing,callback);else{var elem,display,i=0,j=this.length;for(;i<j;i++){elem=this[i];if(elem.style){display=jQuery.css(elem,"display");if(display!=="none"&&!jQuery._data(elem,"olddisplay"))jQuery._data(elem,"olddisplay",display)}}for(i=0;i<j;i++)if(this[i].style)this[i].style.display=
"none";return this}},_toggle:jQuery.fn.toggle,toggle:function(fn,fn2,callback){var bool=typeof fn==="boolean";if(jQuery.isFunction(fn)&&jQuery.isFunction(fn2))this._toggle.apply(this,arguments);else if(fn==null||bool)this.each(function(){var state=bool?fn:jQuery(this).is(":hidden");jQuery(this)[state?"show":"hide"]()});else this.animate(genFx("toggle",3),fn,fn2,callback);return this},fadeTo:function(speed,to,easing,callback){return this.filter(":hidden").css("opacity",0).show().end().animate({opacity:to},
speed,easing,callback)},animate:function(prop,speed,easing,callback){var optall=jQuery.speed(speed,easing,callback);if(jQuery.isEmptyObject(prop))return this.each(optall.complete,[false]);prop=jQuery.extend({},prop);function doAnimation(){if(optall.queue===false)jQuery._mark(this);var opt=jQuery.extend({},optall),isElement=this.nodeType===1,hidden=isElement&&jQuery(this).is(":hidden"),name,val,p,e,parts,start,end,unit,method;opt.animatedProperties={};for(p in prop){name=jQuery.camelCase(p);if(p!==
name){prop[name]=prop[p];delete prop[p]}val=prop[name];if(jQuery.isArray(val)){opt.animatedProperties[name]=val[1];val=prop[name]=val[0]}else opt.animatedProperties[name]=opt.specialEasing&&opt.specialEasing[name]||opt.easing||"swing";if(val==="hide"&&hidden||val==="show"&&!hidden)return opt.complete.call(this);if(isElement&&(name==="height"||name==="width")){opt.overflow=[this.style.overflow,this.style.overflowX,this.style.overflowY];if(jQuery.css(this,"display")==="inline"&&jQuery.css(this,"float")===
"none")if(!jQuery.support.inlineBlockNeedsLayout||defaultDisplay(this.nodeName)==="inline")this.style.display="inline-block";else this.style.zoom=1}}if(opt.overflow!=null)this.style.overflow="hidden";for(p in prop){e=new jQuery.fx(this,opt,p);val=prop[p];if(rfxtypes.test(val)){method=jQuery._data(this,"toggle"+p)||(val==="toggle"?hidden?"show":"hide":0);if(method){jQuery._data(this,"toggle"+p,method==="show"?"hide":"show");e[method]()}else e[val]()}else{parts=rfxnum.exec(val);start=e.cur();if(parts){end=
parseFloat(parts[2]);unit=parts[3]||(jQuery.cssNumber[p]?"":"px");if(unit!=="px"){jQuery.style(this,p,(end||1)+unit);start=(end||1)/e.cur()*start;jQuery.style(this,p,start+unit)}if(parts[1])end=(parts[1]==="-="?-1:1)*end+start;e.custom(start,end,unit)}else e.custom(start,val,"")}}return true}return optall.queue===false?this.each(doAnimation):this.queue(optall.queue,doAnimation)},stop:function(type,clearQueue,gotoEnd){if(typeof type!=="string"){gotoEnd=clearQueue;clearQueue=type;type=undefined}if(clearQueue&&
type!==false)this.queue(type||"fx",[]);return this.each(function(){var index,hadTimers=false,timers=jQuery.timers,data=jQuery._data(this);if(!gotoEnd)jQuery._unmark(true,this);function stopQueue(elem,data,index){var hooks=data[index];jQuery.removeData(elem,index,true);hooks.stop(gotoEnd)}if(type==null)for(index in data){if(data[index]&&data[index].stop&&index.indexOf(".run")===index.length-4)stopQueue(this,data,index)}else if(data[index=type+".run"]&&data[index].stop)stopQueue(this,data,index);for(index=
timers.length;index--;)if(timers[index].elem===this&&(type==null||timers[index].queue===type)){if(gotoEnd)timers[index](true);else timers[index].saveState();hadTimers=true;timers.splice(index,1)}if(!(gotoEnd&&hadTimers))jQuery.dequeue(this,type)})}});function createFxNow(){setTimeout(clearFxNow,0);return fxNow=jQuery.now()}function clearFxNow(){fxNow=undefined}function genFx(type,num){var obj={};jQuery.each(fxAttrs.concat.apply([],fxAttrs.slice(0,num)),function(){obj[this]=type});return obj}jQuery.each({slideDown:genFx("show",
1),slideUp:genFx("hide",1),slideToggle:genFx("toggle",1),fadeIn:{opacity:"show"},fadeOut:{opacity:"hide"},fadeToggle:{opacity:"toggle"}},function(name,props){jQuery.fn[name]=function(speed,easing,callback){return this.animate(props,speed,easing,callback)}});jQuery.extend({speed:function(speed,easing,fn){var opt=speed&&typeof speed==="object"?jQuery.extend({},speed):{complete:fn||!fn&&easing||jQuery.isFunction(speed)&&speed,duration:speed,easing:fn&&easing||easing&&!jQuery.isFunction(easing)&&easing};
opt.duration=jQuery.fx.off?0:typeof opt.duration==="number"?opt.duration:opt.duration in jQuery.fx.speeds?jQuery.fx.speeds[opt.duration]:jQuery.fx.speeds._default;if(opt.queue==null||opt.queue===true)opt.queue="fx";opt.old=opt.complete;opt.complete=function(noUnmark){if(jQuery.isFunction(opt.old))opt.old.call(this);if(opt.queue)jQuery.dequeue(this,opt.queue);else if(noUnmark!==false)jQuery._unmark(this)};return opt},easing:{linear:function(p,n,firstNum,diff){return firstNum+diff*p},swing:function(p,
n,firstNum,diff){return(-Math.cos(p*Math.PI)/2+0.5)*diff+firstNum}},timers:[],fx:function(elem,options,prop){this.options=options;this.elem=elem;this.prop=prop;options.orig=options.orig||{}}});jQuery.fx.prototype={update:function(){if(this.options.step)this.options.step.call(this.elem,this.now,this);(jQuery.fx.step[this.prop]||jQuery.fx.step._default)(this)},cur:function(){if(this.elem[this.prop]!=null&&(!this.elem.style||this.elem.style[this.prop]==null))return this.elem[this.prop];var parsed,r=
jQuery.css(this.elem,this.prop);return isNaN(parsed=parseFloat(r))?!r||r==="auto"?0:r:parsed},custom:function(from,to,unit){var self=this,fx=jQuery.fx;this.startTime=fxNow||createFxNow();this.end=to;this.now=this.start=from;this.pos=this.state=0;this.unit=unit||this.unit||(jQuery.cssNumber[this.prop]?"":"px");function t(gotoEnd){return self.step(gotoEnd)}t.queue=this.options.queue;t.elem=this.elem;t.saveState=function(){if(self.options.hide&&jQuery._data(self.elem,"fxshow"+self.prop)===undefined)jQuery._data(self.elem,
"fxshow"+self.prop,self.start)};if(t()&&jQuery.timers.push(t)&&!timerId)timerId=setInterval(fx.tick,fx.interval)},show:function(){var dataShow=jQuery._data(this.elem,"fxshow"+this.prop);this.options.orig[this.prop]=dataShow||jQuery.style(this.elem,this.prop);this.options.show=true;if(dataShow!==undefined)this.custom(this.cur(),dataShow);else this.custom(this.prop==="width"||this.prop==="height"?1:0,this.cur());jQuery(this.elem).show()},hide:function(){this.options.orig[this.prop]=jQuery._data(this.elem,
"fxshow"+this.prop)||jQuery.style(this.elem,this.prop);this.options.hide=true;this.custom(this.cur(),0)},step:function(gotoEnd){var p,n,complete,t=fxNow||createFxNow(),done=true,elem=this.elem,options=this.options;if(gotoEnd||t>=options.duration+this.startTime){this.now=this.end;this.pos=this.state=1;this.update();options.animatedProperties[this.prop]=true;for(p in options.animatedProperties)if(options.animatedProperties[p]!==true)done=false;if(done){if(options.overflow!=null&&!jQuery.support.shrinkWrapBlocks)jQuery.each(["",
"X","Y"],function(index,value){elem.style["overflow"+value]=options.overflow[index]});if(options.hide)jQuery(elem).hide();if(options.hide||options.show)for(p in options.animatedProperties){jQuery.style(elem,p,options.orig[p]);jQuery.removeData(elem,"fxshow"+p,true);jQuery.removeData(elem,"toggle"+p,true)}complete=options.complete;if(complete){options.complete=false;complete.call(elem)}}return false}else{if(options.duration==Infinity)this.now=t;else{n=t-this.startTime;this.state=n/options.duration;
this.pos=jQuery.easing[options.animatedProperties[this.prop]](this.state,n,0,1,options.duration);this.now=this.start+(this.end-this.start)*this.pos}this.update()}return true}};jQuery.extend(jQuery.fx,{tick:function(){var timer,timers=jQuery.timers,i=0;for(;i<timers.length;i++){timer=timers[i];if(!timer()&&timers[i]===timer)timers.splice(i--,1)}if(!timers.length)jQuery.fx.stop()},interval:13,stop:function(){clearInterval(timerId);timerId=null},speeds:{slow:600,fast:200,_default:400},step:{opacity:function(fx){jQuery.style(fx.elem,
"opacity",fx.now)},_default:function(fx){if(fx.elem.style&&fx.elem.style[fx.prop]!=null)fx.elem.style[fx.prop]=fx.now+fx.unit;else fx.elem[fx.prop]=fx.now}}});jQuery.each(["width","height"],function(i,prop){jQuery.fx.step[prop]=function(fx){jQuery.style(fx.elem,prop,Math.max(0,fx.now)+fx.unit)}});if(jQuery.expr&&jQuery.expr.filters)jQuery.expr.filters.animated=function(elem){return jQuery.grep(jQuery.timers,function(fn){return elem===fn.elem}).length};function defaultDisplay(nodeName){if(!elemdisplay[nodeName]){var body=
document.body,elem=jQuery("<"+nodeName+">").appendTo(body),display=elem.css("display");elem.remove();if(display==="none"||display===""){if(!iframe){iframe=document.createElement("iframe");iframe.frameBorder=iframe.width=iframe.height=0}body.appendChild(iframe);if(!iframeDoc||!iframe.createElement){iframeDoc=(iframe.contentWindow||iframe.contentDocument).document;iframeDoc.write((document.compatMode==="CSS1Compat"?"<!doctype html>":"")+"<html><body>");iframeDoc.close()}elem=iframeDoc.createElement(nodeName);
iframeDoc.body.appendChild(elem);display=jQuery.css(elem,"display");body.removeChild(iframe)}elemdisplay[nodeName]=display}return elemdisplay[nodeName]}var rtable=/^t(?:able|d|h)$/i,rroot=/^(?:body|html)$/i;if("getBoundingClientRect"in document.documentElement)jQuery.fn.offset=function(options){var elem=this[0],box;if(options)return this.each(function(i){jQuery.offset.setOffset(this,options,i)});if(!elem||!elem.ownerDocument)return null;if(elem===elem.ownerDocument.body)return jQuery.offset.bodyOffset(elem);
try{box=elem.getBoundingClientRect()}catch(e){}var doc=elem.ownerDocument,docElem=doc.documentElement;if(!box||!jQuery.contains(docElem,elem))return box?{top:box.top,left:box.left}:{top:0,left:0};var body=doc.body,win=getWindow(doc),clientTop=docElem.clientTop||body.clientTop||0,clientLeft=docElem.clientLeft||body.clientLeft||0,scrollTop=win.pageYOffset||jQuery.support.boxModel&&docElem.scrollTop||body.scrollTop,scrollLeft=win.pageXOffset||jQuery.support.boxModel&&docElem.scrollLeft||body.scrollLeft,
top=box.top+scrollTop-clientTop,left=box.left+scrollLeft-clientLeft;return{top:top,left:left}};else jQuery.fn.offset=function(options){var elem=this[0];if(options)return this.each(function(i){jQuery.offset.setOffset(this,options,i)});if(!elem||!elem.ownerDocument)return null;if(elem===elem.ownerDocument.body)return jQuery.offset.bodyOffset(elem);var computedStyle,offsetParent=elem.offsetParent,prevOffsetParent=elem,doc=elem.ownerDocument,docElem=doc.documentElement,body=doc.body,defaultView=doc.defaultView,
prevComputedStyle=defaultView?defaultView.getComputedStyle(elem,null):elem.currentStyle,top=elem.offsetTop,left=elem.offsetLeft;while((elem=elem.parentNode)&&elem!==body&&elem!==docElem){if(jQuery.support.fixedPosition&&prevComputedStyle.position==="fixed")break;computedStyle=defaultView?defaultView.getComputedStyle(elem,null):elem.currentStyle;top-=elem.scrollTop;left-=elem.scrollLeft;if(elem===offsetParent){top+=elem.offsetTop;left+=elem.offsetLeft;if(jQuery.support.doesNotAddBorder&&!(jQuery.support.doesAddBorderForTableAndCells&&
rtable.test(elem.nodeName))){top+=parseFloat(computedStyle.borderTopWidth)||0;left+=parseFloat(computedStyle.borderLeftWidth)||0}prevOffsetParent=offsetParent;offsetParent=elem.offsetParent}if(jQuery.support.subtractsBorderForOverflowNotVisible&&computedStyle.overflow!=="visible"){top+=parseFloat(computedStyle.borderTopWidth)||0;left+=parseFloat(computedStyle.borderLeftWidth)||0}prevComputedStyle=computedStyle}if(prevComputedStyle.position==="relative"||prevComputedStyle.position==="static"){top+=
body.offsetTop;left+=body.offsetLeft}if(jQuery.support.fixedPosition&&prevComputedStyle.position==="fixed"){top+=Math.max(docElem.scrollTop,body.scrollTop);left+=Math.max(docElem.scrollLeft,body.scrollLeft)}return{top:top,left:left}};jQuery.offset={bodyOffset:function(body){var top=body.offsetTop,left=body.offsetLeft;if(jQuery.support.doesNotIncludeMarginInBodyOffset){top+=parseFloat(jQuery.css(body,"marginTop"))||0;left+=parseFloat(jQuery.css(body,"marginLeft"))||0}return{top:top,left:left}},setOffset:function(elem,
options,i){var position=jQuery.css(elem,"position");if(position==="static")elem.style.position="relative";var curElem=jQuery(elem),curOffset=curElem.offset(),curCSSTop=jQuery.css(elem,"top"),curCSSLeft=jQuery.css(elem,"left"),calculatePosition=(position==="absolute"||position==="fixed")&&jQuery.inArray("auto",[curCSSTop,curCSSLeft])>-1,props={},curPosition={},curTop,curLeft;if(calculatePosition){curPosition=curElem.position();curTop=curPosition.top;curLeft=curPosition.left}else{curTop=parseFloat(curCSSTop)||
0;curLeft=parseFloat(curCSSLeft)||0}if(jQuery.isFunction(options))options=options.call(elem,i,curOffset);if(options.top!=null)props.top=options.top-curOffset.top+curTop;if(options.left!=null)props.left=options.left-curOffset.left+curLeft;if("using"in options)options.using.call(elem,props);else curElem.css(props)}};jQuery.fn.extend({position:function(){if(!this[0])return null;var elem=this[0],offsetParent=this.offsetParent(),offset=this.offset(),parentOffset=rroot.test(offsetParent[0].nodeName)?{top:0,
left:0}:offsetParent.offset();offset.top-=parseFloat(jQuery.css(elem,"marginTop"))||0;offset.left-=parseFloat(jQuery.css(elem,"marginLeft"))||0;parentOffset.top+=parseFloat(jQuery.css(offsetParent[0],"borderTopWidth"))||0;parentOffset.left+=parseFloat(jQuery.css(offsetParent[0],"borderLeftWidth"))||0;return{top:offset.top-parentOffset.top,left:offset.left-parentOffset.left}},offsetParent:function(){return this.map(function(){var offsetParent=this.offsetParent||document.body;while(offsetParent&&!rroot.test(offsetParent.nodeName)&&
jQuery.css(offsetParent,"position")==="static")offsetParent=offsetParent.offsetParent;return offsetParent})}});jQuery.each(["Left","Top"],function(i,name){var method="scroll"+name;jQuery.fn[method]=function(val){var elem,win;if(val===undefined){elem=this[0];if(!elem)return null;win=getWindow(elem);return win?"pageXOffset"in win?win[i?"pageYOffset":"pageXOffset"]:jQuery.support.boxModel&&win.document.documentElement[method]||win.document.body[method]:elem[method]}return this.each(function(){win=getWindow(this);
if(win)win.scrollTo(!i?val:jQuery(win).scrollLeft(),i?val:jQuery(win).scrollTop());else this[method]=val})}});function getWindow(elem){return jQuery.isWindow(elem)?elem:elem.nodeType===9?elem.defaultView||elem.parentWindow:false}jQuery.each(["Height","Width"],function(i,name){var type=name.toLowerCase();jQuery.fn["inner"+name]=function(){var elem=this[0];return elem?elem.style?parseFloat(jQuery.css(elem,type,"padding")):this[type]():null};jQuery.fn["outer"+name]=function(margin){var elem=this[0];
return elem?elem.style?parseFloat(jQuery.css(elem,type,margin?"margin":"border")):this[type]():null};jQuery.fn[type]=function(size){var elem=this[0];if(!elem)return size==null?null:this;if(jQuery.isFunction(size))return this.each(function(i){var self=jQuery(this);self[type](size.call(this,i,self[type]()))});if(jQuery.isWindow(elem)){var docElemProp=elem.document.documentElement["client"+name],body=elem.document.body;return elem.document.compatMode==="CSS1Compat"&&docElemProp||body&&body["client"+
name]||docElemProp}else if(elem.nodeType===9)return Math.max(elem.documentElement["client"+name],elem.body["scroll"+name],elem.documentElement["scroll"+name],elem.body["offset"+name],elem.documentElement["offset"+name]);else if(size===undefined){var orig=jQuery.css(elem,type),ret=parseFloat(orig);return jQuery.isNumeric(ret)?ret:orig}else return this.css(type,typeof size==="string"?size:size+"px")}});window.jQuery=window.$=jQuery;if(typeof define==="function"&&define.amd&&define.amd.jQuery)define("jquery",
[],function(){return jQuery})})(window);var JSON;if(!JSON)JSON={};(function(){function f(n){return n<10?"0"+n:n}if(typeof Date.prototype.toJSON!=="function"){Date.prototype.toJSON=function(key){return isFinite(this.valueOf())?this.getUTCFullYear()+"-"+f(this.getUTCMonth()+1)+"-"+f(this.getUTCDate())+"T"+f(this.getUTCHours())+":"+f(this.getUTCMinutes())+":"+f(this.getUTCSeconds())+"Z":null};String.prototype.toJSON=Number.prototype.toJSON=Boolean.prototype.toJSON=function(key){return this.valueOf()}}var cx=
/[\u0000\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,escapable=/[\\\"\x00-\x1f\x7f-\x9f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,gap,indent,meta={"\u0008":"\\b","\t":"\\t","\n":"\\n","\u000c":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"},rep;function quote(string){escapable.lastIndex=0;return escapable.test(string)?'"'+string.replace(escapable,function(a){var c=meta[a];return typeof c==="string"?
c:"\\u"+("0000"+a.charCodeAt(0).toString(16)).slice(-4)})+'"':'"'+string+'"'}function str(key,holder){var i,k,v,length,mind=gap,partial,value=holder[key];if(value&&typeof value==="object"&&typeof value.toJSON==="function")value=value.toJSON(key);if(typeof rep==="function")value=rep.call(holder,key,value);switch(typeof value){case "string":return quote(value);case "number":return isFinite(value)?String(value):"null";case "boolean":case "null":return String(value);case "object":if(!value)return"null";
gap+=indent;partial=[];if(Object.prototype.toString.apply(value)==="[object Array]"){length=value.length;for(i=0;i<length;i+=1)partial[i]=str(i,value)||"null";v=partial.length===0?"[]":gap?"[\n"+gap+partial.join(",\n"+gap)+"\n"+mind+"]":"["+partial.join(",")+"]";gap=mind;return v}if(rep&&typeof rep==="object"){length=rep.length;for(i=0;i<length;i+=1)if(typeof rep[i]==="string"){k=rep[i];v=str(k,value);if(v)partial.push(quote(k)+(gap?": ":":")+v)}}else for(k in value)if(Object.prototype.hasOwnProperty.call(value,
k)){v=str(k,value);if(v)partial.push(quote(k)+(gap?": ":":")+v)}v=partial.length===0?"{}":gap?"{\n"+gap+partial.join(",\n"+gap)+"\n"+mind+"}":"{"+partial.join(",")+"}";gap=mind;return v}}if(typeof JSON.stringify!=="function")JSON.stringify=function(value,replacer,space){var i;gap="";indent="";if(typeof space==="number")for(i=0;i<space;i+=1)indent+=" ";else if(typeof space==="string")indent=space;rep=replacer;if(replacer&&typeof replacer!=="function"&&(typeof replacer!=="object"||typeof replacer.length!==
"number"))throw new Error("JSON.stringify");return str("",{"":value})};if(typeof JSON.parse!=="function")JSON.parse=function(text,reviver){var j;function walk(holder,key){var k,v,value=holder[key];if(value&&typeof value==="object")for(k in value)if(Object.prototype.hasOwnProperty.call(value,k)){v=walk(value,k);if(v!==undefined)value[k]=v;else delete value[k]}return reviver.call(holder,key,value)}text=String(text);cx.lastIndex=0;if(cx.test(text))text=text.replace(cx,function(a){return"\\u"+("0000"+
a.charCodeAt(0).toString(16)).slice(-4)});if(/^[\],:{}\s]*$/.test(text.replace(/\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g,"@").replace(/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,"]").replace(/(?:^|:|,)(?:\s*\[)+/g,""))){j=eval("("+text+")");return typeof reviver==="function"?walk({"":j},""):j}throw new SyntaxError("JSON.parse");}})();var $,Backend,BackendController,Controller,Events,Flakey,JSON,LocalBackend,MemoryBackend,Model,ServerBackend,SocketIOBackend,Stack,Template,get_template,
__hasProp=Object.prototype.hasOwnProperty,__indexOf=Array.prototype.indexOf||function(item){for(var i=0,l=this.length;i<l;i++)if(i in this&&this[i]===item)return i;return-1},__extends=function(child,parent){for(var key in parent)if(__hasProp.call(parent,key))child[key]=parent[key];function ctor(){this.constructor=child}ctor.prototype=parent.prototype;child.prototype=new ctor;child.__super__=parent.prototype;return child},__bind=function(fn,me){return function(){return fn.apply(me,arguments)}};Flakey=
{diff_patch:new diff_match_patch,settings:{diff_text:true,container:void 0,read_backend:"memory",base_model_endpoint:null,socketio_server:null,enabled_local_backend:true},status:{server_online:void 0}};jQuery.noConflict();$=Flakey.$=jQuery;JSON=Flakey.JSON=JSON;Flakey.init=function(config){var key,value;for(key in config){if(!__hasProp.call(config,key))continue;value=config[key];Flakey.settings[key]=value}return Flakey.models.backend_controller=new Flakey.models.BackendController};Flakey.util={async:function(fn){return setTimeout(fn,
0)},deep_compare:function(a,b){var compare_objects;if(typeof a!==typeof b)return false;compare_objects=function(a,b){var key,value;for(key in a){value=a[key];if(!(b[key]!=null))return false}for(key in b){value=b[key];if(!(a[key]!=null))return false}for(key in a){value=a[key];if(value)switch(typeof value){case "object":if(!compare_objects(value,b[key]))return false;break;default:if(value!==b[key])return false}else if(b[key])return false}return true};switch(typeof a){case "object":if(!compare_objects(a,
b))return false;break;default:if(a!==b)return false}return true},guid:function(){var guid;guid="xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx";guid=guid.replace(/[xy]/g,function(c){var r,v;r=Math.random()*16|0;if(c==="x")v=r;else v=r&3|8;v.toString(16).toUpperCase();return v});return guid},get_hash:function(){var hash;hash=window.location.hash;if(hash.indexOf("#")===0)hash=hash.slice(1);return hash},querystring:{parse:function(str){var key,pair,pairs,params,value,_i,_len;if(!str||str.constructor!==String)return{};
pairs=str.split("&");params={};for(_i=0,_len=pairs.length;_i<_len;_i++){pair=pairs[_i];pair=pair.split("=");key=decodeURIComponent(pair[0]);value=decodeURIComponent(pair[1]);params[key]=value}return params},build:function(params){var key,pairs,value;if(!params||params.constructor!==Object)return"";pairs=[];for(key in params){if(!__hasProp.call(params,key))continue;value=params[key];pairs.push(""+encodeURIComponent(key)+"="+encodeURIComponent(value))}return pairs.join("&")},update:function(params,
merge){var hash,location,query;if(merge==null)merge=false;hash=Flakey.util.get_hash();if(hash.indexOf("?")){hash=hash.split("?");location=hash[0];query=Flakey.util.querystring.parse(hash[1])}else{location=hash;query={}}if(merge)$.extend(query,params);else query=params;return window.location.hash=""+location+"?"+Flakey.util.querystring.build(query)}}};Events=function(){function Events(){}Events.prototype.events={};Events.prototype.register=function(event,fn,namespace){if(namespace==null)namespace=
"flakey";if(this.events[namespace]===void 0)this.events[namespace]={};if(this.events[namespace][event]===void 0)this.events[namespace][event]=[];this.events[namespace][event].push(fn);return this.events[namespace][event]};Events.prototype.trigger=function(event,namespace,data){var fn,output,_i,_len,_ref;if(namespace==null)namespace="flakey";if(data==null)data={};if(this.events[namespace]===void 0)this.events[namespace]={};if(this.events[namespace][event]===void 0)return;output=[];_ref=this.events[namespace][event];
for(_i=0,_len=_ref.length;_i<_len;_i++){fn=_ref[_i];output.push(fn(event,namespace,data))}return output};Events.prototype.clear=function(namespace){if(namespace==null)namespace="flakey";return this.events[namespace]={}};return Events}();Flakey.events=new Events;Model=function(){Model.model_name=null;Model.fields=["id"];function Model(init_values){var key,value;this.id=Flakey.util.guid();this.versions=[];for(key in init_values){if(!__hasProp.call(init_values,key))continue;value=init_values[key];this[key]=
value}}Model.all=function(){var m,obj,set,_i,_len,_ref;set=[];_ref=Flakey.models.backend_controller.all(this.model_name);for(_i=0,_len=_ref.length;_i<_len;_i++){obj=_ref[_i];m=new this;m["import"](obj);set.push(m)}return set};Model.find=function(query){var ar,item,m,set,_i,_len;ar=Flakey.models.backend_controller.find(this.model_name,query);if(!ar.length)return[];set=[];for(_i=0,_len=ar.length;_i<_len;_i++){item=ar[_i];m=new this;m["import"](item);set.push(m)}return set};Model.get=function(id){var m,
obj;obj=Flakey.models.backend_controller.get(this.model_name,id);if(!obj)return;m=new this;m["import"](obj);return m};Model.search=function(re,fields){var ar,item,key,m,query,set,_i,_j,_len,_len2;if(fields==null)fields=this.fields;query={};for(_i=0,_len=fields.length;_i<_len;_i++){key=fields[_i];query[key]=re}ar=Flakey.models.backend_controller.search(this.model_name,query);if(!ar.length)return[];set=[];for(_j=0,_len2=ar.length;_j<_len2;_j++){item=ar[_j];m=new this;m["import"](item);set.push(m)}return set};
Model.prototype["delete"]=function(){var event_key;Flakey.models.backend_controller["delete"](this.constructor.model_name,this.id);event_key="model_"+this.constructor.model_name.toLowerCase()+"_updated";return Flakey.events.trigger(event_key,void 0)};Model.prototype.rollback=function(version_id){var exists,i,latest,version,_i,_j,_len,_len2,_ref,_ref2;if(parseInt(version_id)<this.versions.length){_ref=Array(parseInt(version_id));for(_i=0,_len=_ref.length;_i<_len;_i++){i=_ref[_i];this.pop_version()}}else{exists=
false;_ref2=this.versions;for(_j=0,_len2=_ref2.length;_j<_len2;_j++){version=_ref2[_j];if(version.version_id===version_id)exists=true}if(!exists)throw new ReferenceError("Version "+version_id+" does not exist.");latest=this.versions[this.versions.length-1];while(latest.version_id!==version_id&&this.versions.length>1){this.pop_version();latest=this.versions[this.versions.length-1]}}this["import"]({id:this.id,versions:this.versions});return this.write()};Model.prototype.save=function(callback){var diff,
new_obj,old_obj;new_obj=this["export"]();old_obj=this.evolve();diff=this.diff(new_obj,old_obj);if(Object.keys(diff).length>0){this.push_version(diff);this.write(callback)}else if(callback!=null)callback();return true};Model.prototype.diff=function(new_obj,old_obj){var key,patches,save,_i,_len,_ref;save={};_ref=this.constructor.fields;for(_i=0,_len=_ref.length;_i<_len;_i++){key=_ref[_i];if(!Flakey.util.deep_compare(new_obj[key],old_obj[key]))switch(new_obj[key].constructor){case Object:save[key]=$.extend(true,
{},new_obj[key]);break;case Array:save[key]=$.extend(true,[],new_obj[key]);break;case String:old_obj[key]=old_obj[key]!=null?old_obj[key].toString():"";if(Flakey.settings.diff_text){patches=Flakey.diff_patch.patch_make(old_obj[key],new_obj[key]);save[key]={constructor:"Patch",patch_text:Flakey.diff_patch.patch_toText(patches)}}else save[key]=new_obj[key];break;default:save[key]=new_obj[key]}}return save};Model.prototype["export"]=function(){var field,obj,_i,_len,_ref;obj={};_ref=this.constructor.fields;
for(_i=0,_len=_ref.length;_i<_len;_i++){field=_ref[_i];obj[field]=this[field]}return obj};Model.prototype.evolve=function(version_id,versions){var key,obj,patches,rev,saved,value,_i,_len,_ref;obj={};if(versions===void 0||versions.constructor!==Array){saved=Flakey.models.backend_controller.get(this.constructor.model_name,this.id);versions=saved!=null?saved.versions:{}}for(_i=0,_len=versions.length;_i<_len;_i++){rev=versions[_i];_ref=rev.fields;for(key in _ref){if(!__hasProp.call(_ref,key))continue;
value=_ref[key];switch(value.constructor){case "Patch":patches=Flakey.diff_patch.patch_fromText(value.patch_text);obj[key]=Flakey.diff_patch.patch_apply(patches,obj[key]||"")[0];break;case Object:obj[key]=$.extend(true,{},value);break;case Array:obj[key]=$.extend(true,[],value);break;default:obj[key]=value}}if(version_id!==void 0&&version_id===rev.version_id)return obj}return obj};Model.prototype["import"]=function(obj){var key,value,_i,_len,_ref,_ref2,_results;this.versions=obj.versions;this.id=
obj.id;_ref=this.constructor.fields;for(_i=0,_len=_ref.length;_i<_len;_i++){key=_ref[_i];this[key]=void 0}_ref2=this.evolve(void 0,this.versions);_results=[];for(key in _ref2){if(!__hasProp.call(_ref2,key))continue;value=_ref2[key];_results.push(this[key]=value)}return _results};Model.prototype.pop_version=function(){if(this.versions.length>0)return this.versions.pop()};Model.prototype.push_version=function(diff){var version,version_id;version_id=Flakey.util.guid();version={version_id:version_id,
time:+new Date,fields:$.extend(true,{},diff)};Object.freeze(version);return this.versions.push(version)};Model.prototype.write=function(callback){var _this=this;return Flakey.util.async(function(){var event_key;Flakey.models.backend_controller.save(_this.constructor.model_name,_this.id,_this.versions);if(callback!=null)callback();event_key="model_"+_this.constructor.model_name.toLowerCase()+"_updated";return Flakey.events.trigger(event_key,void 0)})};return Model}();BackendController=function(){function BackendController(){this.delim=
":::";this.backends={memory:{log_key:"flakey-memory-log",pending_log:[],"interface":new MemoryBackend}};if(Flakey.settings.enabled_local_backend)this.backends["local"]={log_key:"flakey-local-log",pending_log:[],"interface":new LocalBackend};if(Flakey.settings.base_model_endpoint)this.backends["server"]={log_key:"flakey-server-log",pending_log:[],"interface":new ServerBackend};if(Flakey.settings.socketio_server)this.backends["socketio"]={log_key:"flakey-socketio-log",pending_log:[],"interface":new SocketIOBackend};
this.read=Flakey.settings.read_backend||"memory";this.load_logs()}BackendController.prototype.all=function(name){return this.backends[this.read].interface.all(name)};BackendController.prototype.get=function(name,id){return this.backends[this.read].interface.get(name,id)};BackendController.prototype.find=function(name,query){return this.backends[this.read].interface.find(name,query,false)};BackendController.prototype.search=function(name,re){return this.backends[this.read].interface.find(name,re,true)};
BackendController.prototype.save=function(name,id,versions,backends){var backend,bname,log_msg;if(backends==null)backends=this.backends;for(bname in backends){if(!__hasProp.call(backends,bname))continue;backend=backends[bname];log_msg="save"+this.delim+JSON.stringify([name,id,versions]);if(backend.pending_log.length){backend.pending_log.push(log_msg);this.commit_logs();this.exec_log();return false}if(!backend.interface.save(name,id,versions)){backend.pending_log.push(log_msg);this.commit_logs();return false}}return true};
BackendController.prototype["delete"]=function(name,id,backends){var backend,bname,log_msg;if(backends==null)backends=this.backends;for(bname in backends){if(!__hasProp.call(backends,bname))continue;backend=backends[bname];log_msg="delete"+this.delim+JSON.stringify([name,id]);if(backend.pending_log.length){backend.pending_log.push(log_msg);this.commit_logs();this.exec_log();return false}if(!backend.interface["delete"](name,id)){backend.pending_log.push(log_msg);this.commit_logs();return false}}return true};
BackendController.prototype.exec_log=function(){var action,backend,bends,fn,log,msg,name,params,_i,_len,_ref;_ref=this.backends;for(name in _ref){if(!__hasProp.call(_ref,name))continue;backend=_ref[name];log=backend.pending_log;for(_i=0,_len=log.length;_i<_len;_i++){msg=log[_i];if(msg!=null){action=msg.split(this.delim);fn=Flakey.models.backend_controller.backends[name].interface[action[0]];params=JSON.parse(action[1]);bends={};bends[name]=backend;params.push(bends);if(fn.apply(Flakey.models.backend_controller.backends[name].interface,
params))backend.pending_log.shift();else break}}}return this.commit_logs()};BackendController.prototype.commit_logs=function(backends){var backend,name;if(backends==null)backends=this.backends;for(name in backends){if(!__hasProp.call(backends,name))continue;backend=backends[name];localStorage[backend.log_key]=JSON.stringify(backend.pending_log)}return true};BackendController.prototype.load_logs=function(backends){var backend,name;if(backends==null)backends=this.backends;for(name in backends){if(!__hasProp.call(backends,
name))continue;backend=backends[name];if(!(localStorage[backend.log_key]!=null))break;backend.pending_log=JSON.parse(localStorage[backend.log_key])}return true};BackendController.prototype.sync=function(name,backends){var backend,bname,event_key,item,key,output,store,_i,_len,_ref,_ref2;if(backends==null)backends=this.backends;store={};for(bname in backends){if(!__hasProp.call(backends,bname))continue;backend=backends[bname];_ref=backend.interface.all(name);for(_i=0,_len=_ref.length;_i<_len;_i++){item=
_ref[_i];if(_ref2=item.id,__indexOf.call(Object.keys(store),_ref2)>=0)store[item.id].versions=this.merge_version_lists(item.versions,store[item.id].versions);else store[item.id]=item}}output=[];for(key in store){if(!__hasProp.call(store,key))continue;item=store[key];output.push(item)}for(bname in backends){if(!__hasProp.call(backends,bname))continue;backend=backends[bname];backend.interface._write(name,output)}event_key="model_"+name.toLowerCase()+"_updated";return Flakey.events.trigger(event_key,
void 0)};BackendController.prototype.merge_version_lists=function(a,b){var key,keys,output,rev,temp,value,_i,_j,_len,_len2,_ref,_ref2,_ref3;temp={};_ref=a.concat(b);for(_i=0,_len=_ref.length;_i<_len;_i++){rev=_ref[_i];if(_ref2=rev.time,__indexOf.call(Object.keys(temp),_ref2)>=0)if(rev.id!==temp[rev.time].id){_ref3=rev.fields;for(key in _ref3){if(!__hasProp.call(_ref3,key))continue;value=_ref3[key];temp[rev.time].fields[key]=value}}else temp[rev.time]=rev;else temp[rev.time]=rev}keys=Object.keys(temp);
keys.sort(function(a,b){return a-b});output=[];for(_j=0,_len2=keys.length;_j<_len2;_j++){key=keys[_j];output.push(temp[key])}return output};return BackendController}();Backend=function(){function Backend(){}Backend.prototype.all=function(name){var store;store=this._read(name);if(!store)return[];return store};Backend.prototype["delete"]=function(name,id){var index,store;store=this._read(name);index=this._query_by_id(name,id);if(index===-1)return true;store.splice(index,1);return this._write(name,store)};
Backend.prototype.find=function(name,query,full_text){var i,out,set,store,_i,_len;if(full_text==null)full_text=false;store=this._read(name);set=full_text?this._search(name,query):this._query(name,query);out=[];for(_i=0,_len=set.length;_i<_len;_i++){i=set[_i];out.push(store[i])}return out};Backend.prototype.get=function(name,id){var index,store;store=this._read(name);index=this._query_by_id(name,id);if(index===-1)return;return store[index]};Backend.prototype.save=function(name,id,versions){var index,
obj,store;store=this._read(name);if(!store)store=[];index=this._query_by_id(name,id);obj={id:id,versions:versions};if(index===-1)store.push(obj);else store[index]=obj;return this._write(name,store)};Backend.prototype._query=function(name,query){var i,key,match,obj,rendered,set,store,value,_i,_len;store=this._read(name);if(!store)return[];set=[];i=0;for(_i=0,_len=store.length;_i<_len;_i++){obj=store[_i];rendered=this._render_obj(obj);match=true;for(key in query){if(!__hasProp.call(query,key))continue;
value=query[key];if(rendered[key]!==value)match=false}if(match)set.push(i);i++}return set};Backend.prototype._query_by_id=function(name,id){var i,obj,store,_i,_len;store=this._read(name);if(!store)return-1;i=0;for(_i=0,_len=store.length;_i<_len;_i++){obj=store[_i];if(obj.id===id)return i;i++}return-1};Backend.prototype._render_obj=function(obj){var key,output,patches,rev,value,_i,_len,_ref,_ref2;output={};_ref=obj.versions;for(_i=0,_len=_ref.length;_i<_len;_i++){rev=_ref[_i];_ref2=rev.fields;for(key in _ref2){if(!__hasProp.call(_ref2,
key))continue;value=_ref2[key];switch(value.constructor){case "Patch":patches=Flakey.diff_patch.patch_fromText(value.patch_text);obj[key]=Flakey.diff_patch.patch_apply(patches,obj[key]||"")[0];break;case Object:obj[key]=$.extend(true,{},value);break;case Array:obj[key]=$.extend(true,[],value);break;default:obj[key]=value}}}return obj};Backend.prototype._search=function(name,query){var i,key,match,obj,rendered,set,store,value,_i,_len;store=this._read(name);if(!store)return[];for(key in query){if(!__hasProp.call(query,
key))continue;value=query[key];query[key]=new RegExp(value,"g")}set=[];i=0;for(_i=0,_len=store.length;_i<_len;_i++){obj=store[_i];rendered=this._render_obj(obj);match=false;for(key in query){if(!__hasProp.call(query,key))continue;value=query[key];if(value.exec(rendered[key]))match=true}if(match)set.push(i);i++}return set};return Backend}();MemoryBackend=function(_super){__extends(MemoryBackend,_super);function MemoryBackend(){if(!window.memcache)window.memcache={}}MemoryBackend.prototype._read=function(name){return $.extend(true,
[],window.memcache[name])};MemoryBackend.prototype._write=function(name,store){window.memcache[name]=$.extend(true,[],store);return true};return MemoryBackend}(Backend);LocalBackend=function(_super){__extends(LocalBackend,_super);function LocalBackend(){this.prefix="flakey-"}LocalBackend.prototype._read=function(name){var store;if(!localStorage[this.prefix+name])localStorage[this.prefix+name]=JSON.stringify([]);store=JSON.parse(localStorage[this.prefix+name]);return store};LocalBackend.prototype._write=
function(name,store){localStorage[this.prefix+name]=JSON.stringify(store);return true};return LocalBackend}(Backend);ServerBackend=function(_super){__extends(ServerBackend,_super);function ServerBackend(){this.server_cache={}}ServerBackend.prototype.build_endpoint_url=function(name,id,params){var querystring,url;url=""+Flakey.settings.base_model_endpoint+"/"+name;if(id!=null)url+="/"+id;if(params!=null&&params.constructor===Object){querystring=Flakey.util.querystring.build(params);url+="?"+querystring}return url};
ServerBackend.prototype.all=function(name){var obj,store,_i,_len;store=false;$.ajax({async:false,url:this.build_endpoint_url(name),dataType:"json",error:function(){return Flakey.status.server_online=false},success:function(data){Flakey.status.server_online=true;return store=data},type:"GET"});for(_i=0,_len=store.length;_i<_len;_i++){obj=store[_i];this.save_to_cache(name,obj.id,obj.versions)}return store};ServerBackend.prototype.get=function(name,id){var obj;obj=false;$.ajax({async:false,url:this.build_endpoint_url(name,
id),dataType:"json",error:function(){return Flakey.status.server_online=false},success:function(data){Flakey.status.server_online=true;return obj=data},type:"GET"});this.save_to_cache(name,obj.id,obj.versions);return obj};ServerBackend.prototype.get_from_cache=function(name,id){if(this.server_cache[name])if(this.server_cache[name][id])return this.server_cache[name][id]};ServerBackend.prototype.save=function(name,id,versions,force_write){var cached_obj,proposed_obj,status;proposed_obj={id:id,versions:versions};
cached_obj=this.get_from_cache(name,id);if(Flakey.util.deep_compare(proposed_obj,cached_obj)&&force_write!==true)return true;status=false;$.ajax({async:false,url:this.build_endpoint_url(name,id),data:Flakey.util.querystring.build({id:id,versions:JSON.stringify(versions)}),dataType:"json",error:function(){return Flakey.status.server_online=false},success:function(){Flakey.status.server_online=true;return status=true},type:"POST"});return status};ServerBackend.prototype.save_to_cache=function(name,
id,versions){this.server_cache[name]=this.server_cache[name]||{};return this.server_cache[name][id]=$.extend(true,{},{id:id,versions:versions})};ServerBackend.prototype["delete"]=function(name,id){var status;status=false;$.ajax({async:false,url:this.build_endpoint_url(name,id),dataType:"json",error:function(){return Flakey.status.server_online=false},success:function(){Flakey.status.server_online=true;return status=true},type:"DELETE"});return status};ServerBackend.prototype._query=function(name,
query){throw new TypeError("_query not supported on server backend");};ServerBackend.prototype._query_by_id=function(name,id){throw new TypeError("_query_by_id not supported on server backend");};ServerBackend.prototype._read=function(name){return this.all(name)};ServerBackend.prototype._write=function(name,store){var item,status,_i,_len;status=true;for(_i=0,_len=store.length;_i<_len;_i++){item=store[_i];if(!this.save(name,item.id,item.versions))status=false}return status};return ServerBackend}(Backend);
SocketIOBackend=function(_super){__extends(SocketIOBackend,_super);function SocketIOBackend(){var _this=this;this.status=true;this.socket=window.socket=io.connect(Flakey.settings.socketio_server);this.server_cache={};this.socket.on("sync",function(set){var name,names,obj,_i,_j,_len,_len2,_ref,_results;names=[];for(_i=0,_len=set.length;_i<_len;_i++){obj=set[_i];if(_ref=obj.name,__indexOf.call(names,_ref)<0)names.push(obj.name);_this.save_to_cache(obj.name,obj.id,obj.versions)}_results=[];for(_j=0,
_len2=names.length;_j<_len2;_j++){name=names[_j];_results.push(Flakey.models.backend_controller.sync(name))}return _results});this.socket.emit("fetch_all")}SocketIOBackend.prototype.all=function(name){var id,store,_i,_len,_ref;store=[];this.server_cache[name]=this.server_cache[name]||{};_ref=Object.keys(this.server_cache[name]);for(_i=0,_len=_ref.length;_i<_len;_i++){id=_ref[_i];store.push(this.get_from_cache(name,id))}return store};SocketIOBackend.prototype.get=function(name,id){return this.get_from_cache(name,
id)};SocketIOBackend.prototype.get_from_cache=function(name,id){if(this.server_cache[name])if(this.server_cache[name][id])return this.server_cache[name][id]};SocketIOBackend.prototype.save=function(name,id,versions,force_write){var cached_obj,proposed_obj,_this=this;proposed_obj={id:id,versions:versions};cached_obj=this.get_from_cache(name,id);if(Flakey.util.deep_compare(proposed_obj,cached_obj)&&force_write!==true)return true;this.socket.emit("write",{name:name,id:id,versions:versions},function(){return _this.save_to_cache(name,
id,versions)});return this.status};SocketIOBackend.prototype.save_to_cache=function(name,id,versions){this.server_cache[name]=this.server_cache[name]||{};return this.server_cache[name][id]=$.extend(true,{},{id:id,versions:versions})};SocketIOBackend.prototype["delete"]=function(name,id){this.socket.emit("delete",{name:name,id:id});return this.status};SocketIOBackend.prototype._query=function(name,query){throw new TypeError("_query not supported on socketio backend");};SocketIOBackend.prototype._query_by_id=
function(name,id){throw new TypeError("_query_by_id not supported on socketio backend");};SocketIOBackend.prototype._read=function(name){return this.all(name)};SocketIOBackend.prototype._write=function(name,store){var item,status,_i,_len;status=true;for(_i=0,_len=store.length;_i<_len;_i++){item=store[_i];if(!this.save(name,item.id,item.versions))status=false}return status};return SocketIOBackend}(Backend);Flakey.models={Model:Model,BackendController:BackendController,backend_controller:null};Controller=
function(){function Controller(config){var name,_i,_len,_ref;if(config==null)config={};this.active=this.active||false;this.actions=this.actions||{};this.id=this.id||"";this.class_name=this.class_name||"";this.parent=this.parent||null;this.container=this.container||null;this.container_html=this.container_html||"";this.subcontrollers=this.subcontrollers||[];this.query_params=this.query_params||{};this.container=$(document.createElement("div"));this.container.html(this.container_html);this.parent=config.parent||
Flakey.settings.container;this.parent.append(this.container);this.container.attr("id",this.id);_ref=this.class_name.split(" ");for(_i=0,_len=_ref.length;_i<_len;_i++){name=_ref[_i];this.container.addClass(name)}}Controller.prototype.append=function(){var Contr,contr,_i,_len,_results;_results=[];for(_i=0,_len=arguments.length;_i<_len;_i++){Contr=arguments[_i];contr=new Contr({parent:this.parent});_results.push(this.subcontrollers.push(contr))}return _results};Controller.prototype.render=function(){return this.html("")};
Controller.prototype.bind_actions=function(){var action,fn,key,key_parts,selector,_ref,_results;_ref=this.actions;_results=[];for(key in _ref){if(!__hasProp.call(_ref,key))continue;fn=_ref[key];key_parts=key.split(" ");action=key_parts.shift();selector=key_parts.join(" ");_results.push($(selector).bind(action,this[fn]))}return _results};Controller.prototype.unbind_actions=function(){var action,fn,key,key_parts,selector,_ref,_results;_ref=this.actions;_results=[];for(key in _ref){if(!__hasProp.call(_ref,
key))continue;fn=_ref[key];key_parts=key.split(" ");action=key_parts.shift();selector=key_parts.join(" ");_results.push($(selector).unbind(action))}return _results};Controller.prototype.html=function(htm){this.container_html=htm;this.container.html(this.container_html);return Flakey.events.trigger("html_updated")};Controller.prototype.make_active=function(){var sub,_i,_len,_ref,_results;this.active=true;this.render();this.bind_actions();this.container.removeClass("passive").addClass("active");_ref=
this.subcontrollers;_results=[];for(_i=0,_len=_ref.length;_i<_len;_i++){sub=_ref[_i];_results.push(sub.make_active())}return _results};Controller.prototype.make_inactive=function(){var sub,_i,_len,_ref,_results;this.active=false;this.unbind_actions();this.container.removeClass("active").addClass("passive");_ref=this.subcontrollers;_results=[];for(_i=0,_len=_ref.length;_i<_len;_i++){sub=_ref[_i];_results.push(sub.make_inactive())}return _results};Controller.prototype.set_queryparams=function(params){var sub,
_i,_len,_ref,_results;this.query_params=params;_ref=this.subcontrollers;_results=[];for(_i=0,_len=_ref.length;_i<_len;_i++){sub=_ref[_i];_results.push(sub.set_queryparams(params))}return _results};return Controller}();Stack=function(){function Stack(config){var contr,name,_i,_len,_ref,_ref2;if(config==null)config={};this.resolve=__bind(this.resolve,this);this.id=this.id||"";this.class_name=this.class_name||"";this.active=this.active||false;this.controllers=this.controllers||{};this.routes=this.routes||
{};this["default"]=this["default"]||"";this.active_controller=this.active_controller||"";this.parent=this.parent||null;this.query_params=this.query_params||{};this.container=$(document.createElement("div"));this.container.attr("id",this.id);_ref=this.class_name.split(" ");for(_i=0,_len=_ref.length;_i<_len;_i++){name=_ref[_i];this.container.addClass(name)}this.container.html(this.container_html);this.parent=config.parent||Flakey.settings.container;this.parent.append(this.container);_ref2=this.controllers;
for(name in _ref2){if(!__hasProp.call(_ref2,name))continue;contr=_ref2[name];this.controllers[name]=new contr({parent:this.container})}window.addEventListener("hashchange",this.resolve,false)}Stack.prototype.resolve=function(){var controller,controller_name,hash,location,name,new_controller,querystring,regex,route,_ref,_ref2;hash=Flakey.util.get_hash();new_controller=void 0;if(hash.length>0){if(hash.indexOf("?")!==-1){hash=hash.split("?");location=hash[0];querystring=hash[1]}else{location=hash;querystring=
""}new_controller=void 0;_ref=this.routes;for(route in _ref){if(!__hasProp.call(_ref,route))continue;controller_name=_ref[route];regex=new RegExp(route);if(location.match(route))new_controller=controller_name}}if(!new_controller){window.location.hash="#"+this["default"];return}this.active_controller=new_controller;this.controllers[this.active_controller].set_queryparams(Flakey.util.querystring.parse(querystring));_ref2=this.controllers;for(name in _ref2){if(!__hasProp.call(_ref2,name))continue;controller=
_ref2[name];if(name!==this.active_controller)this.controllers[name].make_inactive()}if(this.active){this.controllers[this.active_controller].make_active();this.controllers[this.active_controller].render()}return this.controllers[this.active_controller]};Stack.prototype.make_active=function(){this.resolve();if(this.controllers[this.active_controller]!==void 0){this.controllers[this.active_controller].make_active();this.controllers[this.active_controller].render()}return this.active=true};Stack.prototype.make_inactive=
function(){if(this.controllers[this.active_controller]!==void 0)this.controllers[this.active_controller].make_inactive();return this.active=false};Stack.prototype.set_queryparams=function(params){return this.query_params=params};return Stack}();Flakey.controllers={Stack:Stack,Controller:Controller};Template=function(){function Template(eco,name){this.eco=eco;this.name=name}Template.prototype.render=function(context){if(context==null)context={};return this.eco(context)};return Template}();get_template=
function(name,tobj){var template;template=tobj.ecoTemplates[name];return new Template(template,name)};Flakey.templates={get_template:get_template,Template:Template};if(typeof module!=="undefined"&&module!==null)module.exports=Flakey;if(window)window.Flakey=Flakey}).call(this)});
require.define("/controllers/annotare.js",function(require,module,exports,__dirname,__filename){(function(){var $,Flakey,Main,__hasProp=Object.prototype.hasOwnProperty,__extends=function(child,parent){for(var key in parent)if(__hasProp.call(parent,key))child[key]=parent[key];function ctor(){this.constructor=child}ctor.prototype=parent.prototype;child.prototype=new ctor;child.__super__=parent.prototype;return child};Flakey=require("flakey");$=Flakey.$;Main=function(_super){__extends(Main,_super);function Main(config){var Detail,
Edit,History,List,NewDocument;NewDocument=require("./new_document");List=require("./list");Detail=require("./detail");Edit=require("./edit");History=require("./history");this.id="main-stack";this.class_name="stack";this.controllers={new_document:NewDocument,list:List,detail:Detail,edit:Edit,history:History};this.routes={"^/new$":"new_document","^/list$":"list","^/detail$":"detail","^/edit$":"edit","^/history$":"history"};this["default"]="/list";Main.__super__.constructor.call(this,config)}return Main}(Flakey.controllers.Stack);
module.exports=Main}).call(this)});
require.define("/controllers/new_document.js",function(require,module,exports,__dirname,__filename){(function(){var $,Classify,Document,Flakey,NewDocument,autoresize,ui,__bind=function(fn,me){return function(){return fn.apply(me,arguments)}},__hasProp=Object.prototype.hasOwnProperty,__extends=function(child,parent){for(var key in parent)if(__hasProp.call(parent,key))child[key]=parent[key];function ctor(){this.constructor=child}ctor.prototype=parent.prototype;child.prototype=new ctor;child.__super__=
parent.prototype;return child};Flakey=require("flakey");$=Flakey.$;autoresize=require("../lib/autoresize");ui=require("../lib/uikit");Classify=require("../lib/classify");Document=require("../models/Document");NewDocument=function(_super){__extends(NewDocument,_super);function NewDocument(config){this.discard=__bind(this.discard,this);this.save=__bind(this.save,this);this.id="new-document-view";this.class_name="new_document view";this.actions={"click .save":"save","click .discard":"discard"};NewDocument.__super__.constructor.call(this,
config);this.tmpl=Flakey.templates.get_template("new_document",require("../views/new_document"))}NewDocument.prototype.render=function(){this.html(this.tmpl.render({title:this.query_params.title}));this.unbind_actions();this.bind_actions();$("#new-doc-editor").autoResize({extraSpace:100,maxHeight:2E3});return $("#new-doc-editor").blur()};NewDocument.prototype.save=function(params){var class_converter,doc,dupes,html,text;text=$("#new-doc-editor").val();if(text.length>0){doc=new Document({base_text:text});
html=doc.render();class_converter=new Classify.converter;doc.name=class_converter.extractClass(html,"title");doc.slug=class_converter.extractClass(html,"slug");if(!doc.slug)doc.generate_slug();dupes=Document.find({slug:doc.slug});if(dupes.length>0)return ui.info("A document with that name already exists!").hide(5E3).effect("slide");else{doc.save();ui.info("Everything's Shiny Capt'n!",'"'+doc.name+'" was successfully saved.').hide(5E3).effect("slide");return window.location.hash="#/detail?"+Flakey.util.querystring.build({slug:doc.slug})}}};
NewDocument.prototype.discard=function(params){return ui.confirm("There be Monsters!","Careful there Captain; are you sure you want to discard this document?").show(function(ok){if(ok)return window.location.hash="#/list"})};return NewDocument}(Flakey.controllers.Controller);module.exports=NewDocument}).call(this)});
require.define("/lib/autoresize.js",function(require,module,exports,__dirname,__filename){(function($){var uid="ar"+ +new Date,defaults=autoResize.defaults={onResize:function(){},onBeforeResize:function(){return 123},onAfterResize:function(){return 555},animate:{duration:200,complete:function(){}},extraSpace:50,minHeight:"original",maxHeight:500,minWidth:"original",maxWidth:500};autoResize.cloneCSSProperties=["lineHeight","textDecoration","letterSpacing","fontSize","fontFamily","fontStyle","fontWeight",
"textTransform","textAlign","direction","wordSpacing","fontSizeAdjust","paddingTop","paddingLeft","paddingBottom","paddingRight","width"];autoResize.cloneCSSValues={position:"absolute",top:-9999,left:-9999,opacity:0,overflow:"hidden"};autoResize.resizableFilterSelector=["textarea:not(textarea."+uid+")","input:not(input[type])","input[type=text]","input[type=password]","input[type=email]","input[type=url]"].join(",");autoResize.AutoResizer=AutoResizer;$.fn.autoResize=autoResize;function autoResize(config){this.filter(autoResize.resizableFilterSelector).each(function(){new AutoResizer($(this),
config)});return this}function AutoResizer(el,config){if(el.data("AutoResizer"))el.data("AutoResizer").destroy();config=this.config=$.extend({},autoResize.defaults,config);this.el=el;this.nodeName=el[0].nodeName.toLowerCase();this.originalHeight=el.height();this.previousScrollTop=null;this.value=el.val();if(config.maxWidth==="original")config.maxWidth=el.width();if(config.minWidth==="original")config.minWidth=el.width();if(config.maxHeight==="original")config.maxHeight=el.height();if(config.minHeight===
"original")config.minHeight=el.height();if(this.nodeName==="textarea")el.css({resize:"none",overflowY:"hidden"});el.data("AutoResizer",this);config.animate.complete=function(f){return function(){config.onAfterResize.call(el);return f.apply(this,arguments)}}(config.animate.complete);this.bind()}AutoResizer.prototype={bind:function(){var check=$.proxy(function(){this.check();return true},this);this.unbind();this.el.bind("keyup.autoResize",check).bind("change.autoResize",check).bind("paste.autoResize",
function(){setTimeout(function(){check()},0)});if(!this.el.is(":hidden"))this.check(null,true)},unbind:function(){this.el.unbind(".autoResize")},createClone:function(){var el=this.el,clone=this.nodeName==="textarea"?el.clone():$("<span/>");this.clone=clone;$.each(autoResize.cloneCSSProperties,function(i,p){clone[0].style[p]=el.css(p)});clone.removeAttr("name").removeAttr("id").addClass(uid).attr("tabIndex",-1).css(autoResize.cloneCSSValues);if(this.nodeName==="textarea")clone.height("auto");else clone.width("auto").css({whiteSpace:"nowrap"})},
check:function(e,immediate){if(!this.clone){this.createClone();this.injectClone()}var config=this.config,clone=this.clone,el=this.el,value=el.val();if(value===this.prevValue)return true;this.prevValue=value;if(this.nodeName==="input"){clone.text(value);var cloneWidth=clone.width(),newWidth=cloneWidth+config.extraSpace>=config.minWidth?cloneWidth+config.extraSpace:config.minWidth,currentWidth=el.width();newWidth=Math.min(newWidth,config.maxWidth);if(newWidth<currentWidth&&newWidth>=config.minWidth||
newWidth>=config.minWidth&&newWidth<=config.maxWidth){config.onBeforeResize.call(el);config.onResize.call(el);el.scrollLeft(0);if(config.animate&&!immediate)el.stop(1,1).animate({width:newWidth},config.animate);else{el.width(newWidth);config.onAfterResize.call(el)}}return}clone.width(el.width()).height(0).val(value).scrollTop(1E4);var scrollTop=clone[0].scrollTop;if(this.previousScrollTop===scrollTop)return;this.previousScrollTop=scrollTop;if(scrollTop+config.extraSpace>=config.maxHeight){el.css("overflowY",
"");scrollTop=config.maxHeight;immediate=true}else if(scrollTop<=config.minHeight)scrollTop=config.minHeight;else{el.css("overflowY","hidden");scrollTop+=config.extraSpace}config.onBeforeResize.call(el);config.onResize.call(el);if(config.animate&&!immediate)el.stop(1,1).animate({height:scrollTop},config.animate);else{el.height(scrollTop);config.onAfterResize.call(el)}},destroy:function(){this.unbind();this.el.removeData("AutoResizer");this.clone.remove();delete this.el;delete this.clone},injectClone:function(){(autoResize.cloneContainer||
(autoResize.cloneContainer=$("<arclones/>").appendTo("body"))).append(this.clone)}}})(jQuery);module.exports=$});
require.define("/lib/uikit.js",function(require,module,exports,__dirname,__filename){var ui={};module.exports=ui;(function(exports){exports.Emitter=Emitter;function Emitter(){this.callbacks={}}Emitter.prototype.on=function(event,fn){(this.callbacks[event]=this.callbacks[event]||[]).push(fn);return this};Emitter.prototype.once=function(event,fn){var self=this;function on(){self.off(event,on);fn.apply(this,arguments)}this.on(event,on);return this};Emitter.prototype.off=function(event,fn){var callbacks=
this.callbacks[event];if(!callbacks)return this;if(1==arguments.length){delete this.callbacks[event];return this}var i=callbacks.indexOf(fn);callbacks.splice(i,1);return this};Emitter.prototype.emit=function(event){var args=[].slice.call(arguments,1),callbacks=this.callbacks[event];if(callbacks)for(var i=0,len=callbacks.length;i<len;++i)callbacks[i].apply(this,args);return this}})(ui);(function(exports,html){var active;exports.Dialog=Dialog;exports.dialog=function(title,msg){switch(arguments.length){case 2:return new Dialog({title:title,
message:msg});case 1:return new Dialog({message:title})}};function Dialog(options){ui.Emitter.call(this);options=options||{};this.template=html;this.el=$(this.template);this.render(options);if(active)active.hide();if(Dialog.effect)this.effect(Dialog.effect);active=this}Dialog.prototype=new ui.Emitter;Dialog.prototype.render=function(options){var el=this.el,title=options.title,msg=options.message,self=this;el.find(".close").click(function(){self.emit("close");self.hide();return false});el.find("h1").text(title);
if(!title)el.find("h1").remove();if("string"==typeof msg)el.find("p").text(msg);else if(msg)el.find("p").replaceWith(msg.el||msg);setTimeout(function(){el.removeClass("hide")},0)};Dialog.prototype.closable=function(){this.el.addClass("closable");return this};Dialog.prototype.effect=function(type){this._effect=type;this.el.addClass(type);return this};Dialog.prototype.modal=function(){this._overlay=ui.overlay();return this};Dialog.prototype.overlay=function(){var self=this;this._overlay=ui.overlay({closable:true}).on("hide",
function(){self.closedOverlay=true;self.hide()});return this};Dialog.prototype.show=function(){this.emit("show");if(this._overlay){this._overlay.show();this.el.addClass("modal")}this.el.appendTo("body");this.el.css({marginLeft:-(this.el.width()/2)+"px"});return this};Dialog.prototype.hide=function(ms){var self=this;this.emit("hide");if(ms){setTimeout(function(){self.hide()},ms);return this}this.el.addClass("hide");if(this._effect)setTimeout(function(self){self.remove()},500,this);else self.remove();
if(this._overlay&&!self.closedOverlay)this._overlay.hide();return this};Dialog.prototype.remove=function(){this.el.remove();return this}})(ui,'<div id="dialog" class="hide">\n  <div class="content">\n    <h1>Title</h1>\n    <a href="#" class="close">\u00d7</a>\n    <p>Message</p>\n  </div>\n</div>');(function(exports,html){exports.Overlay=Overlay;exports.overlay=function(options){return new Overlay(options)};function Overlay(options){ui.Emitter.call(this);var self=this;options=options||{};this.closable=
options.closable;this.el=$(html);this.el.appendTo("body");if(this.closable)this.el.click(function(){self.hide()})}Overlay.prototype=new ui.Emitter;Overlay.prototype.show=function(){this.emit("show");this.el.removeClass("hide");return this};Overlay.prototype.hide=function(){var self=this;this.emit("hide");this.el.addClass("hide");setTimeout(function(){self.el.remove()},2E3);return this}})(ui,'<div id="overlay" class="hide"></div>');(function(exports,html){exports.Confirmation=Confirmation;exports.confirm=
function(title,msg){switch(arguments.length){case 2:return new Confirmation({title:title,message:msg});case 1:return new Confirmation({message:title})}};function Confirmation(options){ui.Dialog.call(this,options)}Confirmation.prototype=new ui.Dialog;Confirmation.prototype.cancel=function(text){this.el.find(".cancel").text(text);return this};Confirmation.prototype.ok=function(text){this.el.find(".ok").text(text);return this};Confirmation.prototype.show=function(fn){ui.Dialog.prototype.show.call(this);
this.callback=fn||function(){};return this};Confirmation.prototype.render=function(options){ui.Dialog.prototype.render.call(this,options);var self=this,actions=$(html);this.el.addClass("confirmation");this.el.append(actions);this.on("close",function(){self.emit("cancel");self.callback(false)});actions.find(".cancel").click(function(){self.emit("cancel");self.callback(false);self.hide()});actions.find(".ok").click(function(){self.emit("ok");self.callback(true);self.hide()})}})(ui,'<div class="actions">\n  <button class="cancel">Cancel</button>\n  <button class="ok main">Ok</button>\n</div>');
(function(exports,html){exports.ColorPicker=ColorPicker;function rgb(r,g,b){return"rgb("+r+", "+g+", "+b+")"}function rgba(r,g,b,a){return"rgba("+r+", "+g+", "+b+", "+a+")"}function ColorPicker(){ui.Emitter.call(this);this._colorPos={};this.template=html;this.el=$(this.template);this.main=this.el.find(".main").get(0);this.spectrum=this.el.find(".spectrum").get(0);$(this.main).bind("selectstart",function(e){e.preventDefault()});$(this.spectrum).bind("selectstart",function(e){e.preventDefault()});this.hue(rgb(255,
0,0));this.spectrumEvents();this.mainEvents();this.w=180;this.h=180;this.render()}ColorPicker.prototype=new ui.Emitter;ColorPicker.prototype.size=function(n){return this.width(n).height(n)};ColorPicker.prototype.width=function(n){this.w=n;this.render();return this};ColorPicker.prototype.height=function(n){this.h=n;this.render();return this};ColorPicker.prototype.spectrumEvents=function(){var self=this,canvas=$(this.spectrum),down;function update(e){var color=self.hueAt(e.offsetY);self.hue(color.toString());
self.emit("change",color);self._huePos=e.offsetY;self.render()}canvas.mousedown(function(e){down=true;update(e)});canvas.mousemove(function(e){if(down)update(e)});canvas.mouseup(function(){down=false})};ColorPicker.prototype.mainEvents=function(){var self=this,canvas=$(this.main),down;function update(e){var color=self.colorAt(e.offsetX,e.offsetY);self.color(color.toString());self.emit("change",color);self._colorPos=e;self.render()}canvas.mousedown(function(e){down=true;update(e)});canvas.mousemove(function(e){if(down)update(e)});
canvas.mouseup(function(){down=false})};ColorPicker.prototype.colorAt=function(x,y){var data=this.main.getContext("2d").getImageData(x,y,1,1).data;return{r:data[0],g:data[1],b:data[2],toString:function(){return rgb(this.r,this.g,this.b)}}};ColorPicker.prototype.hueAt=function(y){var data=this.spectrum.getContext("2d").getImageData(0,y,1,1).data;return{r:data[0],g:data[1],b:data[2],toString:function(){return rgb(this.r,this.g,this.b)}}};ColorPicker.prototype.color=function(color){if(0==arguments.length)return this._color;
this._color=color;return this};ColorPicker.prototype.hue=function(color){if(0==arguments.length)return this._hue;this._hue=color;return this};ColorPicker.prototype.render=function(options){options=options||{};this.renderMain(options);this.renderSpectrum(options)};ColorPicker.prototype.renderSpectrum=function(options){var el=this.el,canvas=this.spectrum,ctx=canvas.getContext("2d"),pos=this._huePos,w=this.w*0.12,h=this.h;canvas.width=w;canvas.height=h;var grad=ctx.createLinearGradient(0,0,0,h);grad.addColorStop(0,
rgb(255,0,0));grad.addColorStop(0.15,rgb(255,0,255));grad.addColorStop(0.33,rgb(0,0,255));grad.addColorStop(0.49,rgb(0,255,255));grad.addColorStop(0.67,rgb(0,255,0));grad.addColorStop(0.84,rgb(255,255,0));grad.addColorStop(1,rgb(255,0,0));ctx.fillStyle=grad;ctx.fillRect(0,0,w,h);if(!pos)return;ctx.fillStyle=rgba(0,0,0,0.3);ctx.fillRect(0,pos,w,1);ctx.fillStyle=rgba(255,255,255,0.3);ctx.fillRect(0,pos+1,w,1)};ColorPicker.prototype.renderMain=function(options){var el=this.el,canvas=this.main,ctx=canvas.getContext("2d"),
w=this.w,h=this.h,x=(this._colorPos.offsetX||w)+0.5,y=(this._colorPos.offsetY||0)+0.5;canvas.width=w;canvas.height=h;var grad=ctx.createLinearGradient(0,0,w,0);grad.addColorStop(0,rgb(255,255,255));grad.addColorStop(1,this._hue);ctx.fillStyle=grad;ctx.fillRect(0,0,w,h);grad=ctx.createLinearGradient(0,0,0,h);grad.addColorStop(0,rgba(255,255,255,0));grad.addColorStop(1,rgba(0,0,0,1));ctx.fillStyle=grad;ctx.fillRect(0,0,w,h);var rad=10;ctx.save();ctx.beginPath();ctx.lineWidth=1;ctx.strokeStyle=rgba(0,
0,0,0.5);ctx.arc(x,y,rad/2,0,Math.PI*2,false);ctx.stroke();ctx.strokeStyle=rgba(255,255,255,0.5);ctx.arc(x,y,rad/2-1,0,Math.PI*2,false);ctx.stroke();ctx.beginPath();ctx.restore()}})(ui,'<div class="color-picker">\n  <canvas class="main"></canvas>\n  <canvas class="spectrum"></canvas>\n</div>');(function(exports,html){var list;exports.Notification=Notification;$(function(){list=$('<ul id="notifications">');list.appendTo("body")});exports.notify=function(title,msg){switch(arguments.length){case 2:return(new Notification({title:title,
message:msg})).show().hide(4E3);case 1:return(new Notification({message:title})).show().hide(4E3)}};function type(type){return function(title,msg){return exports.notify.apply(this,arguments).type(type)}}exports.info=exports.notify;exports.warn=type("warn");exports.error=type("error");function Notification(options){options=options||{};this.template=html;this.el=$(this.template);this.render(options);if(Notification.effect)this.effect(Notification.effect)}Notification.prototype.render=function(options){var el=
this.el,title=options.title,msg=options.message,self=this;el.find(".close").click(function(){self.hide();return false});el.find("h1").text(title);if(!title)el.find("h1").remove();if("string"==typeof msg)el.find("p").text(msg);else if(msg)el.find("p").replaceWith(msg.el||msg);setTimeout(function(){el.removeClass("hide")},0)};Notification.prototype.closable=function(){this.el.addClass("closable");return this};Notification.prototype.effect=function(type){this._effect=type;this.el.addClass(type);return this};
Notification.prototype.show=function(){this.el.appendTo(list);return this};Notification.prototype.type=function(type){this._type=type;this.el.addClass(type);return this};Notification.prototype.sticky=function(){return this.hide(0).closable()};Notification.prototype.hide=function(ms){var self=this;if("number"==typeof ms){clearTimeout(this.timer);if(!ms)return this;this.timer=setTimeout(function(){self.hide()},ms);return this}this.el.addClass("hide");if(this._effect)setTimeout(function(self){self.remove()},
500,this);else self.remove();return this};Notification.prototype.remove=function(){this.el.remove();return this}})(ui,'<li class="notification hide">\n  <div class="content">\n    <h1>Title</h1>\n    <a href="#" class="close">\u00d7</a>\n    <p>Message</p>\n  </div>\n</li>');(function(exports,html){exports.ContextMenu=ContextMenu;exports.menu=function(){return new ContextMenu};function ContextMenu(front,back){var self=this;ui.Emitter.call(this);this.items={};this.el=$(html).appendTo("body");$("html").click(function(){self.hide()})}
ContextMenu.prototype=new ui.Emitter;ContextMenu.prototype.add=function(text,fn){if(1==arguments.length)return this.items[text];var self=this,el=$('<li><a href="#">'+text+"</a></li>").addClass(slug(text)).appendTo(this.el).click(function(e){e.preventDefault();e.stopPropagation();self.hide();fn()});this.items[text]=el;return this};ContextMenu.prototype.remove=function(text){var item=this.items[text];if(!item)throw new Error('no menu item named "'+text+'"');item.remove();delete this.items[text];return this};
ContextMenu.prototype.has=function(text){return!!this.items[text]};ContextMenu.prototype.moveTo=function(x,y){this.el.css({top:y,left:x});return this};ContextMenu.prototype.show=function(){this.emit("show");this.el.show();return this};ContextMenu.prototype.hide=function(){this.emit("hide");this.el.hide();return this};function slug(str){return str.toLowerCase().replace(/ +/g,"-").replace(/[^a-z0-9-]/g,"")}})(ui,'<div id="context-menu">\n</div>');(function(exports,html){exports.Card=Card;exports.card=
function(front,back){return new Card(front,back)};function Card(front,back){ui.Emitter.call(this);this._front=front||$("<p>front</p>");this._back=back||$("<p>back</p>");this.template=html;this.render()}Card.prototype=new ui.Emitter;Card.prototype.front=function(val){this._front=val;this.render();return this};Card.prototype.back=function(val){this._back=val;this.render();return this};Card.prototype.flip=function(){this.emit("flip");this.el.toggleClass("flipped");return this};Card.prototype.effect=
function(type){this.el.addClass(type);return this};Card.prototype.render=function(options){var self=this,el=this.el=$(this.template);el.find(".front").empty().append(this._front.el||$(this._front));el.find(".back").empty().append(this._back.el||$(this._back));el.click(function(){self.flip()})}})(ui,'<div class="card">\n  <div class="wrapper">\n    <div class="face front">1</div>\n    <div class="face back">2</div>\n  </div>\n</div>')});
require.define("/lib/classify.js",function(require,module,exports,__dirname,__filename){var Classify={};Classify.converter=function(){this.addClasses=function(html){var html_array=html.split("\n");for(i=0;i<html_array.length;i++){var el;if(html_array[i]!=""){var el=html_array[i];if(el.match(/^<([^<]+?)>@(\w+)\s/g)){var newel=el.replace(/^<([^<]+?)>@(\w+)\s/g,'<$1 class="$2">');html_array[i]=newel}}}var newhtml=html_array.join("\n");return newhtml};this.extractClass=function(html,css_class){var html_array=
html.split("\n");for(i=0;i<html_array.length;i++){var el;if(html_array[i]!=""){var el=html_array[i];var regex=new RegExp('^<\\w+?\\sclass="'+css_class+'">',"gm");if(el.match(regex)){var newregex=new RegExp('^<\\w+?\\sclass="'+css_class+'">(.+)</\\w+>$',"gm");var class_text=el.replace(newregex,"$1");return class_text}}}}};module.exports=Classify});
require.define("/models/Document.js",function(require,module,exports,__dirname,__filename){(function(){var Annotation,Classify,Document,Flakey,Showdown,__bind=function(fn,me){return function(){return fn.apply(me,arguments)}},__hasProp=Object.prototype.hasOwnProperty,__extends=function(child,parent){for(var key in parent)if(__hasProp.call(parent,key))child[key]=parent[key];function ctor(){this.constructor=child}ctor.prototype=parent.prototype;child.prototype=new ctor;child.__super__=parent.prototype;
return child};Flakey=require("flakey");Showdown=require("../lib/showdown");Classify=require("../lib/classify");Annotation=require("./Annotation");Document=function(_super){__extends(Document,_super);function Document(){this.render=__bind(this.render,this);this.get_notes=__bind(this.get_notes,this);this.generate_slug=__bind(this.generate_slug,this);this.draw_annotations=__bind(this.draw_annotations,this);this.annotate=__bind(this.annotate,this);Document.__super__.constructor.apply(this,arguments)}
Document.model_name="Document";Document.fields=["id","name","slug","base_text","annotations"];Document.prototype.annotate=function(selection,html,attachment){var note,type;if(attachment===void 0)type="highlight";else type="note";note=new Annotation({text:selection,type:type,attachment:attachment,document:this.id});note.save();if(!this.annotations||this.annotations.constructor!==Array)this.annotations=[];this.annotations.push(note.id);this.save();return note.apply(html)};Document.prototype["delete"]=
function(){var note,note_id,_i,_len,_ref;if(this.annotations!=null){_ref=this.annotations;for(_i=0,_len=_ref.length;_i<_len;_i++){note_id=_ref[_i];note=Annotation.get(note_id);note["delete"]()}}return Document.__super__["delete"].call(this)};Document.prototype.delete_annotation=function(id){var index;index=this.annotations.indexOf(id);if(index!==-1){this.annotations.splice(index,1);return this.save()}};Document.prototype.draw_annotations=function(html,annotations){var note,note_id,_i,_len;if(annotations==
null)annotations=this.annotations;if(!annotations||annotations.constructor!==Array)annotations=[];for(_i=0,_len=annotations.length;_i<_len;_i++){note_id=annotations[_i];note=Annotation.get(note_id);if(note!=null)html=note.apply(html)}return html};Document.prototype.generate_slug=function(){var slug;slug=this.name;slug=slug.toLowerCase().replace(/[^\_\ 0-9a-z-]/g,"").replace(/[ ]/g,"_");this.slug=slug;return slug};Document.prototype.get_notes=function(){var id,note,notes,_i,_len,_ref;if(!this.annotations||
this.annotations.constructor!==Array)this.annotations=[];notes=[];_ref=this.annotations;for(_i=0,_len=_ref.length;_i<_len;_i++){id=_ref[_i];note=Annotation.get(id);if(note!=null)notes.push(note)}return notes};Document.prototype.render=function(){var classy_converter,converter,html;converter=new Showdown.converter;html=converter.makeHtml(this.base_text);classy_converter=new Classify.converter;html=classy_converter.addClasses(html);return html};return Document}(Flakey.models.Model);module.exports=Document}).call(this)});
require.define("/lib/showdown.js",function(require,module,exports,__dirname,__filename){var Showdown=function(){var Showdown={};Showdown.converter=function(){var g_urls;var g_titles;var g_html_blocks;var g_list_level=0;this.makeHtml=function(text){g_urls=new Array;g_titles=new Array;g_html_blocks=new Array;text=text.replace(/~/g,"~T");text=text.replace(/\$/g,"~D");text=text.replace(/\r\n/g,"\n");text=text.replace(/\r/g,"\n");text="\n\n"+text+"\n\n";text=_Detab(text);text=text.replace(/^[ \t]+$/mg,
"");text=_HashHTMLBlocks(text);text=_StripLinkDefinitions(text);text=_RunBlockGamut(text);text=_UnescapeSpecialChars(text);text=text.replace(/~D/g,"$$");text=text.replace(/~T/g,"~");return text};var _StripLinkDefinitions=function(text){var text=text.replace(/^[ ]{0,3}\[(.+)\]:[ \t]*\n?[ \t]*<?(\S+?)>?[ \t]*\n?[ \t]*(?:(\n*)["(](.+?)[")][ \t]*)?(?:\n+|\Z)/gm,function(wholeMatch,m1,m2,m3,m4){m1=m1.toLowerCase();g_urls[m1]=_EncodeAmpsAndAngles(m2);if(m3)return m3+m4;else if(m4)g_titles[m1]=m4.replace(/"/g,
"&quot;");return""});return text};var _HashHTMLBlocks=function(text){text=text.replace(/\n/g,"\n\n");var block_tags_a="p|div|h[1-6]|blockquote|pre|table|dl|ol|ul|script|noscript|form|fieldset|iframe|math|ins|del";var block_tags_b="p|div|h[1-6]|blockquote|pre|table|dl|ol|ul|script|noscript|form|fieldset|iframe|math";text=text.replace(/^(<(p|div|h[1-6]|blockquote|pre|table|dl|ol|ul|script|noscript|form|fieldset|iframe|math|ins|del)\b[^\r]*?\n<\/\2>[ \t]*(?=\n+))/gm,hashElement);text=text.replace(/^(<(p|div|h[1-6]|blockquote|pre|table|dl|ol|ul|script|noscript|form|fieldset|iframe|math)\b[^\r]*?.*<\/\2>[ \t]*(?=\n+)\n)/gm,
hashElement);text=text.replace(/(\n[ ]{0,3}(<(hr)\b([^<>])*?\/?>)[ \t]*(?=\n{2,}))/g,hashElement);text=text.replace(/(\n\n[ ]{0,3}<!(--[^\r]*?--\s*)+>[ \t]*(?=\n{2,}))/g,hashElement);text=text.replace(/(?:\n\n)([ ]{0,3}(?:<([?%])[^\r]*?\2>)[ \t]*(?=\n{2,}))/g,hashElement);text=text.replace(/\n\n/g,"\n");return text};var hashElement=function(wholeMatch,m1){var blockText=m1;blockText=blockText.replace(/\n\n/g,"\n");blockText=blockText.replace(/^\n/,"");blockText=blockText.replace(/\n+$/g,"");blockText=
"\n\n~K"+(g_html_blocks.push(blockText)-1)+"K\n\n";return blockText};var _RunBlockGamut=function(text){text=_DoHeaders(text);var key=hashBlock("<hr />");text=text.replace(/^[ ]{0,2}([ ]?\*[ ]?){3,}[ \t]*$/gm,key);text=text.replace(/^[ ]{0,2}([ ]?\-[ ]?){3,}[ \t]*$/gm,key);text=text.replace(/^[ ]{0,2}([ ]?\_[ ]?){3,}[ \t]*$/gm,key);text=_DoLists(text);text=_DoCodeBlocks(text);text=_DoBlockQuotes(text);text=_HashHTMLBlocks(text);text=_FormParagraphs(text);return text};var _RunSpanGamut=function(text){text=
_DoCodeSpans(text);text=_EscapeSpecialCharsWithinTagAttributes(text);text=_EncodeBackslashEscapes(text);text=_DoImages(text);text=_DoAnchors(text);text=_DoAutoLinks(text);text=_EncodeAmpsAndAngles(text);text=_DoItalicsAndBold(text);text=text.replace(/  +\n/g," <br />\n");return text};var _EscapeSpecialCharsWithinTagAttributes=function(text){var regex=/(<[a-z\/!$]("[^"]*"|'[^']*'|[^'">])*>|<!(--.*?--\s*)+>)/gi;text=text.replace(regex,function(wholeMatch){var tag=wholeMatch.replace(/(.)<\/?code>(?=.)/g,
"$1`");tag=escapeCharacters(tag,"\\`*_");return tag});return text};var _DoAnchors=function(text){text=text.replace(/(\[((?:\[[^\]]*\]|[^\[\]])*)\][ ]?(?:\n[ ]*)?\[(.*?)\])()()()()/g,writeAnchorTag);text=text.replace(/(\[((?:\[[^\]]*\]|[^\[\]])*)\]\([ \t]*()<?(.*?)>?[ \t]*((['"])(.*?)\6[ \t]*)?\))/g,writeAnchorTag);text=text.replace(/(\[([^\[\]]+)\])()()()()()/g,writeAnchorTag);return text};var writeAnchorTag=function(wholeMatch,m1,m2,m3,m4,m5,m6,m7){if(m7==undefined)m7="";var whole_match=m1;var link_text=
m2;var link_id=m3.toLowerCase();var url=m4;var title=m7;if(url==""){if(link_id=="")link_id=link_text.toLowerCase().replace(/ ?\n/g," ");url="#"+link_id;if(g_urls[link_id]!=undefined){url=g_urls[link_id];if(g_titles[link_id]!=undefined)title=g_titles[link_id]}else if(whole_match.search(/\(\s*\)$/m)>-1)url="";else return whole_match}url=escapeCharacters(url,"*_");var result='<a href="'+url+'"';if(title!=""){title=title.replace(/"/g,"&quot;");title=escapeCharacters(title,"*_");result+=' title="'+title+
'"'}result+=">"+link_text+"</a>";return result};var _DoImages=function(text){text=text.replace(/(!\[(.*?)\][ ]?(?:\n[ ]*)?\[(.*?)\])()()()()/g,writeImageTag);text=text.replace(/(!\[(.*?)\]\s?\([ \t]*()<?(\S+?)>?[ \t]*((['"])(.*?)\6[ \t]*)?\))/g,writeImageTag);return text};var writeImageTag=function(wholeMatch,m1,m2,m3,m4,m5,m6,m7){var whole_match=m1;var alt_text=m2;var link_id=m3.toLowerCase();var url=m4;var title=m7;if(!title)title="";if(url==""){if(link_id=="")link_id=alt_text.toLowerCase().replace(/ ?\n/g,
" ");url="#"+link_id;if(g_urls[link_id]!=undefined){url=g_urls[link_id];if(g_titles[link_id]!=undefined)title=g_titles[link_id]}else return whole_match}alt_text=alt_text.replace(/"/g,"&quot;");url=escapeCharacters(url,"*_");var result='<img src="'+url+'" alt="'+alt_text+'"';title=title.replace(/"/g,"&quot;");title=escapeCharacters(title,"*_");result+=' title="'+title+'"';result+=" />";return result};var _DoHeaders=function(text){text=text.replace(/^(.+)[ \t]*\n=+[ \t]*\n+/gm,function(wholeMatch,m1){return hashBlock("<h1>"+
_RunSpanGamut(m1)+"</h1>")});text=text.replace(/^(.+)[ \t]*\n-+[ \t]*\n+/gm,function(matchFound,m1){return hashBlock("<h2>"+_RunSpanGamut(m1)+"</h2>")});text=text.replace(/^(\#{1,6})[ \t]*(.+?)[ \t]*\#*\n+/gm,function(wholeMatch,m1,m2){var h_level=m1.length;return hashBlock("<h"+h_level+">"+_RunSpanGamut(m2)+"</h"+h_level+">")});return text};var _ProcessListItems;var _DoLists=function(text){text+="~0";var whole_list=/^(([ ]{0,3}([*+-]|\d+[.])[ \t]+)[^\r]+?(~0|\n{2,}(?=\S)(?![ \t]*(?:[*+-]|\d+[.])[ \t]+)))/gm;
if(g_list_level)text=text.replace(whole_list,function(wholeMatch,m1,m2){var list=m1;var list_type=m2.search(/[*+-]/g)>-1?"ul":"ol";list=list.replace(/\n{2,}/g,"\n\n\n");var result=_ProcessListItems(list);result=result.replace(/\s+$/,"");result="<"+list_type+">"+result+"</"+list_type+">\n";return result});else{whole_list=/(\n\n|^\n?)(([ ]{0,3}([*+-]|\d+[.])[ \t]+)[^\r]+?(~0|\n{2,}(?=\S)(?![ \t]*(?:[*+-]|\d+[.])[ \t]+)))/g;text=text.replace(whole_list,function(wholeMatch,m1,m2,m3){var runup=m1;var list=
m2;var list_type=m3.search(/[*+-]/g)>-1?"ul":"ol";var list=list.replace(/\n{2,}/g,"\n\n\n");var result=_ProcessListItems(list);result=runup+"<"+list_type+">\n"+result+"</"+list_type+">\n";return result})}text=text.replace(/~0/,"");return text};_ProcessListItems=function(list_str){g_list_level++;list_str=list_str.replace(/\n{2,}$/,"\n");list_str+="~0";list_str=list_str.replace(/(\n)?(^[ \t]*)([*+-]|\d+[.])[ \t]+([^\r]+?(\n{1,2}))(?=\n*(~0|\2([*+-]|\d+[.])[ \t]+))/gm,function(wholeMatch,m1,m2,m3,m4){var item=
m4;var leading_line=m1;var leading_space=m2;if(leading_line||item.search(/\n{2,}/)>-1)item=_RunBlockGamut(_Outdent(item));else{item=_DoLists(_Outdent(item));item=item.replace(/\n$/,"");item=_RunSpanGamut(item)}return"<li>"+item+"</li>\n"});list_str=list_str.replace(/~0/g,"");g_list_level--;return list_str};var _DoCodeBlocks=function(text){text+="~0";text=text.replace(/(?:\n\n|^)((?:(?:[ ]{4}|\t).*\n+)+)(\n*[ ]{0,3}[^ \t\n]|(?=~0))/g,function(wholeMatch,m1,m2){var codeblock=m1;var nextChar=m2;codeblock=
_EncodeCode(_Outdent(codeblock));codeblock=_Detab(codeblock);codeblock=codeblock.replace(/^\n+/g,"");codeblock=codeblock.replace(/\n+$/g,"");codeblock="<pre><code>"+codeblock+"\n</code></pre>";return hashBlock(codeblock)+nextChar});text=text.replace(/~0/,"");return text};var hashBlock=function(text){text=text.replace(/(^\n+|\n+$)/g,"");return"\n\n~K"+(g_html_blocks.push(text)-1)+"K\n\n"};var _DoCodeSpans=function(text){text=text.replace(/(^|[^\\])(`+)([^\r]*?[^`])\2(?!`)/gm,function(wholeMatch,m1,
m2,m3,m4){var c=m3;c=c.replace(/^([ \t]*)/g,"");c=c.replace(/[ \t]*$/g,"");c=_EncodeCode(c);return m1+"<code>"+c+"</code>"});return text};var _EncodeCode=function(text){text=text.replace(/&/g,"&amp;");text=text.replace(/</g,"&lt;");text=text.replace(/>/g,"&gt;");text=escapeCharacters(text,"*_{}[]\\",false);return text};var _DoItalicsAndBold=function(text){text=text.replace(/(\*\*|__)(?=\S)([^\r]*?\S[*_]*)\1/g,"<strong>$2</strong>");text=text.replace(/(\*|_)(?=\S)([^\r]*?\S)\1/g,"<em>$2</em>");return text};
var _DoBlockQuotes=function(text){text=text.replace(/((^[ \t]*>[ \t]?.+\n(.+\n)*\n*)+)/gm,function(wholeMatch,m1){var bq=m1;bq=bq.replace(/^[ \t]*>[ \t]?/gm,"~0");bq=bq.replace(/~0/g,"");bq=bq.replace(/^[ \t]+$/gm,"");bq=_RunBlockGamut(bq);bq=bq.replace(/(^|\n)/g,"$1  ");bq=bq.replace(/(\s*<pre>[^\r]+?<\/pre>)/gm,function(wholeMatch,m1){var pre=m1;pre=pre.replace(/^  /mg,"~0");pre=pre.replace(/~0/g,"");return pre});return hashBlock("<blockquote>\n"+bq+"\n</blockquote>")});return text};var _FormParagraphs=
function(text){text=text.replace(/^\n+/g,"");text=text.replace(/\n+$/g,"");var grafs=text.split(/\n{2,}/g);var grafsOut=new Array;var end=grafs.length;for(var i=0;i<end;i++){var str=grafs[i];if(str.search(/~K(\d+)K/g)>=0)grafsOut.push(str);else if(str.search(/\S/)>=0){str=_RunSpanGamut(str);str=str.replace(/^([ \t]*)/g,"<p>");str+="</p>";grafsOut.push(str)}}end=grafsOut.length;for(var i=0;i<end;i++)while(grafsOut[i].search(/~K(\d+)K/)>=0){var blockText=g_html_blocks[RegExp.$1];blockText=blockText.replace(/\$/g,
"$$$$");grafsOut[i]=grafsOut[i].replace(/~K\d+K/,blockText)}return grafsOut.join("\n\n")};var _EncodeAmpsAndAngles=function(text){text=text.replace(/&(?!#?[xX]?(?:[0-9a-fA-F]+|\w+);)/g,"&amp;");text=text.replace(/<(?![a-z\/?\$!])/gi,"&lt;");return text};var _EncodeBackslashEscapes=function(text){text=text.replace(/\\(\\)/g,escapeCharacters_callback);text=text.replace(/\\([`*_{}\[\]()>#+-.!])/g,escapeCharacters_callback);return text};var _DoAutoLinks=function(text){text=text.replace(/<((https?|ftp|dict):[^'">\s]+)>/gi,
'<a href="$1">$1</a>');text=text.replace(/<(?:mailto:)?([-.\w]+\@[-a-z0-9]+(\.[-a-z0-9]+)*\.[a-z]+)>/gi,function(wholeMatch,m1){return _EncodeEmailAddress(_UnescapeSpecialChars(m1))});return text};var _EncodeEmailAddress=function(addr){function char2hex(ch){var hexDigits="0123456789ABCDEF";var dec=ch.charCodeAt(0);return hexDigits.charAt(dec>>4)+hexDigits.charAt(dec&15)}var encode=[function(ch){return"&#"+ch.charCodeAt(0)+";"},function(ch){return"&#x"+char2hex(ch)+";"},function(ch){return ch}];addr=
"mailto:"+addr;addr=addr.replace(/./g,function(ch){if(ch=="@")ch=encode[Math.floor(Math.random()*2)](ch);else if(ch!=":"){var r=Math.random();ch=r>0.9?encode[2](ch):r>0.45?encode[1](ch):encode[0](ch)}return ch});addr='<a href="'+addr+'">'+addr+"</a>";addr=addr.replace(/">.+:/g,'">');return addr};var _UnescapeSpecialChars=function(text){text=text.replace(/~E(\d+)E/g,function(wholeMatch,m1){var charCodeToReplace=parseInt(m1);return String.fromCharCode(charCodeToReplace)});return text};var _Outdent=
function(text){text=text.replace(/^(\t|[ ]{1,4})/gm,"~0");text=text.replace(/~0/g,"");return text};var _Detab=function(text){text=text.replace(/\t(?=\t)/g,"    ");text=text.replace(/\t/g,"~A~B");text=text.replace(/~B(.+?)~A/g,function(wholeMatch,m1,m2){var leadingText=m1;var numSpaces=4-leadingText.length%4;for(var i=0;i<numSpaces;i++)leadingText+=" ";return leadingText});text=text.replace(/~A/g,"    ");text=text.replace(/~B/g,"");return text};var escapeCharacters=function(text,charsToEscape,afterBackslash){var regexString=
"(["+charsToEscape.replace(/([\[\]\\])/g,"\\$1")+"])";if(afterBackslash)regexString="\\\\"+regexString;var regex=new RegExp(regexString,"g");text=text.replace(regex,escapeCharacters_callback);return text};var escapeCharacters_callback=function(wholeMatch,m1){var charCodeToEscape=m1.charCodeAt(0);return"~E"+charCodeToEscape+"E"}};return Showdown}();module.exports=Showdown});
require.define("/models/Annotation.js",function(require,module,exports,__dirname,__filename){(function(){var Annotation,Flakey,__bind=function(fn,me){return function(){return fn.apply(me,arguments)}},__hasProp=Object.prototype.hasOwnProperty,__extends=function(child,parent){for(var key in parent)if(__hasProp.call(parent,key))child[key]=parent[key];function ctor(){this.constructor=child}ctor.prototype=parent.prototype;child.prototype=new ctor;child.__super__=parent.prototype;return child};Flakey=require("flakey");
Annotation=function(_super){__extends(Annotation,_super);function Annotation(){this.apply=__bind(this.apply,this);Annotation.__super__.constructor.apply(this,arguments)}Annotation.model_name="Annotation";Annotation.fields=["id","text","type","attachment","document"];Annotation.prototype.apply=function(html){var note,parts,text,_i,_len;parts=this.text.split("\n");for(_i=0,_len=parts.length;_i<_len;_i++){text=parts[_i];if(this.type==="note")note='<span id="note-'+this.id+'" class="'+this.type+'">'+
text+'<span contenteditable="true" id="note-detail-'+this.id+'" class="note-detail">'+this.attachment+"</span></span>";else note='<span id="note-'+this.id+'" class="'+this.type+'">'+text+"</span>";html=html.replace(text,note)}return html};return Annotation}(Flakey.models.Model);module.exports=Annotation}).call(this)});
require.define("/views/new_document.js",function(require,module,exports,__dirname,__filename){(function(){this.ecoTemplates||(this.ecoTemplates={});this.ecoTemplates["new_document"]=function(__obj){if(!__obj)__obj={};var __out=[],__capture=function(callback){var out=__out,result;__out=[];callback.call(this);result=__out.join("");__out=out;return __safe(result)},__sanitize=function(value){if(value&&value.ecoSafe)return value;else if(typeof value!=="undefined"&&value!=null)return __escape(value);else return""},
__safe,__objSafe=__obj.safe,__escape=__obj.escape;__safe=__obj.safe=function(value){if(value&&value.ecoSafe)return value;else{if(!(typeof value!=="undefined"&&value!=null))value="";var result=new String(value);result.ecoSafe=true;return result}};if(!__escape)__escape=__obj.escape=function(value){return(""+value).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")};(function(){(function(){__out.push('<div class="tool-bar-wrap">\n\t<nav id="tool-bar">\n\t\t<a href="#" class="discard">Discard</a>\n\t\t<a href="#" class="save">Save</a>\n\t</nav>\n</div>\n\n<h1>Create</h1>\n<textarea id="new-doc-editor"></textarea> \n')}).call(this)}).call(__obj);
__obj.safe=__objSafe,__obj.escape=__escape;return __out.join("")}}).call(this)});
require.define("/controllers/list.js",function(require,module,exports,__dirname,__filename){(function(){var $,Document,Flakey,List,__bind=function(fn,me){return function(){return fn.apply(me,arguments)}},__hasProp=Object.prototype.hasOwnProperty,__extends=function(child,parent){for(var key in parent)if(__hasProp.call(parent,key))child[key]=parent[key];function ctor(){this.constructor=child}ctor.prototype=parent.prototype;child.prototype=new ctor;child.__super__=parent.prototype;return child};Flakey=
require("flakey");$=Flakey.$;Document=require("../models/Document");List=function(_super){__extends(List,_super);function List(config){this.search=__bind(this.search,this);this.new_document=__bind(this.new_document,this);this.render=__bind(this.render,this);this.id="list-view";this.class_name="list view";this.actions={"click .document":"select_doc","click .new_document":"new_document","keyup #search-box":"search"};List.__super__.constructor.call(this,config);this.tmpl=Flakey.templates.get_template("list",
require("../views/list"))}List.prototype.render=function(){var context,documents;if(this.query_params.q!=null&&this.query_params.q.length>0)documents=Document.search(this.query_params.q);else documents=Document.all();context={list:documents,query:this.query_params.q};this.html(this.tmpl.render(context));this.unbind_actions();this.bind_actions();return $("#search-box").val(this.query_params.q).focus()};List.prototype.new_document=function(event){event.preventDefault();return window.location.hash="#/new?"+
(this.query_params.q!=null?Flakey.util.querystring.build({title:this.query_params.q}):"")};List.prototype.select_doc=function(event){var slug;slug=$(event.currentTarget).attr("data-slug");return window.location.hash="#/detail?"+Flakey.util.querystring.build({slug:slug})};List.prototype.search=function(event){event.preventDefault();return Flakey.util.querystring.update({q:$("#search-box").val()},true)};return List}(Flakey.controllers.Controller);module.exports=List}).call(this)});
require.define("/views/list.js",function(require,module,exports,__dirname,__filename){(function(){this.ecoTemplates||(this.ecoTemplates={});this.ecoTemplates["list"]=function(__obj){if(!__obj)__obj={};var __out=[],__capture=function(callback){var out=__out,result;__out=[];callback.call(this);result=__out.join("");__out=out;return __safe(result)},__sanitize=function(value){if(value&&value.ecoSafe)return value;else if(typeof value!=="undefined"&&value!=null)return __escape(value);else return""},__safe,
__objSafe=__obj.safe,__escape=__obj.escape;__safe=__obj.safe=function(value){if(value&&value.ecoSafe)return value;else{if(!(typeof value!=="undefined"&&value!=null))value="";var result=new String(value);result.ecoSafe=true;return result}};if(!__escape)__escape=__obj.escape=function(value){return(""+value).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")};(function(){(function(){var doc,_i,_len,_ref;__out.push('\t<div class="tool-bar-wrap">\n\t\t<div id="tool-bar">\n\t\t\t<p>"You have to be resourceful at Bethel." &mdash; Fred Rusk</p>\n\t\t</div>\n\t</div>\n\t\n\t<form id="search-form" action="#" method="GET">\n\t\t<input type="text" id="search-box" name="search-box" placeholder="Search Notes" />\n\t</form>\n\t    \n\t');
if(this.query){__out.push('\n\t\t<small>Would you like to create a new document entitled "');__out.push(__sanitize(this.query));__out.push('"</small> \n\t\t<article class="new_document">\n\t\t\t<h1 class="name">');__out.push(__sanitize(this.query));__out.push("</h1>\n\t\t</article>\n\t")}__out.push("\n\t\n\t");_ref=this.list;for(_i=0,_len=_ref.length;_i<_len;_i++){doc=_ref[_i];__out.push('\n\t\t<article class="document" data-slug="');__out.push(__sanitize(doc.slug));__out.push('" id="document-');
__out.push(__sanitize(doc.id));__out.push('">\n\t\t\t<h1 class="name">');__out.push(__sanitize(doc.name));__out.push("</h1>\n\t\t</article>\n\t")}__out.push("\n    \n</div>\n")}).call(this)}).call(__obj);__obj.safe=__objSafe,__obj.escape=__escape;return __out.join("")}}).call(this)});
require.define("/controllers/detail.js",function(require,module,exports,__dirname,__filename){(function(){var $,Annotation,Detail,Document,Flakey,ui,__bind=function(fn,me){return function(){return fn.apply(me,arguments)}},__hasProp=Object.prototype.hasOwnProperty,__extends=function(child,parent){for(var key in parent)if(__hasProp.call(parent,key))child[key]=parent[key];function ctor(){this.constructor=child}ctor.prototype=parent.prototype;child.prototype=new ctor;child.__super__=parent.prototype;
return child};Flakey=require("flakey");$=Flakey.$;ui=require("../lib/uikit");Document=require("../models/Document");Annotation=require("../models/Annotation");Detail=function(_super){__extends(Detail,_super);function Detail(config){this.annotate=__bind(this.annotate,this);this.highlight=__bind(this.highlight,this);this["delete"]=__bind(this["delete"],this);this.edit_note=__bind(this.edit_note,this);this.edit=__bind(this.edit,this);this.render=__bind(this.render,this);this.id="detail-view";this.class_name=
"detail view";this.actions={"click .edit":"edit","click .highlighter":"highlight","click .annotate":"annotate","click .delete":"delete","blur .note-detail":"edit_note"};Detail.__super__.constructor.call(this,config);this.tmpl=Flakey.templates.get_template("detail",require("../views/detail"))}Detail.prototype.render=function(){var context,docset,tmpdoc;if(!this.query_params.slug)return;docset=Document.find({slug:this.query_params.slug});tmpdoc=docset[0];console.log("I'll be displaying the doc with an id of '"+
tmpdoc.id+"'");this.doc=Document.get(tmpdoc.id);if(!(this.doc!=null))return;context={doc:this.doc};this.html(this.tmpl.render(context));this.unbind_actions();return this.bind_actions()};Detail.prototype.edit=function(event){event.preventDefault();return window.location.hash="#/edit?"+Flakey.util.querystring.build(this.query_params)};Detail.prototype.edit_note=function(event){var content,id,note,target;event.preventDefault();target=$(event.target);id=target.attr("id").replace("note-detail-","");content=
target.html().replace(/\<br\/\>/,"\n\n").replace(/\<([\w\d\/]*)\>/g," ");note=Annotation.get(id);note.attachment=content;note.type="note";return note.save()};Detail.prototype["delete"]=function(event){var _this=this;event.preventDefault();return ui.confirm("Be careful!","Are you sure you want to delete this document?").show(function(ok){if(ok){_this.doc["delete"]();return window.location.hash="#/list"}})};Detail.prototype.highlight=function(event){var html,selection;event.preventDefault();selection=
void 0;if(window.getSelection)selection=window.getSelection();else if(document.selection)selection=document.selection.createRange();selection=selection.toString();if(selection.length===0)return ui.error("Well, you were right about this being a bad idea.","Please select some text first.").hide(5E3).effect("slide");else{html=$("#detail-"+this.doc.slug).html();html=this.doc.annotate(selection,html);return $("#detail-"+this.doc.slug).html(html)}};Detail.prototype.annotate=function(event){var html,options,
selection;event.preventDefault();selection=void 0;if(window.getSelection)selection=window.getSelection();else if(document.selection)selection=document.selection.createRange();selection=selection.toString();if(selection.length===0)return ui.error("Well, you were right about this being a bad idea.","Please select some text first.").hide(5E3).effect("slide");else{html=$("#detail-"+this.doc.slug).html();options={input:true,animate:true};html=this.doc.annotate(selection,html,"Click here to edit this note.");
$("#detail-"+this.doc.slug).html(html);this.unbind_actions();return this.bind_actions()}};return Detail}(Flakey.controllers.Controller);module.exports=Detail}).call(this)});
require.define("/views/detail.js",function(require,module,exports,__dirname,__filename){(function(){this.ecoTemplates||(this.ecoTemplates={});this.ecoTemplates["detail"]=function(__obj){if(!__obj)__obj={};var __out=[],__capture=function(callback){var out=__out,result;__out=[];callback.call(this);result=__out.join("");__out=out;return __safe(result)},__sanitize=function(value){if(value&&value.ecoSafe)return value;else if(typeof value!=="undefined"&&value!=null)return __escape(value);else return""},
__safe,__objSafe=__obj.safe,__escape=__obj.escape;__safe=__obj.safe=function(value){if(value&&value.ecoSafe)return value;else{if(!(typeof value!=="undefined"&&value!=null))value="";var result=new String(value);result.ecoSafe=true;return result}};if(!__escape)__escape=__obj.escape=function(value){return(""+value).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")};(function(){(function(){__out.push('<div class="tool-bar-wrap">\n  <nav id="tool-bar">\n    <a href="#" class="edit">Edit</a>\n    <a href="#" class="highlighter">Highlight</a>\n    <a href="#" class="annotate">Create Note</a>\n    <a href="#/history?id=');
__out.push(this.doc.id);__out.push('" class="">History</a>\n    <a href="#" class="delete">Delete</a>\n  </nav>\n</div>\n\n<div class="wrap">\n  <section class="two-column">\n    <article id="detail-');__out.push(__sanitize(this.doc.slug));__out.push('">\n      ');__out.push(this.doc.draw_annotations(this.doc.render()));__out.push("\n    </article>\n    \n    <aside>\n      &nbsp;\n    </aside>\n  </section>\n</div>\n")}).call(this)}).call(__obj);__obj.safe=__objSafe,__obj.escape=__escape;return __out.join("")}}).call(this)});
require.define("/controllers/edit.js",function(require,module,exports,__dirname,__filename){(function(){var $,Classify,Document,Edit,Flakey,autoresize,ui,__bind=function(fn,me){return function(){return fn.apply(me,arguments)}},__hasProp=Object.prototype.hasOwnProperty,__extends=function(child,parent){for(var key in parent)if(__hasProp.call(parent,key))child[key]=parent[key];function ctor(){this.constructor=child}ctor.prototype=parent.prototype;child.prototype=new ctor;child.__super__=parent.prototype;
return child};Flakey=require("flakey");$=Flakey.$;autoresize=require("../lib/autoresize");ui=require("../lib/uikit");Classify=require("../lib/classify");Document=require("../models/Document");Edit=function(_super){__extends(Edit,_super);function Edit(config){this.delete_note=__bind(this.delete_note,this);this.discard=__bind(this.discard,this);this.save=__bind(this.save,this);this.render=__bind(this.render,this);this.autosave=__bind(this.autosave,this);this.id="edit-view";this.class_name="edit_document view";
this.actions={"click .save":"save","click .discard":"discard","click .delete":"delete_note","keyup #edit-editor":"autosave"};Edit.__super__.constructor.call(this,config);this.tmpl=Flakey.templates.get_template("edit",require("../views/edit"))}Edit.prototype.autosave=function(event){event.preventDefault();return localStorage[this.autosave_key()]=$("#edit-editor").val()};Edit.prototype.autosave_key=function(){return"autosave-draft-"+this.doc.id};Edit.prototype.render=function(){var context,docset,tmpdoc,
_this=this;if(!this.query_params.slug)return;docset=Document.find({slug:this.query_params.slug});tmpdoc=docset[0];this.doc=Document.get(tmpdoc.id);context={doc:this.doc};this.html(this.tmpl.render(context));if(localStorage[this.autosave_key()]!=null&&localStorage[this.autosave_key()].length>0)ui.confirm("Restore?","An unsaved draft of this note was found. Would you like to restore it to the editor?").show(function(ok){if(ok){$("#edit-editor").val(localStorage[_this.autosave_key()]);return _this.auto_resize()}else return delete localStorage[_this.autosave_key()]});
this.unbind_actions();this.bind_actions();return this.auto_resize()};Edit.prototype.auto_resize=function(){return $("#edit-editor").autoResize({extraSpace:100,maxHeight:9E3})};Edit.prototype.save=function(event){var class_converter,dupes,tmp_html;event.preventDefault();this.doc.base_text=$("#edit-editor").val();tmp_html=this.doc.render();class_converter=new Classify.converter;this.doc.name=class_converter.extractClass(tmp_html,"title");this.doc.slug=class_converter.extractClass(tmp_html,"slug");if(!this.doc.slug)this.doc.slug=
this.doc.generate_slug();dupes=Document.find({slug:this.doc.slug});if(dupes.length>0)return ui.info("A document with that name already exists!").hide(5E3).effect("slide");else{this.doc.save();if(localStorage[this.autosave_key()]!=null&&localStorage[this.autosave_key()].length>0)delete localStorage[this.autosave_key()];ui.info("Everything's Shiny Capt'n!",'"'+this.doc.name+'" was successfully saved.').hide(5E3).effect("slide");return window.location.hash="#/detail?"+Flakey.util.querystring.build(this.query_params)}};
Edit.prototype.discard=function(event){var _this=this;event.preventDefault();ui.confirm("There be Monsters!","Careful there Captain; are you sure you want to discard all changes to this document?").show(function(ok){});if(ok)return window.location.hash="#/list"};Edit.prototype.delete_note=function(event){var _this=this;event.preventDefault();return ui.confirm("There be Monsters!","Are you sure you want to delete this annotation?").show(function(ok){var id;if(ok){id=$(event.target).parent().attr("data-id");
_this.doc.delete_annotation(id);return $(event.target).parent().slideUp()}})};return Edit}(Flakey.controllers.Controller);module.exports=Edit}).call(this)});
require.define("/views/edit.js",function(require,module,exports,__dirname,__filename){(function(){this.ecoTemplates||(this.ecoTemplates={});this.ecoTemplates["edit"]=function(__obj){if(!__obj)__obj={};var __out=[],__capture=function(callback){var out=__out,result;__out=[];callback.call(this);result=__out.join("");__out=out;return __safe(result)},__sanitize=function(value){if(value&&value.ecoSafe)return value;else if(typeof value!=="undefined"&&value!=null)return __escape(value);else return""},__safe,
__objSafe=__obj.safe,__escape=__obj.escape;__safe=__obj.safe=function(value){if(value&&value.ecoSafe)return value;else{if(!(typeof value!=="undefined"&&value!=null))value="";var result=new String(value);result.ecoSafe=true;return result}};if(!__escape)__escape=__obj.escape=function(value){return(""+value).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")};(function(){(function(){var annotation,_i,_len,_ref;__out.push('<div class="tool-bar-wrap">\n\t<nav id="tool-bar">\n\t\t<a href="#" class="discard">Discard</a>\n\t\t<a href="#" class="save">Save</a>\n\t</nav>\n</div>\n\n<h1>Edit</h1>\n<textarea id="edit-editor">');
__out.push(__sanitize(this.doc.base_text));__out.push('</textarea>\n\n<div class="annotations">\n\t<h2>Notes & Highlights</h2>\n\t');_ref=this.doc.get_notes();for(_i=0,_len=_ref.length;_i<_len;_i++){annotation=_ref[_i];__out.push('\n\t\t<div class="annotation" data-id="');__out.push(__sanitize(annotation.id));__out.push('">\n\t\t\t<blockquote>&#8220;');__out.push(annotation.text);__out.push('&#8221;</blockquote>\n\t\t\t<span class="attachment">');__out.push(annotation.attachment);__out.push('</span>\n\t\t\t<a href="#" class="delete">Delete</a>\n\t\t</div>\n\t')}__out.push("\n</div>\n")}).call(this)}).call(__obj);
__obj.safe=__objSafe,__obj.escape=__escape;return __out.join("")}}).call(this)});
require.define("/controllers/history.js",function(require,module,exports,__dirname,__filename){(function(){var $,Document,Flakey,History,Showdown,ui,__bind=function(fn,me){return function(){return fn.apply(me,arguments)}},__hasProp=Object.prototype.hasOwnProperty,__extends=function(child,parent){for(var key in parent)if(__hasProp.call(parent,key))child[key]=parent[key];function ctor(){this.constructor=child}ctor.prototype=parent.prototype;child.prototype=new ctor;child.__super__=parent.prototype;
return child};Flakey=require("flakey");$=Flakey.$;ui=require("../lib/uikit");Showdown=require("../lib/showdown");Document=require("../models/Document");History=function(_super){__extends(History,_super);function History(config){this.update=__bind(this.update,this);this.rollback=__bind(this.rollback,this);this.render=__bind(this.render,this);this.id="history-view";this.class_name="history view";this.actions={"change #version-input":"update","click #rollback":"rollback"};History.__super__.constructor.call(this,
config);this.tmpl=Flakey.templates.get_template("history",require("../views/history"));Flakey.events.register("model_document_updated",this.render)}History.prototype.render=function(){var context,doc,latest,max_version,time;if(!this.query_params.id)return;doc=Document.get(this.query_params.id);max_version=doc.versions.length-1;latest=doc.versions.length-1;time=doc.versions[latest].time;context={doc:doc,time:new Date(time),max_version:max_version};this.html(this.tmpl.render(context));this.unbind_actions();
return this.bind_actions()};History.prototype.rollback=function(event){var doc,time,version_index,_this=this;event.preventDefault();version_index=$("#version-input").val();doc=Document.get(this.query_params.id);time=new Date(doc.versions[version_index].time);return ui.confirm("Be careful!","Are you sure you want to rollback to the version saved at "+time.toLocaleString()).show(function(ok){if(ok)return doc.rollback(doc.versions[version_index].version_id)})};History.prototype.update=function(event){var converter,
doc,html,rev,time,version_index;version_index=$("#version-input").val();doc=Document.get(this.query_params.id);time=new Date(doc.versions[version_index].time);rev=doc.evolve(doc.versions[version_index].version_id);converter=new Showdown.converter;html=converter.makeHtml(rev.base_text);$("#history-time").html(time.toLocaleString());return $("#history-content").html(doc.draw_annotations(html,rev.annotations))};return History}(Flakey.controllers.Controller);module.exports=History}).call(this)});
require.define("/views/history.js",function(require,module,exports,__dirname,__filename){(function(){this.ecoTemplates||(this.ecoTemplates={});this.ecoTemplates["history"]=function(__obj){if(!__obj)__obj={};var __out=[],__capture=function(callback){var out=__out,result;__out=[];callback.call(this);result=__out.join("");__out=out;return __safe(result)},__sanitize=function(value){if(value&&value.ecoSafe)return value;else if(typeof value!=="undefined"&&value!=null)return __escape(value);else return""},
__safe,__objSafe=__obj.safe,__escape=__obj.escape;__safe=__obj.safe=function(value){if(value&&value.ecoSafe)return value;else{if(!(typeof value!=="undefined"&&value!=null))value="";var result=new String(value);result.ecoSafe=true;return result}};if(!__escape)__escape=__obj.escape=function(value){return(""+value).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")};(function(){(function(){var html;__out.push('<div class="tool-bar-wrap">\n  <nav id="tool-bar">\n    <a href="#/detail?id=');
__out.push(this.doc.id);__out.push('">Back to Normal View</a>\n    \n    <label for="version-input">Version:</label>\n    <input type="range" min="0" max="');__out.push(__sanitize(this.max_version));__out.push('" value="');__out.push(__sanitize(this.version||this.max_version));__out.push('" step="1" id="version-input" name="version-input" />\n    \n    <a href="#" id="rollback">Rollback to this Version</a>\n  </nav>\n</div>\n\n<div class="wrap">\n  <section class="two-column">\n    <article id="history-');
__out.push(__sanitize(this.doc.slug));__out.push('">\n      <h5>Version from <em id="history-time">');__out.push(__sanitize(this.time.toLocaleString()));__out.push('</em></h5>\n      <h1 class="name">');__out.push(__sanitize(this.doc.name));__out.push("</h1>\n      ");html=this.html!=null?this.html:this.doc.render();__out.push('\n      <section id="history-content">\n         ');__out.push(this.doc.draw_annotations(html));__out.push("\n      </section>\n    </article>\n    \n    <aside>\n      &nbsp;\n    </aside>\n  </section>\n</div>")}).call(this)}).call(__obj);
__obj.safe=__objSafe,__obj.escape=__escape;return __out.join("")}}).call(this)});
require.define("/index.js",function(require,module,exports,__dirname,__filename){(function(){var $,Annotare,App,Flakey,__hasProp=Object.prototype.hasOwnProperty,__extends=function(child,parent){for(var key in parent)if(__hasProp.call(parent,key))child[key]=parent[key];function ctor(){this.constructor=child}ctor.prototype=parent.prototype;child.prototype=new ctor;child.__super__=parent.prototype;return child};Flakey=window.Flakey=require("flakey");$=window.$=Flakey.$;Annotare=require("./controllers/annotare");
App=function(_super){__extends(App,_super);function App(){App.__super__.constructor.apply(this,arguments);this.annotare=new Annotare;this.append(this.annotare)}return App}(Flakey.controllers.Controller);$(document).ready(function(){var annotare,settings;settings={container:$("#application"),base_model_endpoint:"/api"};Flakey.init(settings);Flakey.models.backend_controller.sync("Document");Flakey.models.backend_controller.sync("Annotation");annotare=window.Annotare=new Annotare;return annotare.make_active()});
module.exports=App}).call(this)});require("/index.js");
